<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3c.org/1999/xhtml" xml:lang="zh_TW" lang="zh_TW"> <head> <title>D-LINK</title> <meta http-equiv="X-UA-Compatible" content="IE=9"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="Content-Type" content="text/css"> <link href="css/jquery.selectbox.css" type="text/css" rel="stylesheet"/> <script type="text/javascript" charset="utf-8" src="/js/initialJS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialCSS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialJQ.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialValidate.js"></script> <script type="text/javascript" charset="utf-8" src="/js/PPTPVpn.js"></script> <script>$(document).ready(function(){presetCheckBox("status_vpn",true);presetCheckBox("status_encryption",true);$("div.checkbox_on"||"div.checkbox_off").click(function(c){var d=c.target.id+"_ck";if(c.target.getAttribute("class")=="checkbox_on"){var b=I18N("j","Disabled");c.target.setAttribute("class","checkbox_off");c.target.setAttribute("className","checkbox_off");document.getElementById(c.target.id).innerHTML='<input type="checkbox" name='+c.target.id+" id="+d+" checked>"+b;document.getElementById(d).checked=false;changeFlag=true;save_button_changed()}else{var a=I18N("j","Enabled");c.target.setAttribute("class","checkbox_on");c.target.setAttribute("className","checkbox_on");document.getElementById(c.target.id).innerHTML='<input type="checkbox" name='+c.target.id+" id="+d+' checked="">'+a;document.getElementById(d).checked=true;changeFlag=true;save_button_changed()}});GetXML()});</script> <script type="text/javascript">var HNAP=new HNAP_XML();var Limit_TotalPPTPVPNRules=5;var datalist;function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu();initialDetectRouterConnection();datalist=new Datalist()}function GetXML(){var a=HNAP.GetXML("GetPPTPVpnSettingsAlpha");var c=a.Get("GetPPTPVpnSettingsAlphaResponse/pptp");if(c=="true"){presetCheckBox("status_vpn",true)}else{presetCheckBox("status_vpn",false)}var b=a.Get("GetPPTPVpnSettingsAlphaResponse/encrtype");if(b=="true"){presetCheckBox("status_encryption",true)}else{presetCheckBox("status_encryption",false)}var i=a.Get("GetPPTPVpnSettingsAlphaResponse/account/entry#");for(var e=1;e<=i;e++){var l=a.Get("GetPPTPVpnSettingsAlphaResponse/account/entry:"+e+"/name");var j=a.Get("GetPPTPVpnSettingsAlphaResponse/account/entry:"+e+"/password");var h=a.Get("GetPPTPVpnSettingsAlphaResponse/account/entry:"+e+"/hostid");var d=a.Get("GetPPTPVpnSettingsAlphaResponse/account/entry:"+e+"/enable");var f=a.Get("GetPPTPVpnSettingsAlphaResponse/account/entry:"+e+"/state");var g=new Data(decode_char_text(l),decode_char_text(j),decode_char_text(h),decode_char_text(f));g.setEnable(d);datalist.push(g)}check_TotalRule(Limit_TotalPPTPVPNRules,datalist.length())}function CheckConnectionStatus(){$.ajax({cache:false,url:"./js/CheckConnection",timeout:2000,type:"GET",success:function(a){SetXML()},error:function(){document.getElementById("DetectRouterConnection").style.display="inline"}})}function SetXML(){document.getElementById("CreatePopAlertMessage2").style.display="inline";setTimeout("waitSettingFinished()",2000);HNAP.GetXMLAsync("SetPPTPVpnSettingsAlpha",null,"GetXML",function(a){SetResult_1st(a)})}function SetResult_1st(b){if(b!=null){if(document.getElementById("status_vpn_ck").checked=="1"){b.Set("SetPPTPVpnSettingsAlpha/pptp","true")}else{b.Set("SetPPTPVpnSettingsAlpha/pptp","false")}if(document.getElementById("status_encryption_ck").checked=="1"){b.Set("SetPPTPVpnSettingsAlpha/encrtype","true")}else{b.Set("SetPPTPVpnSettingsAlpha/encrtype","false")}for(var a=0;a<datalist.length();a++){b.Set("SetPPTPVpnSettingsAlpha/account/entry:"+(a+1)+"/name",datalist.list[a].name);b.Set("SetPPTPVpnSettingsAlpha/account/entry:"+(a+1)+"/password",datalist.list[a].password);b.Set("SetPPTPVpnSettingsAlpha/account/entry:"+(a+1)+"/hostid",datalist.list[a].hostid);b.Set("SetPPTPVpnSettingsAlpha/account/entry:"+(a+1)+"/enable",datalist.list[a].enable)}HNAP.SetXMLAsync("SetPPTPVpnSettingsAlpha",b,function(c){SetResult_2nd(c)})}else{if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_1st")}document.getElementById("CreatePopAlertMessage2").style.display="none"}}function SetResult_2nd(b){var a=b.Get("SetPPTPVpnSettingsAlphaResponse/SetPPTPVpnSettingsResult");if(a=="OK"){window.location.reload()}if(a=="ERROR"){if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_2nd")}window.location.reload()}}function waitSettingFinished(){window.location.reload()}function BasicSetting_hasChanged(){BasicSettinghasChanged=1}function returnToHome(){var a=sessionStorage.getItem("hostname");self.location.href="http://"+a+"/PPTPVPN.html"}function deleteData(a){changeTimeoutAction();datalist.deleteData(a);save_button_changed();check_TotalRule(Limit_TotalPPTPVPNRules,datalist.length())}function CreateRule(){changeTimeoutAction();save_button_changed();var a=false;var e=$("#ST_account").val();if(e==""){alert("Please enter an Username");return false}var b=$("#ST_password").val();if(b==""){alert("Please enter an Password.");return false}var d=$("#ST_ip").val();if(d==""){alert("Please enter an IP address.");return false}if((parseInt(d,10)>255)||(parseInt(d,10)<1)||isNaN(d)){alert("Invalid IP address.");return false}var f="Disconnected";var c=new Data(decode_char_text(e),decode_char_text(b),decode_char_text(d),decode_char_text(f));datalist.push(c);$("input").val("");check_TotalRule(Limit_TotalPPTPVPNRules,datalist.length())}function check_TotalRule(a,c){var b=a-c;if(b==0){$("#Add_account").attr("class","styled_button_dis").prop("disabled",true)}else{$("#Add_account").attr("class","styled_button_s").prop("disabled",false)}};</script> <script language="JavaScript">$(function(){$("select").change(function(){save_button_changed()});$("input").keydown(function(){save_button_changed()})});function save_button_changed(){document.getElementById("Save_Disable_btn").style.display="none";document.getElementById("Save_btn").style.display="block";changeFlag=true};</script> </head> <body> <div id="wrapper"> <div id="header"></div> <div id="menu"></div> <div id="content"> <div id="info"> <div id="FunctionName"><script>I18N("h","VPN");</script></div> <div id="wallimage"><img src="image/page_network2.png" alt="" width="195" height="119"/></div> <div id="directions"> <script>I18N("h","A virtual private network (VPN) is a private network that interconnects remote netwoks through primarily public communication infrastructures such as the Internet.");</script> </div> </div> <div id="funcBar"> <div id="pagePath">&nbsp;<script>I18N("h","Features");</script> >> <script>I18N("h","VPN(PPTP)");</script></div> <ul id="rightFunc"> <li style="display:block"><div id="Save_btn" onclick="document.getElementById('sumbit_CheckData').click()" style="cursor:pointer; display:none"><script>I18N("h","Save");</script></div></li> <li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save");</script></div></li> <input id="sumbit_CheckData" class="submit" type="submit" value="Submit" onclick="CheckConnectionStatus()" style="display:none"/> </ul> </div> <div id="main"> <table class="block" style="margin: 10px 0 0 0;"> <tbody> <tr> <th><script>I18N("h","VPN(PPTP) Mode");</script>:</th> <td><div id="status_vpn" class="checkbox_on"><input type="checkbox" name="status_vpn" id="status_vpn_ck" checked></div></td> </tr> <tr> <th><script>I18N("h","Encryption");</script>:</th> <td><div id="status_encryption" class="checkbox_on"><input type="checkbox" name="status_encryption" id="status_encryption_ck" checked></div></td> </tr> </tbody> </table> <form name="vpn_form" id="vpn_form" action=""> <table class="block" style="margin: 10px 0 0 0;"> <tbody> <tr> <th><script>I18N("h","VPN account");</script>:</th> <td><input class="styled-text" type="text" name="ST_account" size="30" maxlength="15" id="ST_account"></td> </tr> <tr> <th><script>I18N("h","VPN password");</script>:</th> <td><input class="styled-text" type="text" name="ST_password" size="30" maxlength="15" id="ST_password"></td> </tr> <tr> <th><script>I18N("h","Indicated IP address");</script>:</th> <td><script>I18N("h","192.168.0.");</script><input class="styled-text" type="text" name="ST_ip" size="30" maxlength="64" id="ST_ip" style="width: 122px;"> <button type="button" class="styled_button_s" id="Add_account" onclick="CreateRule()"><script>I18N("h","Add");</script></td> </tr> <tr> <th></th> <td><script>I18N("h","(Most 5 sets)");</script></td> </tr> </tbody> </table> <br/> <table class="mainTable" border="0" cellspacing="0" id="tblPPTPVPN" style="text-align: center;"> <thead> <tr> <th><script>I18N("h","Enable");</script></th> <th><script>I18N("h","VPN account");</script></th> <th><script>I18N("h","IP address");</script></th> <th><script>I18N("h","state");</script></th> <th><script>I18N("h","Delete");</script></th> </tr> </thead> <tbody></tbody> </table> </form> </div> </div> <div id="CreatePopAlertMessage2" style="display:none"> <div id="AlertPopRect"> <div id="AlertPopBody"> <table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0"> <tbody> <tr> <td> <center><div id="Loading_pop_image2"></div></center> </td> </tr> <tr> <td label id="reciprocal_Number"></label></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Your changes are being saved.");</script></td> </tr> </tbody> </table> </div> </div> </div> <div id="DetectRouterConnection" style="display:none"></div> <div id="footer"> <div id="copyright"><script>I18N("h","COPYRIGHT");</script></div> </div> </div> <script type="text/javascript" charset="utf-8">$(document).ready(function(){$("#vpn_form").each(function(a,b){$(b).validate({submitHandler:function(c){var d=c.value;CreateRule(d)},debug:true})})});</script> </body> <script type="text/javascript">Load_HTML();Initial();setMenu("menu_Advanced");startTimeout();</script> </html>