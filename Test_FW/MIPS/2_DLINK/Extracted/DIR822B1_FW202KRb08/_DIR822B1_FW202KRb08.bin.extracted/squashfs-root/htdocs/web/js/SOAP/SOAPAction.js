var SOAP_NAMESPACE="http://purenetworks.com/HNAP1/";function SOAPAction(){this.list=new Array()}SOAPAction.prototype={timeout:0,list:null,multipleSoap:"",SOAPResponse:function(a){this.name=a;this.outputObj=new Array()},AddSOAP:function(a,c){var b=null;for(var d in this.list){if(this.list[d].name==a){b=this.list[d];break}}if(b==null){b=new this.SOAPResponse(a);b.outputObj.push(c);this.list.push(b)}else{b.outputObj.push(c)}}};SOAPAction.prototype.parseHNAP=function(e,c,b){var a=c.find(e+"Result").text().toUpperCase();if(a=="ERROR"){return false}if(b!=null){function d(g,h){var i=g;if(Object.keys(i).length==0){var f=h.children().end();i=new Array();h.children().each(function(){i.push($(this).text())});return i}for(var j in i){if($.isArray(i[j])==true){if(h.find(j).length==0){i[j].splice(0,1)}else{var k=false;h.find(j).each(function(){var l=$(this);var m={};$.extend(true,m,i[j][0]);m=d(m,l);if(i[j].length==0){k=true;i[j]=m}else{i[j].push(m)}});if(k==false){i[j].splice(0,1)}}}else{h.children().each(function(){var l=$(this);var m=l[0].tagName.toLowerCase();if(m==j.toLowerCase()){if($.type(i[j])=="object"){if($.isArray(i[j])==true){return true}i[j]=d(i[j],l);return false}else{i[j]=l.text();return false}}})}}return i}b=d(b,c)}else{b=new Object()}b[e+"Result"]=a;return b};SOAPAction.prototype.SetMultipleSOAP=function(b,c,a){this.multipleSoap+=this.createActionBody(b,c);this.AddSOAP(b,a)};SOAPAction.prototype.SendMultipleSOAPAction=function(d){var h=$.Deferred();var i=this;var e='<?xml version="1.0" encoding="utf-8"?>';e+='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">';e+="<soap:Body>";e+="<"+d+' xmlns="http://purenetworks.com/HNAP1/">';e+=this.multipleSoap;e+="</"+d+">";e+="</soap:Body></soap:Envelope>";var g='"'+SOAP_NAMESPACE+d+'"';var f=sessionStorage.getItem("PrivateKey");if(f==null){f="withoutloginkey"}var a=sessionStorage.getItem("Cookie");$.cookie("uid",a,{expires:1,path:"/"});var c=new Date().getTime();c=Math.floor(c/1000)%2000000000;c=c.toString();var b=hex_hmac_md5(f,c+g);b=b.toUpperCase()+" "+c;$.ajax({url:"/HNAP1/",type:"POST",contentType:"text/xml; charset=utf-8",headers:{SOAPAction:g,HNAP_AUTH:b},timeout:i.timeout,data:e,success:function(k){var j=$(k).find(d+"Result").text().toUpperCase();if(j=="ERROR"){return h.reject()}for(var l in i.list){$(k).find(i.list[l].name+"Response").each(function(m){i.parseHNAP(i.list[l].name,$(this),i.list[l].outputObj[m])})}h.resolve(i.list)},error:function(l,j,k){h.reject()}});this.multipleSoap="";return h.promise()};SOAPAction.prototype.createValueBody=function(c){var a="";for(var d in c){if((d.charAt(0)=="_")||(d=="push")){continue}if($.isArray(c[d])==true){for(var b in c[d]){a+="<"+d+">";a+=this.createValueBody(c[d][b]);a+="</"+d+">"}}else{if((typeof d!="string")||(d.length>0)){a+="<"+d+">";if(($.type(c[d])=="object")&&(c[d]!=null)){a+=this.createValueBody(c[d])}else{a+=c[d]}a+="</"+d+">"}else{a+="<"+d+"/>"}}}return a};SOAPAction.prototype.createActionBody=function(b,c){var a="";if((typeof c=="object")&&(c!=null)){a+="<"+b+' xmlns="'+SOAP_NAMESPACE+'">';a+=this.createValueBody(c);a+="</"+b+">"}else{a+="<"+b+' xmlns="'+SOAP_NAMESPACE+'" />'}return a};SOAPAction.prototype.createSOAP=function(b){var a='<?xml version="1.0" encoding="utf-8"?>';a+='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">';a+="<soap:Body>";a+=b;a+="</soap:Body></soap:Envelope>";return a};SOAPAction.prototype.sendSOAPAction=function(e,i,b){var j=$.Deferred();var k=this;var f=k.createActionBody(e,i);f=k.createSOAP(f);var h='"'+SOAP_NAMESPACE+e+'"';var g=sessionStorage.getItem("PrivateKey");if(g==null){g="withoutloginkey"}var a=sessionStorage.getItem("Cookie");$.cookie("uid",a,{expires:1,path:"/"});var d=new Date().getTime();d=Math.floor(d/1000)%2000000000;d=d.toString();var c=hex_hmac_md5(g,d+h);c=c.toUpperCase()+" "+d;$.ajax({url:"/HNAP1/",type:"POST",contentType:"text/xml; charset=utf-8",headers:{SOAPAction:h,HNAP_AUTH:c},timeout:k.timeout,data:f,success:function(m){var l=k.parseHNAP(e,$(m).find(e+"Response"),b);if(l==false){j.reject()}else{j.resolve(l)}},error:function(n,l,m){j.reject()}});return j.promise()};SOAPAction.prototype.copyObject=function(c,d){for(var a in c){for(var b in d){if(a==b){if($.type(c[a])=="object"){if($.isArray(c[a])==true){}this.copyObject(c[a],d[b])}else{c[a]=d[b];break}}}}};