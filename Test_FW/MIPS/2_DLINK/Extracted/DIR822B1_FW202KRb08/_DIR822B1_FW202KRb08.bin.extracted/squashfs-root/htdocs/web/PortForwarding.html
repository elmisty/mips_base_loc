<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3c.org/1999/xhtml"> <head> <title>D-LINK</title> <meta http-equiv="X-UA-Compatible" content="IE=9"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="Content-Type" content="text/css"> <link rel=stylesheet type="text/css" href="/css/jquery.selectbox.css?v=20200423094010"/> <script type="text/javascript" charset="utf-8" src="/js/initialJQ.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialJS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialCSS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialValidate.js"></script> <script type="text/javascript" charset="utf-8" src="/js/PortForwarding.js?v=20200423094010"></script> <script type="text/javascript">var HNAP=new HNAP_XML();var Total_ScheduleRules=0;var Limit_TotalPortForwardingRules=24;var Total_Client=0;var Limit_Client=256;var datalist;var lanIP;var submask;function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu();initialDetectRouterConnection();datalist=new Datalist()}function GetXML(){HNAP.GetXMLAsync("GetMultipleHNAPs",null,"GetXML",function(a){GetResult_1st(a)})}function GetResult_1st(a){if(a!=null){a.Set("GetMultipleHNAPs/GetScheduleSettings");a.Set("GetMultipleHNAPs/GetClientInfo");a.Set("GetMultipleHNAPs/GetPortForwardingSettings");a.Set("GetMultipleHNAPs/GetRouterLanSettings");HNAP.SetXMLAsync("GetMultipleHNAPs",a,function(b){GetResult_2nd(b)})}else{if(DebugMode==1){alert("[!!GetXML Error!!] Function: GetResult_1st")}}}function GetResult_2nd(c){lanIP=c.Get("GetMultipleHNAPsResponse/GetRouterLanSettingsResponse/RouterIPAddress");submask=c.Get("GetMultipleHNAPsResponse/GetRouterLanSettingsResponse/RouterSubnetMask");var l=c.Get("GetMultipleHNAPsResponse/GetMultipleHNAPsResult");if(l=="OK"){var h=c.Get("GetMultipleHNAPsResponse/GetScheduleSettingsResponse/ScheduleInfoLists#");Total_ScheduleRules=h;var p=document.getElementById("pf_Schedule");for(var r=1;r<=Total_ScheduleRules;r++){var s=decode_char_text(c.Get("GetMultipleHNAPsResponse/GetScheduleSettingsResponse/ScheduleInfoLists:"+r+"/ScheduleName"));p.options.add(new Option(s,s))}Total_Client=c.Get("GetMultipleHNAPsResponse/GetClientInfoResponse/ClientInfoLists/ClientInfo#");var b=document.getElementById("select_pf_LocalIP");var e=1;for(var q=1;q<=Total_Client;q++){var d=c.Get("GetMultipleHNAPsResponse/GetClientInfoResponse/ClientInfoLists/ClientInfo:"+q+"/DeviceName");var w=c.Get("GetMultipleHNAPsResponse/GetClientInfoResponse/ClientInfoLists/ClientInfo:"+q+"/IPv4Address");if(d==""){d="Unknown"}if(w!=""){b.options.add(new Option(w+" ("+d+")",e));e++}}var v=c.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo#");for(var n=1;n<=v;n++){var g=c.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo:"+n+"/Enabled");var f=c.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo:"+n+"/PortForwardingDescription");var t=c.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo:"+n+"/LocalIPAddress");var m=c.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo:"+n+"/TCPPorts");var a=c.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo:"+n+"/UDPPorts");var o=c.Get("GetMultipleHNAPsResponse/GetPortForwardingSettingsResponse/PortForwardingList/PortForwardingInfo:"+n+"/ScheduleName");var u=new Data(decode_char_text(f),t,m,a,decode_char_text(o));u.setEnable(g);datalist.push(u)}check_TotalRule(Limit_TotalPortForwardingRules,datalist.length());$("#select_pf_LocalIP").selectbox();$("#pf_Schedule").selectbox();document.getElementById("main").style.display="inline";$("select").change(function(){save_button_changed()});$("input").keydown(function(){save_button_changed()});$("input").change(function(){save_button_changed()})}else{if(DebugMode==1){alert("[!!GetXML Error!!] Function: GetResult_2nd")}}}function CheckConnectionStatus(){$.ajax({cache:false,url:"./js/CheckConnection",timeout:5000,type:"GET",success:function(a){SetXML()},error:function(){document.getElementById("DetectRouterConnection").style.display="inline"}})}function SetXML(){document.getElementById("CreatePopAlertMessage").style.display="inline";HNAP.GetXMLAsync("SetPortForwardingSettings",null,"GetXML",function(a){SetResult_1st(a)})}function SetResult_1st(a){if(a!=null){for(var b=0;b<datalist.length();b++){a.Set("SetPortForwardingSettings/PortForwardingList/PortForwardingInfo:"+(b+1)+"/Enabled",datalist.list[b].enable);a.Set("SetPortForwardingSettings/PortForwardingList/PortForwardingInfo:"+(b+1)+"/PortForwardingDescription",encode_char_text(datalist.list[b].name));a.Set("SetPortForwardingSettings/PortForwardingList/PortForwardingInfo:"+(b+1)+"/LocalIPAddress",datalist.list[b].ipAddress);a.Set("SetPortForwardingSettings/PortForwardingList/PortForwardingInfo:"+(b+1)+"/TCPPorts",datalist.list[b].tcpPort);a.Set("SetPortForwardingSettings/PortForwardingList/PortForwardingInfo:"+(b+1)+"/UDPPorts",datalist.list[b].udpPort);a.Set("SetPortForwardingSettings/PortForwardingList/PortForwardingInfo:"+(b+1)+"/ScheduleName",encode_char_text(datalist.list[b].schedule))}HNAP.SetXMLAsync("SetPortForwardingSettings",a,function(c){SetResult_2nd(c)})}}function SetResult_2nd(b){var a=b.Get("SetPortForwardingSettingsResponse/SetPortForwardingSettingsResult");if(a=="OK"){setTimeout("waitSettingFinished()",1000)}if(a=="ERROR"){if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_2nd")}window.location.reload()}}function waitSettingFinished(){window.location.reload()}function createUserButton(){changeTimeoutAction();$("#popTitle").html(I18N("j","Create New Rule"));document.getElementById("createPop").style.display="inline";document.getElementById("createButton").disabled=true;$("#portforwarding_form").val(-1)}function closeCreateRulePOP(h){changeTimeoutAction();var b=false;var e=$("#pf_Name").val();var d=$("#pf_LocalIP").val();var a=$("#pf_TCPPort").val();var c=$("#pf_UDPPort").val();var g=$("#pf_Schedule").val();var f=new Data(e,d,a,c,g);if(h<0){b=datalist.push(f)}else{b=datalist.editData(h,f)}if(b){resetRulePOP();check_TotalRule(Limit_TotalPortForwardingRules,datalist.length())}}function clearCreateRulePOP(){changeTimeoutAction();resetRulePOP();$("#portforwarding_form").validate().resetForm();$(":text").prop("className","styled-text");check_TotalRule(Limit_TotalPortForwardingRules,datalist.length())}function resetRulePOP(){$("select").selectbox("detach");$("input").val("");document.getElementById("createPop").style.display="none";$("#select_pf_LocalIP").val("0");$("#pf_Schedule").val("Always");$("select").selectbox("attach")}function editData(b){changeTimeoutAction();$("#popTitle").html(I18N("j","Edit Rule"));document.getElementById("createPop").style.display="inline";document.getElementById("createButton").disabled=true;$("#portforwarding_form").val(b);var a=datalist.getData(b);document.getElementById("pf_Name").value=a.name;document.getElementById("pf_LocalIP").value=a.ipAddress;document.getElementById("pf_TCPPort").value=a.tcpPort;document.getElementById("pf_UDPPort").value=a.udpPort;$("#pf_Schedule").selectbox("detach");$("#pf_Schedule").val(a.schedule);$("#pf_Schedule").selectbox("attach")}function deleteData(a){changeTimeoutAction();datalist.deleteData(a);check_TotalRule(Limit_TotalPortForwardingRules,datalist.length());save_button_changed()}function pf_LocalIP_Description(c,e){var b=c.options[e].text;var d=b.split("(")[0];var a=d.replace(/\s/g,"");if(e=="0"){document.getElementById("pf_LocalIP").value=""}else{document.getElementById("pf_LocalIP").value=a}$("#pf_LocalIP").valid()}function focusToFirstIndex(a){if(a.id=="save_buttonFocus"){if(window.event.keyCode==9){document.getElementById("pf_Name").focus()}}}function save_button_changed(){document.getElementById("Save_Disable_btn").style.display="none";document.getElementById("Save_btn").style.display="block";changeFlag=true;checkFlag=true;changeTimeoutAction()}function check_TotalRule(a,c){var b=a-c;document.getElementById("RemainingRules").innerHTML=b;if(b==0){$("#createButton").attr("class","styled_button_dis").prop("disabled",true)}else{$("#createButton").attr("class","styled_button_s").prop("disabled",false)}}$(document).ready(function(){Load_HTML();Initial();setMenu("menu_Advanced");GetXML();startTimeout()});</script> </head> <body> <div id="wrapper"> <div id="header"></div> <div id="menu"></div> <div id="menu_edge"></div> <div id="content"> <div id="info"> <div id="FunctionName"><script>I18N("h","Port Forwarding");</script></div> <div id="wallimage"><img src="image/page_PortForwarding.png" alt="" width="195" height="119"/></div> <div id="directions"> <script>I18N("h","Your router helps share a single IP address assigned by your ISP among several clients in your home. Port forwarding allows traffic requests from a specified application to be directed to a specified client inside.");</script> </div> </div> <div id="funcBar"> <div id="pagePath"><script>I18N("h","Features");</script> >> <script>I18N("h","Port Forwarding");</script></div> <ul id="rightFunc"> <li style="display:block"><div id="Save_btn" onclick="CheckConnectionStatus();changeTimeoutAction();" style="cursor:pointer; display:none"><script>I18N("h","Save");</script></div></li> <li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save");</script></div></li> <li style="display:block"><a href="javascript:CheckHTMLStatus('VirtualServer');" style="text-decoration:none;" onclick="return confirmExit()"><div id="page_btn" class="linkstyle_1"><script>I18N("h","Virtual Server");</script></div></a></li> </ul> </div> <div id="main" style="display:none"> <table class="mainTable" border="0" cellspacing="0" id="tblPortForwarding"> <thead> <tr> <th><script>I18N("h","Status");</script></th> <th><script>I18N("h","Name");</script></th> <th><script>I18N("h","Local IP");</script></th> <th><script>I18N("h","TCP Port");</script></th> <th><script>I18N("h","UDP Port");</script></th> <th><script>I18N("h","Schedule");</script></th> <th><script>I18N("h","Edit");</script></th> <th><script>I18N("h","Delete");</script></th> </tr> </thead> <tbody></tbody> </table> <br/> <br/> <button type="button" id="createButton" name="createButton" class="styled_button_s" onclick="createUserButton()"><script>I18N("h","Add Rule");</script></button> &nbsp;&nbsp;<script>I18N("h","Remaining");</script>:&nbsp;<label id="RemainingRules">10</label> <br/> <form name="portforwarding_form" id="portforwarding_form" action=""> <input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none"/> <div id="createPop" style="display:none"> <div class="dialogBox" style="width:616px"> <div id="closeCreatePopBtn" onclick="clearCreateRulePOP()" style="cursor:pointer"></div> <table class="myCreatePop_table" border="0" cellspacing="0" id="tblPortForwarding3"> <tbody> <tr> <td colspan="3"><div class="popTitle" id="popTitle"></div></td> </tr> <tr> <th><script>I18N("h","Name");</script>:</th> <td valign="top" width="20px"><input class="styled-text" type="text" name="pf_Name" size="27" id="pf_Name" Maxlength="20" tabindex="1"></td> <td>&nbsp;</td> </tr> <tr> <th><script>I18N("h","Local IP");</script>:</th> <td valign="top" width="20px"><input class="styled-text" type="text" name="pf_LocalIP" size="27" id="pf_LocalIP" tabindex="2"></td> <td valign="top"> <div class="styled-select"> <select style="width: 150px" name="select_pf_LocalIP" id="select_pf_LocalIP" onChange="pf_LocalIP_Description(this, this.value)"> <option value="0" selected>&lt;&lt; Computer Name</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","TCP Port");</script>:</th> <td valign="top" width="20px"><input class="styled-text" type="text" name="pf_TCPPort" size="27" id="pf_TCPPort" tabindex="3"> </td> <td>&nbsp;</td> </tr> <tr> <th><script>I18N("h","UDP Port");</script>:</th> <td valign="top" width="20px"><input class="styled-text" type="text" name="pf_UDPPort" size="27" id="pf_UDPPort" tabindex="4"> </td> <td>&nbsp;</td> </tr> <tr> <th class="linkstyle_1"><a href="Schedule.html"><script>I18N("h","Schedule");</script></a>:</th> <td width="20px"> <div class="styled-select" tabindex="5"> <select style="width: 120px" name="pf_Schedule" id="pf_Schedule"> <option value="Always">Always</option> </select> </div> </td> <td>&nbsp;</td> </tr> <tr> <td id="save_td" colspan="4"> <center><button type="button" class="styled_button_s" id="save_buttonFocus" tabindex="6" onkeyup="focusToFirstIndex(this)" onclick="document.getElementById('sumbit_CheckData').click();"><script>I18N("h","Apply");</script></button></center> </td> </tr> </tbody> </table> </div> </div> </form> <div id="CreatePopAlertMessage" style="display:none"> <div id="AlertPopRect"> <div id="AlertPopBody"> <table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0"> <tbody> <tr> <td> <center><div id="Loading_pop_image2"></div></center> </td> </tr> <tr> <td label id="reciprocal_Number"></label></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Your changes are being saved.");</script></td> </tr> </tbody> </table> </div> </div> </div> <div id="DetectRouterConnection" style="display:none"></div> </div> <div id="footer"> <div id="copyright"><script>I18N("h","COPYRIGHT");</script></div> </div> </div> </div> <script type="text/javascript" charset="utf-8">$(document).ready(function(){$.validator.addMethod("checkALLNULL",function(d,b,a){var c=true;if(($(b).val()=="")&&($(a).val()=="")){c=false}this.showMessage(a,"checkALLNULL",c);return c},jQuery.validator.messages.port);$.validator.addMethod("checkPortRange",function(k,d){var j=k.replace(/\s/g,"");var b=j.split(",");var f;var h=/(^\d{1,})+$/;var g=/(^\d{1,}-\d{1,})$/;if(k==""){return true}else{for(var e=0;e<b.length;e++){if(b[e].search("-")>-1){if(g.test(b[e])){f=b[e].split("-");var a=parseInt(f[0],10);var c=parseInt(f[1],10);if((a>65535)||(a<=0)||(c>65535)||(c<=0)){return false}if(a>c){return false}}else{return false}}else{if(h.test(b[e])){if((parseInt(b[e],10)>65535)||(parseInt(b[e],10)<=0)){return false}}else{return false}}}}return true},jQuery.validator.messages.port_Check);$.validator.addMethod("checkIPFormat",function(d,a){var c=/(^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))+$/;var b=true;if(c.test(d)){b=true}else{b=false}return b},jQuery.validator.messages.address_Check);$.validator.addMethod("checkIPAddress",function(d,b){var c=true;var a=COMM_IPv4MASK2INT(submask);if(lanIP==d){c=false}else{if(!COMM_ValidV4Format(d)||!COMM_ValidV4Addr(d)||!COMM_ValidV4HOST(d,a)){c=false}else{c=true}}return c},jQuery.validator.messages.address_Check);$("#portforwarding_form").each(function(a,b){$(b).validate({rules:{pf_Name:{required:true},pf_LocalIP:{required:true,checkIPFormat:true,checkIPAddress:true},pf_TCPPort:{checkALLNULL:$("#pf_UDPPort"),checkPortRange:true},pf_UDPPort:{checkALLNULL:$("#pf_TCPPort"),checkPortRange:true}},messages:{pf_Name:{required:jQuery.validator.messages.rule_Name},pf_TCPPort:{required:jQuery.validator.messages.port},pf_UDPPort:{required:jQuery.validator.messages.port}},submitHandler:function(c){var d=c.value;closeCreateRulePOP(d)},debug:true})})});</script> </body> </html>