<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3c.org/1999/xhtml" xml:lang="zh_TW" lang="zh_TW"> <head> <title>D-LINK</title> <meta http-equiv="X-UA-Compatible" content="IE=9"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="Content-Type" content="text/css"> <link rel=stylesheet type="text/css" href="/css/jquery.selectbox.css?v=20210706160806"/> <script type="text/javascript" charset="utf-8" src="/js/initialJS.js?v=20210706160806"></script> <script type="text/javascript" charset="utf-8" src="/js/initialCSS.js?v=20210706160806"></script> <script type="text/javascript" charset="utf-8" src="/js/initialJQ.js?v=20210706160806"></script> <script type="text/javascript" charset="utf-8" src="/js/initialValidate1.js?v=20210706160806"></script> <script type="text/javascript" charset="utf-8" src="/js/configuration/DeviceConfig.js?v=20210706160806"></script> <script type="text/javascript">var HNAP=new HNAP_XML();var _ReciprocalNumber=10;var supportmode_24=new Array();var supportmode_5=new Array();var supportmode_count_24=0;var supportmode_count_5=0;var xml_GetNetworkSettings=HNAP.GetXML("GetNetworkSettings");var lan_IPAddr=xml_GetNetworkSettings.Get("GetNetworkSettingsResponse/IPAddress");var redirect_url=lan_IPAddr;var currentmode=new Array(2);var currentbw=new Array(2);var initoptionlist=new Array(false,false);var selected_wlmode;var selected_ssid;var selected_security;var ssid_list=new Array();var ssid_num;var xml_GetDeviceFeature=HNAP.GetXML("GetDeviceFeatureAlpha");var xml_GetOperationMode=HNAP.GetXML("GetOperationMode");var xml_GetWanSettings=HNAP.GetXML("GetWanSettings");var WifiVerify=false;var feature_dualband=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureDualBand");var feature_guestzone=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureGuestZone");var feature_turbomode=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureTurboMode");var feature_ap=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureAP");var feature_apclient=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureAPClient");var feature_repeater=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureRepeater");var feature_extender=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureExtender");var feature_wps=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureWPS");var device_layout=xml_GetOperationMode.Get("GetOperationModeResponse/OperationModeList/CurrentOPMode");var wan_type=xml_GetWanSettings.Get("GetWanSettingsResponse/Type");var device_mode;var devicemode_org;var support_apclient=false;var support_repeater=false;var support_apmode=false;var bootuptime=70;var timer;var result_24=null;var result_5=null;var result_device_mode=null;var result_smartconnect=null;var g_aplock_enable="0";var g_aplock_pin_status="0";if(feature_dualband=="true"){feature_dualband=true}else{feature_dualband=false}if(feature_guestzone=="true"){feature_guestzone=true}else{feature_guestzone=false}if(wan_type.indexOf("Bridged")>=0||wan_type.indexOf("Ap")>=0||wan_type.indexOf("Extender")>=0||wan_type.indexOf("Repeater")>=0){bridge_mode=true}else{bridge_mode=false}if(bridge_mode){if(wan_type.indexOf("Bridged")>=0){support_apclient=true}else{if(wan_type.indexOf("Extender")>=0||wan_type.indexOf("Repeater")>=0){support_repeater=true}else{if(wan_type.indexOf("Ap")>=0){support_apmode=true}}}}function CleanTable(a){table=document.getElementById(a);var b=table.getElementsByTagName("tr");while(b.length>0){table.deleteRow(b.length-1)}}function BandToIndex(a){if(a==24){return 0}else{if(a==5){return 1}else{return"Error Band"}}}function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu();initialDetectRouterConnection()}function AddSelectOpt(c,a,b){$(c).append('<option value="'+a+'">'+b+"</option>")}function SupportMode(d,c){var b=0;for(var a=0;a<supportmode_count_24;a++){if(c==supportmode_24[a]){b=1}}for(var a=0;a<supportmode_count_5;a++){if(c==supportmode_5[a]){b=1}}if(b!=1){return}switch(c){case"802.11a":AddSelectOpt(d,c,"802.11a only");break;case"802.11b":AddSelectOpt(d,c,"802.11b only");break;case"802.11g":AddSelectOpt(d,c,"802.11g only");break;case"802.11n":AddSelectOpt(d,c,"802.11n only");break;case"802.11bg":AddSelectOpt(d,c,"Mixed 802.11b/g");break;case"802.11gn":AddSelectOpt(d,c,"Mixed 802.11g/n");break;case"802.11bgn":AddSelectOpt(d,c,"Mixed 802.11b/g/n");break;case"802.11an":AddSelectOpt(d,c,"Mixed 802.11a/n");break;case"802.11ac":AddSelectOpt(d,c,"802.11ac only");break;case"802.11nac":AddSelectOpt(d,c,"Mixed 802.11n/ac");break;case"802.11anac":AddSelectOpt(d,c,"Mixed 802.11a/n/ac");break}}function GetRadioInfo(){var q=document.getElementById("channel_24");var p=document.getElementById("channel_5");var B=document.getElementById("security_24");var h=document.getElementById("security_5");var A=document.getElementById("security_smartconnect");var o=document.getElementById("schedule_24");var g=document.getElementById("schedule_5");var a=document.getElementById("schedule_smartconnect");var t=HNAP.GetXML("GetWLanRadios");var y=t.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo#");for(var v=1;v<=y;v++){var m=t.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+v+"/RadioID");var z=t.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+v+"/SupportedModes/string#");for(var s=1;s<=z;s++){var d=t.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+v+"/SupportedModes/string:"+s);if(m=="2.4GHZ"||m=="RADIO_2.4GHz"){supportmode_24[supportmode_count_24]=d;supportmode_count_24++}else{if(m=="5GHZ"||m=="RADIO_5GHz"){supportmode_5[supportmode_count_5]=d;supportmode_count_5++}}}var n=t.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+v+"/Channels/int#");for(var s=1;s<=n;s++){var C=t.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+v+"/Channels/int:"+s);if(m=="2.4GHZ"||m=="RADIO_2.4GHz"){q.options.add(new Option(C,C))}else{if(m=="5GHZ"||m=="RADIO_5GHz"){p.options.add(new Option(C,C))}}}var x=t.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+v+"/SupportedSecurity/SecurityInfo#");for(var s=1;s<=x;s++){var f=t.Get("GetWLanRadiosResponse/RadioInfos/RadioInfo:"+v+"/SupportedSecurity/SecurityInfo:"+s+"/SecurityType");if(f=="WPAORWPA2-PSK"){f="WPA/WPA2-Personal"}else{if(f=="WPA-PSK"){f="WPA-AES"}else{if(f=="WPA2-PSK"){f="WPA2-AES"}else{if(f=="WEP-SHARED"){f="WEP"}}}}if(m=="2.4GHZ"||m=="RADIO_2.4GHz"){B.options.add(new Option(f,f));A.options.add(new Option(f,f))}else{if(m=="5GHZ"||m=="RADIO_5GHz"){h.options.add(new Option(f,f))}}}var e=HNAP.GetXML("GetScheduleSettings");var u=e.Get("GetScheduleSettingsResponse/ScheduleInfoLists#");for(var s=1;s<=u;s++){var w=e.Get("GetScheduleSettingsResponse/ScheduleInfoLists:"+s+"/ScheduleName");if(m=="2.4GHZ"||m=="RADIO_2.4GHz"){o.options.add(new Option(w,w));a.options.add(new Option(w,w))}else{if(m=="5GHZ"||m=="RADIO_5GHz"){g.options.add(new Option(w,w))}}}}var k=HNAP.GetXML("GetWiFiVerifyAlpha");var l=k.Get("GetWiFiVerifyAlphaResponse/WPS/Enable");var b=k.Get("GetWiFiVerifyAlphaResponse/WPS/Configured");var r=k.Get("GetWiFiVerifyAlphaResponse/WPS/ENABLEPBC");var c=k.Get("GetWiFiVerifyAlphaResponse/WPS/ENABLEPIN");g_aplock_enable=k.Get("GetWiFiVerifyAlphaResponse/WPS/APLOCK");if(k.Get("GetWiFiVerifyAlphaResponse/Wifiverify")==1){WifiVerify=true;document.getElementById("wpspage").style.display="block"}if(l=="Disable"){document.getElementById("pbc_button").disabled=true;document.getElementById("pin_button").disabled=true;document.getElementById("pin_num").disabled=true;$("#wps_pbc").prop("checked",false);$("#wps_pin").prop("checked",false)}else{document.getElementById("pbc_button").disabled=false;document.getElementById("pin_button").disabled=false;document.getElementById("pin_num").disabled=false;if(r=="0"){$("#wps_pbc").prop("checked",false)}else{$("#wps_pbc").prop("checked",true)}if(c=="0"){$("#wps_pin").prop("checked",false)}else{$("#wps_pin").prop("checked",true)}if(g_aplock_enable=="1"){g_aplock_pin_status=c;$("#wps_pin").prop("checked",false);document.getElementById("wps_pin").disabled=true}}if(b=="Unconfigured"){document.getElementById("ResetWPS").disabled=true}else{document.getElementById("ResetWPS").disabled=false}document.getElementById("dev_pin").value=k.Get("GetWiFiVerifyAlphaResponse/WPS/PIN");document.getElementById("wps_status").innerHTML=l+"/"+b}function InitWLanValue(r,p){var e=HNAP.GetXML("GetWLanRadioSettings",new Array("RadioID",r));var j=e.Get("GetWLanRadioSettingsResponse/SSID");document.getElementById("wifiName_"+p).value=j;var B=e.Get("GetWLanRadioSettingsResponse/Channel");var w=document.getElementById("channel_"+p);COMM_SetSelectValue(w,B);var g=e.Get("GetWLanRadioSettingsResponse/SSIDBroadcast");var y=document.getElementById("visibilityStatus_"+p);COMM_SetSelectValue(y,g);var u=e.Get("GetWLanRadioSettingsResponse/TurboMode");if(feature_turbomode=="true"&&u=="1"){AddSelectOpt("#transmissionPower_"+p,"200","Highest")}AddSelectOpt("#transmissionPower_"+p,"100","High");AddSelectOpt("#transmissionPower_"+p,"50","Medium");AddSelectOpt("#transmissionPower_"+p,"25","Low");var t=e.Get("GetWLanRadioSettingsResponse/TXPower");var n=document.getElementById("transmissionPower_"+p);COMM_SetSelectValue(n,t);var x=e.Get("GetWLanRadioSettingsResponse/ScheduleName");var h=document.getElementById("schedule_"+p);COMM_SetSelectValue(h,x);var m=HNAP.GetXML("GetWLanRadioSecurity",new Array("RadioID",r));var l=m.Get("GetWLanRadioSecurityResponse/Enabled");var d=m.Get("GetWLanRadioSecurityResponse/Type");var q=m.Get("GetWLanRadioSecurityResponse/Encryption");var b="";var s=document.getElementById("security_"+p);if(l!="false"){var a=m.Get("GetWLanRadioSecurityResponse/Key");var z=0;for(var v=0;v<s.options.length;v++){if(s.options[v].value=="WPA/WPA2-Personal"||s.options[v].value=="WPA-AES"||s.options[v].value=="WPA2-AES"||s.options[v].value=="WEP"){z=1}}if(z){if(d=="WPA-PSK"){b="WPA-AES"}else{if(d=="WPA2-PSK"){b="WPA2-AES"}else{if(d=="WPAORWPA2-PSK"){b="WPA/WPA2-Personal"}else{b="WEP"}}}}else{b=d;if(d=="WPA-PSK"){b="WPA"}else{if(d=="WPA2-PSK"){b="WPA2"}else{if(d=="WPAORWPA2-PSK"){b="WPA+WPA2"}}}if(q=="TKIP"){b=b+"-TKIP"}else{if(q=="AES"){b=b+"-AES"}else{if(q=="TKIPORAES"){b=b+"-TKIP+AES"}}}}document.getElementById("password_"+p).disabled=false;document.getElementById("password_"+p).value=a}else{b="None";document.getElementById("password_"+p).disabled=true}COMM_SetSelectValue(s,b);var o=e.Get("GetWLanRadioSettingsResponse/Mode");var f=document.getElementById("80211Mode_"+p);currentmode[BandToIndex(p)]=o;var k=e.Get("GetWLanRadioSettingsResponse/ChannelWidth");var c=document.getElementById("channelWidth_"+p);currentbw[BandToIndex(p)]=k;ChangeSupportModeList(b,p);initoptionlist[BandToIndex(p)]=true;$("#security_"+p).selectbox();$("#80211Mode_"+p).selectbox("detach");$("#80211Mode_"+p).selectbox();$("#channel_"+p).selectbox();$("#transmissionPower_"+p).selectbox();$("#channelWidth_"+p).selectbox("detach");$("#channelWidth_"+p).selectbox();$("#visibilityStatus_"+p).selectbox();$("#schedule_"+p).selectbox();var l=e.Get("GetWLanRadioSettingsResponse/Enabled");if(l=="true"){SetCheckBoxEnable("status_"+p,true,true);DisableSettings(p,false)}else{SetCheckBoxEnable("status_"+p,true,false);DisableSettings(p,true)}if(p==24){var A=e.Get("GetWLanRadioSettingsResponse/Coexistence");if(A=="true"){SetCheckBoxEnable("coexistence_"+p,true,true)}else{SetCheckBoxEnable("coexistence_"+p,true,false)}}}function InitWIFISTA(){var k=HNAP.GetXML("GetAPClientSettings",new Array("RadioID","RADIO_2.4GHz"));var e=document.getElementById("apclient_band");var l=k.Get("GetAPClientSettingsResponse/Band");var f;if(l=="2.4"){f="24gband"}else{if(l=="5"){f="5gband"}}COMM_SetSelectValue(e,f);var d=k.Get("GetAPClientSettingsResponse/SSID");document.getElementById("apclient_ssid").value=d;var c=document.getElementById("apclient_security");var i=k.Get("GetAPClientSettingsResponse/SupportedSecurity/SecurityInfo/SecurityType");var h;if(i.indexOf("WPAPSK")>=0){h="WPAPSK"}else{if(i.indexOf("WPA2PSK")>=0){h="WPA2PSK"}else{if(i.indexOf("WPA+2PSK")>=0){h="WPA+2PSK"}else{if(i.indexOf("WEP")>=0){h="WEP"}else{h="NONE"}}}}COMM_SetSelectValue(c,h);ChangeSecurity(h);if(h!="NONE"){var j=k.Get("GetAPClientSettingsResponse/Key");document.getElementById("apclient_passwd").value=j;if(h=="WEP"){var b=j.length;var g=document.getElementById("apclient_wep_passlen");var a;if(j.length==10){a="64Hex"}else{if(j.length==5){a="64ASCII"}else{if(j.length==26){a="128Hex"}else{if(j.length==13){a="128ASCII"}}}}COMM_SetSelectValue(g,a)}}$("#apclient_band").selectbox();$("#apclient_security").selectbox();$("#apclient_wep_passlen").selectbox()}function InitSmartConnectValue(){$("#security_smartconnect").selectbox("detach");var b=HNAP.GetXML("GetWLanRadios");var a=document.getElementById("security_smartconnect");var o=HNAP.GetXML("GetWLanRadioSecurity",new Array("RadioID","RADIO_2.4GHz"));var e=HNAP.GetXML("GetWLanRadioSettings",new Array("RadioID","RADIO_2.4GHz"));var d=e.Get("GetWLanRadioSettingsResponse/TurboMode");if(feature_turbomode=="true"&&d=="1"){AddSelectOpt("#transmissionPower_smartconnect","200","Highest")}AddSelectOpt("#transmissionPower_smartconnect","100","High");AddSelectOpt("#transmissionPower_smartconnect","50","Medium");AddSelectOpt("#transmissionPower_smartconnect","25","Low");$("#transmissionPower_smartconnect").selectbox("detach");$("#schedule_smartconnect").selectbox("detach");var c=e.Get("GetWLanRadioSettingsResponse/SSID");document.getElementById("wifiName_smartconnect").value=c;var h=o.Get("GetWLanRadioSecurityResponse/Type");var j=o.Get("GetWLanRadioSecurityResponse/Encryption");var m="";var n=o.Get("GetWLanRadioSecurityResponse/Key");var f=o.Get("GetWLanRadioSecurityResponse/Enabled");var h=o.Get("GetWLanRadioSecurityResponse/Type");var j=o.Get("GetWLanRadioSecurityResponse/Encryption");var m="";var a=document.getElementById("security_smartconnect");if(f!="false"){var n=o.Get("GetWLanRadioSecurityResponse/Key");if(h=="WPA-PSK"){m="WPA-AES"}else{if(h=="WPA2-PSK"){m="WPA2-AES"}else{if(h=="WPAORWPA2-PSK"){m="WPA/WPA2-Personal"}else{m="WEP"}}}document.getElementById("password_smartconnect").disabled=false;document.getElementById("password_smartconnect").value=n}else{m="None";document.getElementById("password_smartconnect").disabled=true}var l=e.Get("GetWLanRadioSettingsResponse/TXPower");var k=document.getElementById("transmissionPower_smartconnect");COMM_SetSelectValue(k,l);var g=e.Get("GetWLanRadioSettingsResponse/Schedule");var i=document.getElementById("schedule_smartconnect");COMM_SetSelectValue(i,g);COMM_SetSelectValue(a,m);$("#security_smartconnect").selectbox();$("#transmissionPower_smartconnect").selectbox();$("#schedule_smartconnect").selectbox()}function init_WPS(){if(feature_wps=="true"){document.getElementById("WPS").style.display="block"}else{document.getElementById("WPS").style.display="none"}}function InitWLAN(){if(feature_guestzone){document.getElementById("FUNC_Guest").style.display="block"}else{document.getElementById("FUNC_Guest").style.display="none"}var d=HNAP.GetXML("GetSmartconnectSettings");var a=d.Get("GetSmartconnectSettingsResponse/Enabled");var c=d.Get("GetSmartconnectSettingsResponse/AggressiveRoaming/Enabled");var b=d.Get("GetSmartconnectSettingsResponse/OneTouch");if(feature_repeater=="true"){$("#device_mode").append('<option value="REPEATER">Repeater Mode</option>')}var e=document.getElementById("device_mode");if(wan_type.indexOf("Repeater")>=0){devicemode_org="REPEATER";COMM_SetSelectValue(e,"REPEATER")}else{devicemode_org="ROUTER";COMM_SetSelectValue(e,"ROUTER")}$("#device_mode").selectbox();if(support_apclient){document.getElementById("WIFI_STA").style.display="block";document.getElementById("apclientend_line").style.display="none";document.getElementById("SMART_CONNECT").style.display="none";document.getElementById("RADIO_2GHz").style.display="none";document.getElementById("RADIO_5GHz").style.display="none";document.getElementById("FUNC_Guest").style.display="none";InitWIFISTA()}else{if(support_repeater){document.getElementById("WIFI_STA").style.display="block";document.getElementById("apclientend_line").style.display="block";document.getElementById("SMART_CONNECT").style.display="none";document.getElementById("FUNC_Guest").style.display="none";InitWIFISTA()}else{document.getElementById("WIFI_STA").style.display="none";document.getElementById("apclientend_line").style.display="none";document.getElementById("SMART_CONNECT").style.display="none";if(support_apmode){document.getElementById("FUNC_Guest").style.display="none"}else{document.getElementById("FUNC_Guest").style.display="block"}}}if(document.getElementById("SMART_CONNECT").style.display=="none"){document.getElementById("threshold_select").value=d.Get("GetSmartconnectSettingsResponse/AggressiveRoaming/Criteria");if(c=="true"){SetCheckBoxEnable("status_aggressive",true,true);document.getElementById("threshold_tr").style.display="table-row"}else{SetCheckBoxEnable("status_aggressive",true,false);document.getElementById("threshold_tr").style.display="none"}document.getElementById("aggressive_enable_tr").style.display="table-row";if(b=="true"){SetCheckBoxEnable("status_onetouch",true,true)}else{SetCheckBoxEnable("status_onetouch",true,false)}if(a=="true"){document.getElementById("smartconnect_ssid_tr").style.display="table-row";document.getElementById("smartconnect_passwd_tr").style.display="table-row";document.getElementById("smartconnect_line").style.display="block";document.getElementById("RADIO_2GHz").style.display="none";document.getElementById("RADIO_5GHz").style.display="none";SetCheckBoxEnable("status_smartconnect",true,true);DisableSettings("smartconnect",false);InitSmartConnectValue()}else{document.getElementById("smartconnect_ssid_tr").style.display="none";document.getElementById("smartconnect_passwd_tr").style.display="none";document.getElementById("smartconnect_line").style.display="none";document.getElementById("RADIO_2GHz").style.display="block";InitWLanValue("RADIO_2.4GHz","24");if(feature_dualband){document.getElementById("RADIO_5GHz").style.display="block";InitWLanValue("RADIO_5GHz","5")}SetCheckBoxEnable("status_smartconnect",true,false);DisableSettings("smartconnect",true)}init_WPS();$("#security_smartconnect").selectbox();$("#transmissionPower_smartconnect").selectbox();$("#schedule_smartconnect").selectbox();$("#threshold_select").selectbox()}}function CheckConnectionStatus(){$.ajax({cache:false,url:"./js/CheckConnection",timeout:2000,type:"GET",success:function(a){SaveWLAN()},error:function(){document.getElementById("DetectRouterConnection").style.display="inline"}})}function SaveSmartConnectValue(a,m){var g=HNAP.GetXML("SetWLanRadioSettings");var b=HNAP.GetXML("SetSmartconnectSettings");g.Set("SetWLanRadioSettings/RadioID",a);var h=document.getElementById("status_"+m+"_ck").checked;if(h=="1"){g.Set("SetWLanRadioSettings/Enabled","true");b.Set("SetSmartconnectSettings/Enabled","true")}else{g.Set("SetWLanRadioSettings/Enabled","true");b.Set("SetSmartconnectSettings/Enabled","false")}var o=document.getElementById("wifiName_"+m).value;g.Set("SetWLanRadioSettings/SSID",o);g.Set("SetWLanRadioSettings/Mode","802.11bgn");g.Set("SetWLanRadioSettings/Channel","0");var k=document.getElementById("transmissionPower_"+m).value;g.Set("SetWLanRadioSettings/TXPower",k);g.Set("SetWLanRadioSettings/ChannelWidth","0");g.Set("SetWLanRadioSettings/SSIDBroadcast","true");var i=document.getElementById("schedule_"+m).value;g.Set("SetWLanRadioSettings/ScheduleName",i);var f=HNAP.SetXML("SetWLanRadioSettings",g);if(a=="RADIO_2.4GHz"){result_24=f.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult")}if(a=="RADIO_5GHz"){result_5=f.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult")}var n=HNAP.GetXML("SetWLanRadioSecurity");n.Set("SetWLanRadioSecurity/RadioID",a);var c=document.getElementById("security_"+m).value;var l=document.getElementById("password_"+m).value;var e;if(l.length==5||l.length==10){e="WEP-64"}else{if(l.length==13||l.length==26){e="WEP-128"}}switch(c){case"None":n.Set("SetWLanRadioSecurity/Enabled","false");break;case"WEP":n.Set("SetWLanRadioSecurity/Enabled","true");n.Set("SetWLanRadioSecurity/Type","WEP-SHARED");n.Set("SetWLanRadioSecurity/Encryption",e);n.Set("SetWLanRadioSecurity/Key",l);n.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA-AES":n.Set("SetWLanRadioSecurity/Enabled","true");n.Set("SetWLanRadioSecurity/Type","WPA-PSK");n.Set("SetWLanRadioSecurity/Encryption","AES");n.Set("SetWLanRadioSecurity/Key",l);n.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA2-AES":n.Set("SetWLanRadioSecurity/Enabled","true");n.Set("SetWLanRadioSecurity/Type","WPA2-PSK");n.Set("SetWLanRadioSecurity/Encryption","AES");n.Set("SetWLanRadioSecurity/Key",l);n.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA/WPA2-Personal":n.Set("SetWLanRadioSecurity/Enabled","true");n.Set("SetWLanRadioSecurity/Type","WPAORWPA2-PSK");n.Set("SetWLanRadioSecurity/Encryption","TKIPORAES");n.Set("SetWLanRadioSecurity/Key",l);n.Set("SetWLanRadioSecurity/KeyRenewal","3600");break}var d=HNAP.SetXML("SetSmartconnectSettings",b);var j=HNAP.SetXML("SetWLanRadioSecurity",n);result_smartconnect=d.Get("SetSmartconnectSettingsResponse/SetSmartconnectSettingsResult")}function SaveWLanValue(m,k){var i=HNAP.GetXML("SetWLanRadioSettings");i.Set("SetWLanRadioSettings/RadioID",m);var h=document.getElementById("status_"+k+"_ck").checked;if(h=="1"){i.Set("SetWLanRadioSettings/Enabled","true")}else{i.Set("SetWLanRadioSettings/Enabled","false")}var e=document.getElementById("wifiName_"+k).value;i.Set("SetWLanRadioSettings/SSID",e);var l=document.getElementById("80211Mode_"+k).value;i.Set("SetWLanRadioSettings/Mode",l);var r=document.getElementById("channel_"+k).value;i.Set("SetWLanRadioSettings/Channel",r);var n=document.getElementById("transmissionPower_"+k).value;i.Set("SetWLanRadioSettings/TXPower",n);var g=document.getElementById("channelWidth_"+k).value;i.Set("SetWLanRadioSettings/ChannelWidth",g);var d=document.getElementById("visibilityStatus_"+k).value;i.Set("SetWLanRadioSettings/SSIDBroadcast",d);var p=document.getElementById("schedule_"+k).value;i.Set("SetWLanRadioSettings/ScheduleName",p);if(k==24){var c=COMM_ToSTRING(COMM_ToBOOL(document.getElementById("coexistence_"+k+"_ck").checked));i.Set("SetWLanRadioSettings/Coexistence",c)}var q=HNAP.SetXML("SetWLanRadioSettings",i);if(k==24){result_24=q.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult")}if(k==5){result_5=q.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult")}var o=HNAP.GetXML("SetWLanRadioSecurity");o.Set("SetWLanRadioSecurity/RadioID",m);var b=document.getElementById("security_"+k).value;var a=document.getElementById("password_"+k).value;var f;if(a.length==5||a.length==10){f="WEP-64"}else{if(a.length==13||a.length==26){f="WEP-128"}}switch(b){case"None":o.Set("SetWLanRadioSecurity/Enabled","false");break;case"WEP":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WEP-SHARED");o.Set("SetWLanRadioSecurity/Encryption",f);o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA/WPA2-Personal":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WPAORWPA2-PSK");o.Set("SetWLanRadioSecurity/Encryption","TKIPORAES");o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA-AES":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WPA-PSK");o.Set("SetWLanRadioSecurity/Encryption","AES");o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA2-AES":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WPA2-PSK");o.Set("SetWLanRadioSecurity/Encryption","AES");o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WEP-SHARED":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WEP-SHARED");o.Set("SetWLanRadioSecurity/Encryption",f);o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WEP-AUTO":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WEP-AUTO");o.Set("SetWLanRadioSecurity/Encryption",f);o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA-TKIP":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WPA-PSK");o.Set("SetWLanRadioSecurity/Encryption","TKIP");o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA-TKIP+AES":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WPA-PSK");o.Set("SetWLanRadioSecurity/Encryption","TKIPORAES");o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA2-TKIP":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WPA2-PSK");o.Set("SetWLanRadioSecurity/Encryption","TKIP");o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA2-TKIP+AES":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WPA2-PSK");o.Set("SetWLanRadioSecurity/Encryption","TKIPORAES");o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA+WPA2-TKIP":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WPAORWPA2-PSK");o.Set("SetWLanRadioSecurity/Encryption","TKIP");o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA+WPA2-AES":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WPAORWPA2-PSK");o.Set("SetWLanRadioSecurity/Encryption","AES");o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break;case"WPA+WPA2-TKIP+AES":o.Set("SetWLanRadioSecurity/Enabled","true");o.Set("SetWLanRadioSecurity/Type","WPAORWPA2-PSK");o.Set("SetWLanRadioSecurity/Encryption","TKIPORAES");o.Set("SetWLanRadioSecurity/Key",a);o.Set("SetWLanRadioSecurity/KeyRenewal","3600");break}var j=HNAP.SetXML("SetWLanRadioSecurity",o)}function SaveWPSSettings(){var c;var e;var f=$("#wps_pbc").prop("checked");var b=$("#wps_pin").prop("checked");if(f==true){c="1"}else{c="0"}if(b==true){e="1"}else{e="0"}if(g_aplock_enable=="1"){e=g_aplock_pin_status}var a=HNAP.GetXML("SetWiFiVerifyAlpha");a.Set("SetWiFiVerifyAlpha/WPS/enable","true");a.Set("SetWiFiVerifyAlpha/WPS/ENABLEPBC",c);a.Set("SetWiFiVerifyAlpha/WPS/ENABLEPIN",e);var d=HNAP.SetXML("SetWiFiVerifyAlpha",a)}function checkwarning(c){var a=document.getElementById("security_"+c).value;if(c=="5"&&!feature_dualband){return true}else{var b=true;if(a=="None"&&WifiVerify){if(c=="24"){c="2.4"}b=confirm("Warning ! By selecting None in Security Mode will make your "+c+"GHz wifi connection vulnerable. Proceed ?")}return b}}function SaveWLAN(){if(feature_wps=="true"){SaveWPSSettings()}var d=document.getElementById("SMART_CONNECT").style.display;if(d=="block"){var b=document.getElementById("status_smartconnect_ck").checked;if((!checkwarning("24")||!checkwarning("5"))&&WifiVerify){alert("This page won't be saved.");return}if(support_apclient||support_repeater){SaveAPClientValue()}if(b=="1"){SaveSmartConnectValue("RADIO_2.4GHz","smartconnect");var e=xml_GetOperationMode.Get("GetOperationModeResponse/OperationModeList/CurrentOPMode");if(e=="WirelessRepeater"){SaveSmartConnectValue("RADIO_5GHz","smartconnect")}}else{var c=HNAP.GetXML("SetSmartconnectSettings");c.Set("SetSmartconnectSettings/Enabled","false");var a=HNAP.SetXML("SetSmartconnectSettings",c);result_smartconnect=a.Get("SetSmartconnectSettingsResponse/SetSmartconnectSettingsResult");SaveWLanValue("RADIO_2.4GHz","24");if(feature_dualband){setTimeout('SaveWLanValue("RADIO_5GHz", "5")',1000)}}var c=HNAP.GetXML("SetSmartconnectSettings");if(document.getElementById("status_aggressive_ck").checked=="1"){c.Set("SetSmartconnectSettings/AggressiveRoaming/Enabled","true");c.Set("SetSmartconnectSettings/AggressiveRoaming/Criteria",document.getElementById("threshold_select").value)}else{c.Set("SetSmartconnectSettings/AggressiveRoaming/Enabled","false")}if(document.getElementById("status_onetouch_ck").checked=="1"){c.Set("SetSmartconnectSettings/OneTouch","true")}else{c.Set("SetSmartconnectSettings/OneTouch","false")}var a=HNAP.SetXML("SetSmartconnectSettings",c)}else{if(support_apclient){SaveAPClientValue()}else{if(support_repeater){SaveAPClientValue();SaveOPmode();SaveWLanValue("RADIO_2.4GHz","24");if(feature_dualband){SaveWLanValue("RADIO_5GHz","5")}}else{if(document.getElementById("device_mode").value=="REPEATER"){SaveAPClientValue()}SaveOPmode();SaveWLanValue("RADIO_2.4GHz","24");if(feature_dualband){SaveWLanValue("RADIO_5GHz","5")}}}}device_mode=document.getElementById("device_mode").value;if(device_mode!=devicemode_org){if(device_mode=="REPEATER"||device_mode=="AP"){document.getElementById("Font_Color_Red").innerHTML=I18N("j","The device is changing to bridge mode.");redirect_url="192.168.0.50"}else{document.getElementById("Font_Color_Red").innerHTML=I18N("j","The device is changing to router mode.");redirect_url="192.168.0.1"}if(result_device_mode=="REBOOT"){document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("waitSettingFinish").style.display="none";document.getElementById("waitDeviceReboot").style.display="inline";document.getElementById("reciprocal_Number_Reboot").innerHTML=bootuptime+" "+I18N("j","Sec");timer=setTimeout("ReciprocalBootupTime()",1000);setTimeout("clearTimeout("+timer+");SavingFinishBlock()",bootuptime*1000);Reboot()}}else{document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("waitSettingFinish").style.display="inline";Start_reciprocal_Number_RestoreConfiguration()}}function SaveOPmode(){var b=HNAP.GetXML("SetWanSettings");if(document.getElementById("device_mode").value=="ROUTER"){b.Set("SetOperationMode/Type","Router")}else{if(document.getElementById("device_mode").value=="AP"){b.Set("SetWanSettings/Type","Ap")}else{if(document.getElementById("device_mode").value=="REPEATER"){b.Set("SetWanSettings/Type","Repeater")}}}var a=HNAP.SetXML("SetWanSettings",b);result_device_mode=a.Get("SetWanSettingsResponse/SetWanSettingsResult")}function ChangeDeviceMode(a){if(a=="REPEATER"){document.getElementById("WIFI_STA").style.display="block";document.getElementById("apclientend_line").style.display="block";document.getElementById("SMART_CONNECT").style.display="none";document.getElementById("FUNC_Guest").style.display="none";InitWIFISTA()}else{document.getElementById("WIFI_STA").style.display="none";document.getElementById("apclientend_line").style.display="none";document.getElementById("SMART_CONNECT").style.display="none";if(a=="AP"){document.getElementById("FUNC_Guest").style.display="none"}else{document.getElementById("FUNC_Guest").style.display="block"}}}function CheckSupportN(d){var a;var b=document.getElementById("security_"+d).value;var c=document.getElementById("80211Mode_"+d).value;if(b=="WEP"||b=="WEP-OPEN"||b=="WEP-SHARED"||b=="WEP-AUTO"||b=="WPA-TKIP"||b=="WPA2-TKIP"||b=="WPA+WPA2-TKIP"){a=false}else{if(c=="802.11a"||c=="802.11b"||c=="802.11g"){a=false}else{a=true}}return a}function CheckSupportBW(d,a){var c;var b=document.getElementById("security_"+d).value;if(!CheckSupportN(d)||a==12||a==13||a==140||a==165){c="20"}else{if(a==132||a==136){c="40"}else{c="80"}}return c}function ChangePasswordInput(a){if(a=="None"){document.getElementById("password_smartconnect").disabled=true}else{document.getElementById("password_smartconnect").disabled=false}}function ChangeSupportModeList(b,c){var a=document.getElementById("80211Mode_"+c);if(initoptionlist[BandToIndex(c)]){currentmode[BandToIndex(c)]=a.value}$("#80211Mode_"+c).selectbox("detach");$("#80211Mode_"+c).children().remove();if(b=="None"){document.getElementById("password_"+c).disabled=true}else{document.getElementById("password_"+c).disabled=false}switch(c){case"24":SupportMode("#80211Mode_"+c,"802.11b");SupportMode("#80211Mode_"+c,"802.11g");SupportMode("#80211Mode_"+c,"802.11bg");if(CheckSupportN(c)){SupportMode("#80211Mode_"+c,"802.11n")}SupportMode("#80211Mode_"+c,"802.11gn");SupportMode("#80211Mode_"+c,"802.11bgn");break;case"5":if(CheckSupportN(c)){SupportMode("#80211Mode_"+c,"802.11a");SupportMode("#80211Mode_"+c,"802.11n");SupportMode("#80211Mode_"+c,"802.11an");SupportMode("#80211Mode_"+c,"802.11ac");SupportMode("#80211Mode_"+c,"802.11nac");SupportMode("#80211Mode_"+c,"802.11anac")}else{SupportMode("#80211Mode_"+c,"802.11a");SupportMode("#80211Mode_"+c,"802.11an");SupportMode("#80211Mode_"+c,"802.11anac")}break}COMM_SetSelectValue(a,currentmode[BandToIndex(c)]);$("#80211Mode_"+c).selectbox("attach");ChangeWidthList(c)}function ChangeWidthList(e){var a=document.getElementById("channelWidth_"+e);if(initoptionlist[BandToIndex(e)]){currentbw[BandToIndex(e)]=a.value}$("#channelWidth_"+e).selectbox("detach");$("#channelWidth_"+e).children().remove();var c=document.getElementById("security_"+e).value;var d=document.getElementById("80211Mode_"+e).value;var b=document.getElementById("channel_"+e).value;if(e=="24"||(e=="5"&&CheckSupportBW(e,b)=="20")){AddSelectOpt("#channelWidth_"+e,"20","20 MHz")}if((/ac/.test(d)||/n/.test(d))&&(CheckSupportBW(e,b)!="20")){AddSelectOpt("#channelWidth_"+e,"0","Auto 20/40 MHz")}if(/ac/.test(d)&&(CheckSupportBW(e,b)=="80")){AddSelectOpt("#channelWidth_"+e,"1","Auto 20/40/80 MHz")}COMM_SetSelectValue(a,currentbw[BandToIndex(e)]);$("#channelWidth_"+e).selectbox("attach")}function DisableSettings(c,b){document.getElementById("wifiName_"+c).disabled=b;document.getElementById("password_"+c).disabled=b;var a;if(b){a="disable"}else{a="enable"}if(c!="smartconnect"){$("#80211Mode_"+c).selectbox(a);$("#channel_"+c).selectbox(a);$("#channelWidth_"+c).selectbox(a);$("#visibilityStatus_"+c).selectbox(a)}$("#security_"+c).selectbox(a);$("#transmissionPower_"+c).selectbox(a);$("#schedule_"+c).selectbox(a)}function ChangeBandStatus(d){var e="status_"+d;var b="status_"+d+"_ck";SetCheckBoxEnable(e);var a=document.getElementById("status_"+d+"_ck").checked;if(d=="smartconnect"){if(a){document.getElementById("SMART_CONNECT").style.display="none";document.getElementById(d+"_ssid_tr").style.display="table-row";document.getElementById(d+"_passwd_tr").style.display="table-row";document.getElementById(d+"_line").style.display="block";document.getElementById("SMART_CONNECT_adv").style.display="none";document.getElementById("RADIO_2GHz").style.display="none";if(feature_dualband){document.getElementById("RADIO_5GHz").style.display="none"}InitSmartConnectValue();DisableSettings(d,false);var c=document.getElementById("security_"+d).value;if(c=="None"){document.getElementById("password_"+d).disabled=true}}else{document.getElementById("SMART_CONNECT").style.display="none";document.getElementById(d+"_ssid_tr").style.display="none";document.getElementById(d+"_passwd_tr").style.display="none";document.getElementById(d+"_line").style.display="none";document.getElementById("SMART_CONNECT_adv").style.display="none";document.getElementById("RADIO_2GHz").style.display="block";InitWLanValue("RADIO_2.4GHz","24");if(feature_dualband){document.getElementById("RADIO_5GHz").style.display="block";InitWLanValue("RADIO_5GHz","5")}}}else{if(a){DisableSettings(d,false)}else{DisableSettings(d,true)}var c=document.getElementById("security_"+d).value;if(c=="None"){document.getElementById("password_"+d).disabled=true}}}function ChangeOneTouchStatus(){if(document.getElementById("status_aggressive_ck").checked){ChangeAggressiveStatus()}SetCheckBoxEnable("status_onetouch")}function ChangeAggressiveStatus(){if(document.getElementById("status_onetouch_ck").checked){ChangeOneTouchStatus()}SetCheckBoxEnable("status_aggressive");var a=document.getElementById("status_aggressive_ck").checked;if(a){document.getElementById("threshold_tr").style.display="table-row"}else{document.getElementById("threshold_tr").style.display="none"}}function ChangeBandCoexistence(b){var c="coexistence_"+b;var a="coexistence_"+b+"_ck";SetCheckBoxEnable(c)}function AddSiteSurveyLists(b){var c=HNAP.GetXML("GetSiteSurvey",new Array("RadioID",b));var f=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo#");for(var e=1;e<=f;e++){var a=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo:"+e+"/SSID");var k=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo:"+e+"/SignalStrength");var o=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo:"+e+"/SupportedSecurity/SecurityInfo/SecurityType");var m=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo:"+e+"/MacAddress");var h=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo:"+e+"/Channel");var n="";var l="";var g="";if(COMM_ToNUMBER(h)<=14){g="24"}else{g="5"}if(o!="NONE"){n='<img src="image/wisp_security.png" width="12" height="21"/>'}else{n=""}if(parseInt(k)<=35){l='<img src="image/wisp_strength_low.png" width="25" height="20"/>'}else{if(parseInt(k)<=70&&parseInt(k)>35){l='<img src="image/wisp_strength_medium.png" width="25" height="20"/>'}else{if(parseInt(k)<=100&&parseInt(k)>70){l='<img src="image/wisp_strength_high.png" width="25" height="20"/>'}}}if(ssid_num>0){for(var d=0;d<=ssid_num-1;d++){if(a==ssid_list[d].ssid&&m==ssid_list[d].mac){return}}}ssid_list[ssid_num]={ssid:a,mac:m,rssi_img:l,sec_img:n,sec_type:o,rssi_value:parseInt(k),wl_mode:g};ssid_num++}}function SortSiteSurveyList(){function a(d,c){if(d.rssi_value<c.rssi_value){return 1}if(d.rssi_value>c.rssi_value){return -1}return 0}ssid_list.sort(a)}function ChangeBgcolor(a,c){var e=document.getElementById(a).getElementsByTagName("tr");for(var b=0;b<e.length;b++){var d=e[b].getAttribute("id");if(d==c){document.getElementById(c).style.backgroundColor="#CCC"}else{document.getElementById(d).style.backgroundColor="#FFF"}}}function InjectTable(d,e,b,g){var k=document.getElementById(d).getElementsByTagName("tr");var a=null;var h=null;var c;var f;var j=false;selected_wlmode=null;selected_ssid=null;selected_security=null;for(c=0;!j&&c<k.length;c++){if(k[c].id==e){j=true}}if(j){for(c=0;c<b.length;c++){h=document.getElementById(e+"_"+c);switch(g[c]){case"text":f=b[c];if(typeof(h.innerText)!=="undefined"){h.innerText=f}else{if(typeof(h.textContent)!=="undefined"){h.textContent=f}else{h.innerHTML=f}}break;default:f=b[c];h.innerHTML=f;break}}return}a=document.getElementById(d).insertRow(k.length);a.id=e;a.onclick=function(i){selected_wlmode=b[4];selected_ssid=b[0];if(b[3].indexOf("WPAPSK")==0){selected_security="WPAPSK"}else{if(b[3].indexOf("WPA2PSK")==0){selected_security="WPA2PSK"}else{if(b[3].indexOf("WPA+2PSK")==0){selected_security="WPA+2PSK"}else{if(b[3].indexOf("WEP")==0){selected_security="WEP"}else{selected_security="NONE"}}}}ChangeBgcolor(d,e)};for(c=0;c<b.length-2;c++){h=a.insertCell(c);h.id=e+"_"+c;h.className="content";switch(g[c]){case"text":f=b[c];if(typeof(h.innerText)!=="undefined"){h.innerText=f}else{if(typeof(h.textContent)!=="undefined"){h.textContent=f}else{h.innerHTML=f}}break;default:f=b[c];h.innerHTML=f;break}}}function DrawSiteSurveyList(){var h=Math.floor((Math.random()*10)+1);SortSiteSurveyList();for(var d=0;d<ssid_list.length;d++){var a=ssid_list[d].ssid;var g=ssid_list[d].rssi_img;var b=ssid_list[d].sec_img;var j=ssid_list[d].sec_type;var e=ssid_list[d].wl_mode;var c=[a,g,b,j,e];var f=["text","img","img","text","text"];InjectTable("content_tb","hotspot"+h+"-"+d,c,f)}document.getElementById("scan_wifi_list_block").style.display="block";document.getElementById("scan_waiting").style.display="none";document.getElementById("scan_list").style.display="block"}function ShowSiteSurveyLists(a,b){CleanTable("content_tb");ssid_num=0;if(a=="OK"){AddSiteSurveyLists("5GHZ");AddSiteSurveyLists("2.4GHZ");DrawSiteSurveyList()}else{setTimeout("EventSiteSurvey()",b*1000)}}function EventSiteSurvey(){var b=HNAP.GetXML("SetTriggerWirelessSiteSurvey");b.Set("SetTriggerWirelessSiteSurvey/RadioID","RADIO_2.4GHz");var a=HNAP.SetXML("SetTriggerWirelessSiteSurvey",b);var c=a.Get("SetTriggerWirelessSiteSurveyResponse/WaitTime");var d=a.Get("SetTriggerWirelessSiteSurveyResponse/SetTriggerWirelessSiteSurveyResult");setTimeout('ShowSiteSurveyLists("'+d+'", '+c+")",c*1000)}function TriggerSiteSurvey(){document.getElementById("scan_wifi_list_block").style.display="block";document.getElementById("scan_waiting").style.display="block";document.getElementById("scan_list").style.display="none";EventSiteSurvey()}function OnClickSelect(){if(selected_ssid==""||selected_ssid==null){alert(I18N("j","Please select a wireless station."))}else{CloseSiteSurveyList();document.getElementById("apclient_ssid").value=selected_ssid;var a=document.getElementById("apclient_security");var c=document.getElementById("apclient_band");var b,d;if(selected_security.indexOf("WPAPSK")>=0){b="WPAPSK"}else{if(selected_security.indexOf("WPA2PSK")>=0){b="WPA2PSK"}else{if(selected_security.indexOf("WPA+2PSK")>=0){b="WPA+2PSK"}else{if(selected_security.indexOf("WEP")>=0){b="WEP"}else{b="NONE"}}}}if(selected_wlmode=="24"){d="24gband"}else{d="5gband"}$("#apclient_band").selectbox("detach");COMM_SetSelectValue(c,d);$("#apclient_band").selectbox();$("#apclient_security").selectbox("detach");COMM_SetSelectValue(a,b);$("#apclient_security").selectbox();ChangeSecurity(selected_security)}}function CloseSiteSurveyList(){document.getElementById("scan_wifi_list_block").style.display="none";document.getElementById("scan_waiting").style.display="none";document.getElementById("scan_list").style.display="none"}function ChangeSecurity(a){switch(a){case"NONE":document.getElementById("apclient_wep_passlen_tr").style.display="none";document.getElementById("apclient_passwd_tr").style.display="none";break;case"WEP":document.getElementById("apclient_wep_passlen_tr").style.display="table-row";document.getElementById("apclient_passwd_tr").style.display="table-row";break;case"WPAPSK":document.getElementById("apclient_wep_passlen_tr").style.display="none";document.getElementById("apclient_passwd_tr").style.display="table-row";break;case"WPA2PSK":document.getElementById("apclient_wep_passlen_tr").style.display="none";document.getElementById("apclient_passwd_tr").style.display="table-row";break;case"WPA+2PSK":document.getElementById("apclient_wep_passlen_tr").style.display="none";document.getElementById("apclient_passwd_tr").style.display="table-row";break}}function SaveAPClientValue(){var c=HNAP.GetXML("SetAPClientSettings");var g=document.getElementById("device_mode").value;var f=document.getElementById("apclient_band").value;if(f=="24gband"){c.Set("SetAPClientSettings/RadioID","RADIO_2.4GHz")}else{if(f=="5gband"){c.Set("SetAPClientSettings/RadioID","RADIO_5GHz")}}if(support_apclient||support_repeater||g=="REPEATER"){c.Set("SetAPClientSettings/Enabled","true")}else{c.Set("SetAPClientSettings/Enabled","false")}var e=document.getElementById("apclient_ssid").value;c.Set("SetAPClientSettings/SSID",e);var d=document.getElementById("apclient_security").value;var b=document.getElementById("apclient_passwd").value;switch(d){case"NONE":c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/SecurityType",d);c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/Encryptions/string","NONE");break;case"WEP":c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/SecurityType",d);c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/Encryptions/string","WEPAUTO");c.Set("SetAPClientSettings/Key",b);break;case"WPAPSK":c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/SecurityType",d);c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/Encryptions/string","AES");c.Set("SetAPClientSettings/Key",b);break;case"WPA2PSK":c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/SecurityType",d);c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/Encryptions/string","AES");c.Set("SetAPClientSettings/Key",b);break;case"WPA+2PSK":c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/SecurityType",d);c.Set("SetAPClientSettings/SupportedSecurity/SecurityInfo/Encryptions/string","TKIP+AES");c.Set("SetAPClientSettings/Key",b);break}var a=HNAP.SetXML("SetAPClientSettings",c)}function AutoWLanMode(){selected_wlmode="manual"}function Start_reciprocal_Number_RestoreConfiguration(){if(_ReciprocalNumber>=0){document.getElementById("reciprocal_Number").innerHTML=_ReciprocalNumber+" "+I18N("j","Sec");_ReciprocalNumber--;setTimeout("Start_reciprocal_Number_RestoreConfiguration()",1000)}else{if(result_24=="REBOOT"||result_5=="REBOOT"||result_smartconnect=="REBOOT"){document.getElementById("waitSettingFinish").style.display="none";document.getElementById("waitDeviceReboot").style.display="inline";document.getElementById("Font_Color_Red").innerHTML=I18N("j","Rebooting");document.getElementById("reciprocal_Number_Reboot").innerHTML=bootuptime+" "+I18N("j","Sec");timer=setTimeout("ReciprocalBootupTime()",1000);setTimeout("clearTimeout("+timer+");SavingFinishBlock()",bootuptime*1000);Reboot()}else{document.getElementById("waitSettingFinish").style.display="none";document.getElementById("SuccessSettings").style.display="inline"}}}function Reboot(){var a=HNAP.GetXML("Reboot");HNAP.SetXML("Reboot",a)}function ReciprocalBootupTime(){bootuptime--;document.getElementById("reciprocal_Number_Reboot").innerHTML=bootuptime+" "+I18N("j","Sec");timer=setTimeout("ReciprocalBootupTime()",1000)}function SavingFinishBlock(){document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("waitSettingFinish").style.display="none";document.getElementById("waitDeviceReboot").style.display="none";document.getElementById("SuccessSettings").style.display="inline"}function returnToHome(){window.location.reload()}function RedirectToURL(){if(device_mode==devicemode_org){window.location.reload()}else{window.location.href="http://"+redirect_url}}function Regenerate_PIN(){var a="";var d=0;var c=0;var e=0;for(var b=0;b<7;b++){e=(Math.floor(Math.random()*9));a+=e;d+=parseInt(e,[10])*(((b%2)==0)?3:1)}c=(10-(d%10))%10;a+=c;document.getElementById("dev_pin").value=a}function Save_Dev_Pin(){var a=HNAP.GetXML("SetWiFiVerifyAlpha");a.Set("SetWiFiVerifyAlpha/WPS/DEV_PIN",document.getElementById("dev_pin").value);var b=HNAP.SetXML("SetWiFiVerifyAlpha",a);location.reload()}function CheckPIN(e){if(e.length==4&&/^[0-9]*$/.test(e)){return e}else{if((e.length==9&&/[0-9]{4}(\-|\s)[0-9]{4}/.test(e))||(e.length==8&&/^[0-9]*$/.test(e))){if(e[4]=="-"){var a=e.split("-");e=a[0]+a[1]}else{if(e[4]==" "){var a=e.split(" ");e=a[0]+a[1]}}var c=0;var d=3;for(var b=0;b<8;b++){c=d*e.charAt(b)+c;if(d==3){d=1}else{d=3}}if((c%10)==0){return e}else{return false}}else{return false}}}function Conn_PIN_Client(){var c=CheckPIN(document.getElementById("pin_num").value);if(c){var a=HNAP.GetXML("SetWiFiVerifyAlpha");a.Set("SetWiFiVerifyAlpha/WPS/WPSPIN",c);var b=HNAP.SetXML("SetWiFiVerifyAlpha",a)}else{alert("Invalid PIN code!")}}function Conn_PBC(){var a=HNAP.GetXML("SetWiFiVerifyAlpha");a.Set("SetWiFiVerifyAlpha/WPS/WPSPBC","1");var b=HNAP.SetXML("SetWiFiVerifyAlpha",a)}function ResetToUnconfigured(){var a=HNAP.GetXML("SetWiFiVerifyAlpha");a.Set("SetWiFiVerifyAlpha/WPS/ResetToUnconfigured","1");var b=HNAP.SetXML("SetWiFiVerifyAlpha",a)}function ChangeWPSfunc(){var a=$("#wps_pbc").prop("checked");if(a==true){$("#wps_pin").prop("checked",true);document.getElementById("wps_pin").disabled=false}else{$("#wps_pin").prop("checked",false);document.getElementById("wps_pin").disabled=true}};</script> <script language="JavaScript">$(function(){$("button").click(function(){save_button_changed()});$("input, textarea, select").change(function(){save_button_changed()});$("input, textarea").keypress(function(){save_button_changed()})});</script> <style>.btn_radius{font-family:Arial,Helvetica,sens-serif;border-radius:5px;border:solid 1px #4394a7;COLOR:#fff;background-color:#4394a7;width:80px;height:30px;text-align:center}.btn_radius2{font-family:Arial,Helvetica,sens-serif;border-radius:5px;background-color:#007086;border:solid 1px #FFF;color:#fff;width:80px;height:25px;text-align:center}.PopAlertBlackBg{position:fixed;z-index:101;top:0;left:0;width:100%;height:100%;background:url(../image/black_bg.png);text-align:center}.scanPopBox{position:relative;top:100px;width:331px;height:auto;margin:0 auto}.waitScanBox{position:relative;text-align:center;top:100px;left:80px;width:222px;height:206px;background:url(../image/wisp_loading.png) left top repeat-y}.scanListBox{border-radius:10px;position:relative;top:100px;background-color:#007086;border:solid 1px #FFF;color:#FFF;padding:10px;width:331px;height:auto;text-align:left}.list_content_div{color:#333;background-color:#FFF;width:100%;height:250px;overflow:auto}.content{border-bottom:solid 1px #ccc}div.emptyline{height:12px}</style> </head> <body> <form name="wifi_form" id="wifi_form" method="POST" action=""> <div id="wrapper"> <div id="header"></div> <div id="menu"></div> <div id="content"> <div id="info"> <div id="FunctionName"><script>I18N("h","Wireless(Wi-Fi)");</script></div> <div id="wallimage"><img src="image/wifi_24.png" alt="" width="195" height="119"/></div> <div id="directions"> <script>I18N("h","Use this section to configure the wireless settings for your D-Link Router. Please note that changes made on this section may also need to be duplicated on your Wireless Client.");</script> </div> </div> <div id="funcBar"> <div id="pagePath">&nbsp;<script>I18N("h","Settings");</script> >> <script>I18N("h","Wireless(Wi-Fi)");</script></div> <ul id="rightFunc"> <li style="display:block"><div id="Save_btn" onclick="document.getElementById('sumbit_CheckData').click()" style="cursor:pointer; display:none"><script>I18N("h","Save");</script></div></li> <li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save");</script></div></li> <input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none"/> <li id="FUNC_Guest" style="display:block"><a href="javascript:CheckHTMLStatus('GuestZone');" style="text-decoration:none;" onclick="return confirmExit()"><div id="page_btn" class="linkstyle_1"><script>I18N("h","Guest Zone");</script></div></a></li> </ul> </div> <div id="main"> <br/> <div id="devicemode_block"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Device Mode");</script>:</th> <td> <div class="styled-select"> <select id="device_mode" name="device_mode" onChange="ChangeDeviceMode(this.value)"> <option value="ROUTER">Router Mode</option> </select> </div> </td> </tr> </tbody> </table> <hr/> </div> <div id="WIFI_STA" style="display:none;"> <table class="block"> <tbody> <tr> <td><div class="title"><script>I18N("h","Station");</script></div></td> <td></td> </tr> <tr> <th><script>I18N("h","Wireless Band");</script>:</th> <td> <div class="styled-select"> <select id="apclient_band" onChange=""> <option value="24gband">2.4GHz Band</option> <option value="5gband">5GHz Band</option> </select> </div> </td> <td></td> </tr> <tr> <th><script>I18N("h","Wireless Network Name");</script>:</th> <td width="220px"> <input class="styled-text" type="text" id="apclient_ssid" name="apclient_ssid" size="30" maxlength="32" onChange=""/> </td> <td> <button id="apclient_scan_btn" type="button" class="btn_radius" onClick="TriggerSiteSurvey()" style="cursor:pointer"/><script>I18N("h","Scan");</script> </td> </tr> <tr> <th><script>I18N("h","Security");</script>:</th> <td> <div class="styled-select"> <select id="apclient_security" onChange="ChangeSecurity(this.value)"> <option value="NONE">None</option> <option value="WEP">WEP</option> <option value="WPA+2PSK">WPA/WPA2-Personal</option> <option value="WPAPSK">WPA-AES</option> <option value="WPA2PSK">WPA2-AES</option> </select> </div> </td> <td></td> </tr> <tr id="apclient_wep_passlen_tr" style="display:none;"> <th><script>I18N("h","Password Length");</script>:</th> <td> <div class="styled-select"> <select id="apclient_wep_passlen"> <option value="64Hex">64 bit(10 hex digits)</option> <option value="64ASCII">64 bit(5 ascii characters)</option> <option value="128Hex">128 bit(26 hex digits)</option> <option value="128ASCII">128 bit(13 ascii characters)</option> </select> </div> </td> <td></td> </tr> <tr id="apclient_passwd_tr" style="display:none;"> <th><script>I18N("h","Password");</script>:</th> <td><input id="apclient_passwd" name="apclient_passwd" class="styled-text" type="text" size="27" autocomplete="off"></td> <td></td> </tr> </tbody> </table> </div> <div id="apclientend_line" style="display:none"> <hr/> </div> <div id="SMART_CONNECT" style="display:none"> <table class="block" border="0" cellspacing="0" style="margin: 10px 0 0 0;"> <tbody> <tr> <td><div class="title"><script>I18N("h","Smart Connect");</script></div></td> <td></td> </tr> <tr> <th><script>I18N("h","Smart Connect");</script>:</th> <td> <div id="status_smartconnect" class="checkbox_on" onclick="ChangeBandStatus('smartconnect')"> <input type="checkbox" id="status_smart_connect_ck" name="status_smart_connect_ck" checked> </div> </td> </tr> <tr> <th><script>I18N("h","Home Zone");</script>:</th> <td> <div id="status_onetouch" class="checkbox_on" onclick="ChangeOneTouchStatus()"> <input type="checkbox" id="status_onetouch_ck" name="status_onetouch_ck" checked> </div> </td> </tr> <tr id="aggressive_enable_tr" style="display:none;"> <th><script>I18N("h","Aggressive Roaming");</script>:</th> <td> <div id="status_aggressive" class="checkbox_on" onclick="ChangeAggressiveStatus()"> <input type="checkbox" id="status_aggressive_ck" name="status_aggressive_ck" checked> </div> </td> </tr> <tr id="threshold_tr" style="display:none;"> <th><script>I18N("h","Threshold");</script>:</th> <td> <div class="styled-select"> <select name="threshold_select" id="threshold_select"> <option value="-50">-50</option> <option value="-55">-55</option> <option value="-60">-60</option> <option value="-65">-65</option> <option value="-70">-70</option> <option value="-75">-75</option> <option value="-80">-80</option> </select> </div> </td> </tr> <tr id="smartconnect_ssid_tr" style="display:none;"> <th><script>I18N("h","Wi-Fi Name (SSID)");</script>:</th> <td><input class="styled-text" type="text" name="wifiName_smartconnect" maxlength="32" size="30" id="wifiName_smartconnect"></td> </tr> <tr id="smartconnect_passwd_tr" style="display:none;"> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_smartconnect" size="30" id="password_smartconnect"></td> </tr> </tbody> </table> <div id="smartconnect_line" style="display:none;" class="advButton" onclick="showAdv('SMART_CONNECT_adv');"><script>I18N("h","Advanced Settings");</script>...</div> <hr/> <div id="SMART_CONNECT_adv" style="display:none"> <table class="block"> <tbody> <tr> <th><script>I18N("h","Security Mode");</script>:</th> <td> <div class="styled-select"> <select name="security_smartconnect" id="security_smartconnect" onChange="ChangePasswordInput(this.value)"> <option value="None">None</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Transmission Power");</script>:</th> <td> <div class="styled-select"> <select name="transmissionPower_smartconnect" id="transmissionPower_smartconnect"> </select> </div> </td> </tr> <tr> <th><a href="Schedule.html"><script>I18N("h","Schedule");</script></a>:</th> <td> <div class="styled-select"> <select name="schedule_smartconnect" id="schedule_smartconnect"> <option value="ALWAYS" selected>Always</option> </select> </div> </td> </tr> </tbody> </table> </div> </div> <div id="RADIO_2GHz" style="display:none"> <table class="block" border="0" cellspacing="0" style="margin: 10px 0 0 0;"> <tbody> <tr> <td><div class="title">2.4GHz</div></td> <td></td> </tr> <tr> <th><script>I18N("h","Status");</script>:</th> <td> <div id="status_24" class="checkbox_on" onclick="ChangeBandStatus('24')"> <input type="checkbox" id="status_24_ck" name="status_24_ck" checked> </div> </td> </tr> <tr> <th><script>I18N("h","Wi-Fi Name (SSID)");</script>:</th> <td><input class="styled-text" type="text" name="wifiName_24" maxlength="32" size="30" id="wifiName_24"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_24" size="30" id="password_24"></td> </tr> </tbody> </table> <div class="advButton" onclick="showAdv('RADIO_2GHz_adv');"><script>I18N("h","Advanced Settings");</script>...</div> <hr/> <div id="RADIO_2GHz_adv" style="display:none"> <table class="block"> <tbody> <tr> <th><script>I18N("h","Security Mode");</script>:</th> <td> <div class="styled-select"> <select name="security_24" id="security_24" onChange="ChangeSupportModeList(this.value, '24')"> <option value="None">None</option> </select> </div> </td> </tr> <tr id="show_80211Mode_24G"> <th><script>I18N("h","802.11 Mode");</script>:</th> <td> <div class="styled-select"> <select name="80211Mode_24" id="80211Mode_24" onChange="ChangeWidthList('24')"> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Wi-Fi Channel");</script>:</th> <td> <div class="styled-select"> <select name="channel_24" id="channel_24" onChange="ChangeWidthList('24')"> <option value="0">Auto</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Transmission Power");</script>:</th> <td> <div class="styled-select"> <select name="transmissionPower_24" id="transmissionPower_24"> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Channel Width");</script>:</th> <td> <div class="styled-select"> <select name="channelWidth_24" id="channelWidth_24"> <option value="20">20 MHz</option> <option value="0">Auto 20/40 MHz</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","coexistence");</script>:</th> <td> <div id="coexistence_24" class="checkbox_on" onclick="ChangeBandCoexistence('24')"> <input type="checkbox" id="coexistence_24_ck" name="coexistence_24_ck" checked> </div> </td> </tr> <tr> <th><script>I18N("h","Visibility Status");</script>:</th> <td> <div class="styled-select"> <select name="visibilityStatus_24" id="visibilityStatus_24"> <option value="true">Visible</option> <option value="false">Invisible</option> </select> </div> </td> </tr> <tr> <th><a href="Schedule.html"><script>I18N("h","Schedule");</script></a>:</th> <td> <div class="styled-select"> <select name="schedule_24" id="schedule_24"> <option value="ALWAYS" selected>Always</option> </select> </div> </td> </tr> </tbody> </table> <hr/> </div> </div> <div id="RADIO_5GHz" style="display:none"> <table class="block" style="margin: 10px 0 0 0;"> <tbody> <tr> <td><div class="title">5GHz</div></td> <td></td> </tr> <tr> <th><script>I18N("h","Status");</script>:</th> <td> <div id="status_5" class="checkbox_on" onclick="ChangeBandStatus('5')"> <input type="checkbox" id="status_5_ck" name="status_5_ck" checked> </div> </td> </tr> <tr> <th><script>I18N("h","Wi-Fi Name (SSID)");</script>:</th> <td><input class="styled-text" type="text" name="wifiName_5" size="30" maxlength="32" id="wifiName_5"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_5" size="30" id="password_5"></td> </tr> </tbody> </table> <div class="advButton" onclick="showAdv('RADIO_5GHz_adv');"><script>I18N("h","Advanced Settings");</script>...</div> <hr/> <div id="RADIO_5GHz_adv" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Security Mode");</script>:</th> <td> <div class="styled-select"> <select name="security_5" id="security_5" onChange="ChangeSupportModeList(this.value, '5')"> <option value="None">None</option> </select> </div> </td> </tr> <tr id="show_80211Mode_5G"> <th><script>I18N("h","802.11 Mode");</script>:</th> <td> <div class="styled-select"> <select name="80211Mode_5" id="80211Mode_5" onChange="ChangeWidthList('5')"> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Wi-Fi Channel");</script>:</th> <td> <div class="styled-select"> <select name="channel_5" id="channel_5" onChange="ChangeWidthList('5')"> <option value="0">Auto</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Transmission Power");</script>:</th> <td> <div class="styled-select"> <select name="transmissionPower_5" id="transmissionPower_5"> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Channel Width");</script>:</th> <td> <div class="styled-select"> <select name="channelWidth_5" id="channelWidth_5"> <option value="0">Auto 20/40 MHz</option> <option value="1">Auto 20/40/80 MHz</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Visibility Status");</script>:</th> <td> <div class="styled-select"> <select name="visibilityStatus_5" id="visibilityStatus_5"> <option value="true">Visible</option> <option value="false">Invisible</option> </select> </div> </td> </tr> <tr> <th><a href="Schedule.html"><script>I18N("h","Schedule");</script></a>:</th> <td> <div class="styled-select"> <select name="schedule_5" id="schedule_5"> <option value="ALWAYS" selected>Always</option> </select> </div> </td> </tr> </tbody> </table> <hr/> </div> </div> <div id="WPS" style="display:none"> <table class="block" style="margin: 10px 0 0 0;"> <tbody> <tr> <td><div class="title"><script>I18N("h","Wi-Fi Protected Setup");</script></div></td> </tr> <tr> <th><script>I18N("h","WPS-PBC Status");</script>:</th> <td> <input type="checkbox" class="chkbox" id="wps_pbc"/> <label for="wps_pbc"><span class="chkbox_disabled"><script>I18N("h","Disabled");</script></span><span class="chkbox_enabled"><script>I18N("h","Enabled");</script></span></label> </td> </tr> <tr> <th><script>I18N("h","WPS-PIN Status");</script>:</th> <td> <input type="checkbox" class="chkbox" id="wps_pin"/><label for="wps_pin"><span class="chkbox_disabled"><script>I18N("h","Locked");</script></span><span class="chkbox_enabled"><script>I18N("h","Unlock");</script></span></label> </td> </tr> </tbody> </table> </div> <div id="wpspage" style="display:none"> <table class="block" border="0"> <tbody> <tr> <td><div class="title">WI-FI PROTECTED SETUP</div></td> </tr> <tr> <th><script>I18N("h","WPS status");</script>:</th> <td><span name="wps_status" id="wps_status"></span></td> </tr> <tr> <th><script>I18N("h","Device PIN");</script>:</th> <td> <input class="styled-text" type="text" name="dev_pin" size="15" maxlength="16" id="dev_pin" disabled="1"> <button type="button" class="button_pin" onClick="Regenerate_PIN()" style="cursor:pointer"/><script>I18N("h","Generate New PIN");</script> </td> </tr> <tr> <th></th> <td> <button type="button" class="button_pin" onClick="Save_Dev_Pin()" style="cursor:pointer"/><script>I18N("h","Save Device PIN");</script> <button type="button" class="button_pin" id="ResetWPS" onClick="ResetToUnconfigured()" style="cursor:pointer"/><script>I18N("h","Reset to Unconfigured");</script> </td> </tr> </tbody> </table> <hr/> <table class="block" style="margin: 10px 0 0 0;"> <tbody> <tr> <th>Connet to Device</th> </tr> <tr> <th><script>I18N("h","PBC");</script>:</th> <td><button type="button" class="button_pbc" id="pbc_button" onClick="Conn_PBC()" style="cursor:pointer"/><script>I18N("h","PBC Start");</script></td> </tr> <tr> <th><script>I18N("h","PIN");</script>:</th> <td> <input class="styled-text" type="text" name="pin_num" size="30" maxlength="32" id="pin_num"> <button type="button" class="button_pin" id="pin_button" onClick="Conn_PIN_Client()" style="cursor:pointer"/><script>I18N("h","PIN Start");</script> </td> </tr> </tbody> </table> </div> <div id="CreatePopAlertMessage" style="display:none"> <div id="AlertPopRect"> <div id="AlertPopBody"> <table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td> <center><div id="Loading_pop_image2"></div></center> </td> </tr> <tr> <td><center><label id="reciprocal_Number">10</label></center></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Your changes are being saved.");</script></td> </tr> </tbody> </table> <table class="myAlertPop_table_b" id="SuccessSettings" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td> <center><div id="Information_pop_image"></div></center> </td> </tr> <tr> <td> <div id="dialog_msg_black"><script>I18N("h","The new settings have been saved.");</script></div> </td> </tr> <tr> <td> <center><div id="Confirm_btn" onclick="RedirectToURL()" style="cursor:pointer"><script>I18N("h","OK");</script></div></center> </td> </tr> </tbody> </table> <table class="myAlertPop_table" id="waitDeviceReboot" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td> <center><div id="Loading_pop_image"></div></center> </td> </tr> <tr> <td><label id="reciprocal_Number_Reboot"/></td> </tr> <tr> <td id="Font_Color_Red"></td> </tr> </tbody> </table> </div> </div> </div> <div id="scan_wifi_list_block" class="PopAlertBlackBg" style="display:none"> <div class="scanPopBox"> <div id="scan_waiting" class="waitScanBox" style="display:none"> <br/> <br/> <br/> <center><img src="image/loading.gif" border="0"></center> <div><span><script>I18N("h","Scanning...");</script></span></div> <br/> </div> <div id="scan_list" class="scanListBox" style="display:none"> <div id="scan_list_title"> <table width="100%" cellspacing="0" cellpadding="0" border="0"> <tbody> <tr> <td><b><script>I18N("h","Available hotspot networks");</script></b></td> <td style="text-align: right;"> <a href="javascript:TriggerSiteSurvey()"><img src="image/wisp_reload.gif" border="0"></a> <a href="javascript:CloseSiteSurveyList()"><img src="image/wisp_close.gif" width="24" height="25" border="0"></a> </td> </tr> </tbody> </table> </div> <div class="emptyline"></div> <div id="scan_list_content"> <div class="list_content_div"> <table id="content_tb" width="100%" cellspacing="0" cellpadding="5" border="0" style="cursor:pointer"> </table> </div> </div> <div class="emptyline"></div> <div id="scan_list_slb"> <center> <div id="apclient_select_btn" onclick="OnClickSelect()" class="btn_radius2" style="cursor:pointer"> <script>I18N("h","Select");</script> </div> </center> </div> <div class="emptyline"></div> </div> </div> </div> </div> <div id="DetectRouterConnection" style="display:none"></div> <div id="footer"> <div id="copyright"><script>I18N("h","COPYRIGHT");</script></div> </div> </div> </div> </form> <script type="text/javascript" charset="utf-8">$(document).ready(function(){$.validator.addMethod("checkSetValues",function(k,e){var h=e.id;var i="";if(h.indexOf("wifiName")>=0||h=="apclient_ssid"){if(k==""||k==null){i=I18N("j","Please enter a Wi-Fi Name(SSID).")}}if(h.indexOf("password")>=0){var f=h.split("_");var l=f[1];var d=document.getElementById("security_"+l).value;if(d!="None"){if(d.match("WEP")=="WEP"){if(d=="WEP"){if(k.length!=13){i=I18N("j","Your password must be 13 characters length")}}else{if(k.length==10||k.length==26){if(!(/^[0-9a-fA-F]*$/.test(k))){i=I18N("j","WEP password length is 10 or 26, password type must be Hexadecimal.")}}else{if(k.length!=5&&k.length!=13){i=I18N("j","Your password must be 5 or 10 or 13 or 26 length.")}}}}else{if(d.match("WPA")=="WPA"){if(d=="WPA-AES"){if(k.length>63||k.length<8){i=I18N("j","Your password must be between 8-63 characters length")}}else{if(d=="WPA2-AES"){if(k.length>63||k.length<8){i=I18N("j","Your password must be between 8-63 characters length")}}else{if(d=="WPA/WPA2-Personal"){if(k.length>63||k.length<8){i=I18N("j","Your password must be between 8-63 characters length")}}else{if(k.length==64){if(!(/^[0-9a-fA-F]*$/.test(k))){i=I18N("j","WPA password length is 64, password type must be Hexadecimal.")}}else{if(k.length>64||k.length<8){i=I18N("j","Your password must be between 8-63 characters length")}}}}}}}if(k==""||k==null){i=I18N("j","Please enter a password.")}}}if(h=="apclient_passwd"){var c=/^[a-f0-9]{10}$/;var b=/^[a-f0-9]{26}$/;var d=document.getElementById("apclient_security").value;var j=document.getElementById("apclient_wep_passlen").value;if(d!="NONE"){if(d=="WEP"){if((j=="64Hex"&&!c.test(k))||(j=="128Hex"&&!b.test(k))){i=I18N("j","Please enter a value between 0 and FF.")}else{if((j=="64Hex"&&k.length!=10)||(j=="64ASCII"&&k.length!=5)){i=I18N("j","Your password must be 5 or 10 characters length.")}else{if((j=="128Hex"&&k.length!=26)||(j=="128ASCII"&&k.length!=13)){i=I18N("j","Your password must be 13 or 26 characters length.")}}}}else{if(d=="WPAPSK"){var g=/^[0-9a-fA-F]{64}$/;if(k.length>64||k.length<8){i=I18N("j","Your password must be between 8-64 characters length.")}else{if(k.length==64&&!g.test(k)){i=I18N("j","WPA password length is 64, password type must be Hexadecimal.")}}}else{if(d=="WPA2PSK"){var g=/^[0-9a-fA-F]{64}$/;if(k.length>64||k.length<8){i=I18N("j","Your password must be between 8-64 characters length.")}else{if(k.length==64&&!g.test(k)){i=I18N("j","WPA password length is 64, password type must be Hexadecimal.")}}}else{if(d=="WPA+2PSK"){var g=/^[0-9a-fA-F]{64}$/;if(k.length>64||k.length<8){i=I18N("j","Your password must be between 8-64 characters length.")}else{if(k.length==64&&!g.test(k)){i=I18N("j","WPA password length is 64, password type must be Hexadecimal.")}}}}}}if(k==""||k==null){i=I18N("j","Please enter a password.")}}}return i},"");$("#wifi_form").validate({submitHandler:function(b){CheckConnectionStatus()}});var a=$("#wifiName_24, #password_24, #wifiName_5, #password_5, #wifiName_smartconnect, #password_smartconnect, #apclient_ssid, #apclient_passwd");$.each(a,function(c,b){$(this).rules("add",{checkSetValues:true})})});</script> </body> <script type="text/javascript">Load_HTML();Initial();setMenu("menu_Settings");GetRadioInfo();InitWLAN();startTimeout();</script> </html>