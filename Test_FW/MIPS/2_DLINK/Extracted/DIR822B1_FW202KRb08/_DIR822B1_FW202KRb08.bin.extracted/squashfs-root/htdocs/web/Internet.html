<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3c.org/1999/xhtml" xml:lang="zh_TW" lang="zh_TW"> <head> <title>D-LINK</title> <meta http-equiv="X-UA-Compatible" content="IE=9"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="Content-Type" content="text/css"> <link rel=stylesheet type="text/css" href="/css/jquery.selectbox.css?v=20200423094010"/> <script type="text/javascript" charset="utf-8" src="/js/initialJS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialCSS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialJQ.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialValidate1.js"></script> <script>$(document).ready(function(){presetCheckBox("enable_Page",true);$("div.checkbox_on"||"div.checkbox_off").click(function(c){var d=c.target.id+"_ck";if(c.target.getAttribute("class")=="checkbox_on"){var b=I18N("j","Disabled");c.target.setAttribute("class","checkbox_off");c.target.setAttribute("className","checkbox_off");document.getElementById(c.target.id).innerHTML='<input type="checkbox" name='+c.target.id+" id="+d+" checked>"+b;document.getElementById(d).checked=false;if(d=="enable_Page_ck"){document.getElementById("weblink").style.display="none";document.getElementById("leasetime").style.display="none"}changeFlag=true;save_button_changed()}else{var a=I18N("j","Enabled");c.target.setAttribute("class","checkbox_on");c.target.setAttribute("className","checkbox_on");document.getElementById(c.target.id).innerHTML='<input type="checkbox" name='+c.target.id+" id="+d+' checked="">'+a;document.getElementById(d).checked=true;if(d=="enable_Page_ck"){document.getElementById("weblink").style.display="table-row";document.getElementById("leasetime").style.display="table-row"}changeFlag=true;save_button_changed()}});InitWAN()});</script> <script type="text/javascript">var HNAP=new HNAP_XML();var init_macaddr;var bootuptime=60;var timer;var current_wantype;var devicemode_org;var _ReciprocalNumber=25;var xml_GetNetworkSettings=HNAP.GetXML("GetNetworkSettings");var lan_IPAddr=xml_GetNetworkSettings.Get("GetNetworkSettingsResponse/IPAddress");var xml_GetGuestZoneSettings=HNAP.GetXML("GetGuestZoneRouterSettings");var lan_IPAddr_g=xml_GetGuestZoneSettings.Get("GetGuestZoneRouterSettingsResponse/IPAddress");var redirect_url=lan_IPAddr;var xml_GetIPv6Status=HNAP.GetXML("GetIPv6Status");var xml_GetIPv6PppoeSettings=HNAP.GetXML("GetIPv6PppoeSettings");var wan_IPv6type=xml_GetIPv6Status.Get("GetIPv6StatusResponse/IPv6_ConnectionType");var PppoeNewSession=xml_GetIPv6PppoeSettings.Get("GetIPv6PppoeSettingsResponse/IPv6_PppoeNewSession");var xml_GetWLanRadioSettings=HNAP.GetXML("GetWLanRadioSettings");var lan_macaddr=xml_GetWLanRadioSettings.Get("GetWLanRadioSettingsResponse/MacAddress");var lanmac=lan_macaddr.split(":");var xml_GetWanSettings=HNAP.GetXML("GetWanSettings");var hostname=xml_GetWanSettings.Get("GetWanSettingsResponse/HostName");function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu();initialDetectRouterConnection()}function StrToUpperCase(a){a=a.toUpperCase();return a}function InitMACList(){var d=HNAP.GetXML("GetClientInfo");var b=document.getElementById("clone_mac_DynamicIP");var a=document.getElementById("clone_mac_StaticIP");var c=document.getElementById("clone_ComputerIpByPPPoE");var g=d.Get("GetClientInfoResponse/ClientInfoLists/ClientInfo#");for(var e=1;e<=g;e++){var f=StrToUpperCase(d.Get("GetClientInfoResponse/ClientInfoLists/ClientInfo:"+e+"/MacAddress"));b.options.add(new Option(f,e));a.options.add(new Option(f,e));c.options.add(new Option(f,e))}}function ChangeConnectType(k){var d=document.getElementById("generalBlock_staticIP");var m=document.getElementById("generalBlock_DynamicIP");var o=document.getElementById("generalBlock_PPPoE");var n=document.getElementById("generalBlock_PPTP");var h=document.getElementById("generalBlock_L2TP");var l=document.getElementById("generalBlock_DSLite");var f=document.getElementById("advancedBlock");var g=document.getElementById("advancedBlock_staticIP");var j=document.getElementById("advancedBlock_DynamicIP");var c=document.getElementById("advancedBlock_PPPoE");var i=document.getElementById("advancedBlock_PPTP");var b=document.getElementById("advancedBlock_L2TP");var e=document.getElementById("advancedBlock_DSLite");var a=document.getElementById("advancedBlock_Ru_PPPoE");switch(k){case"STATIC":d.style.display="inline";o.style.display="none";n.style.display="none";h.style.display="none";f.style.display="none";g.style.display="inline";j.style.display="none";c.style.display="none";i.style.display="none";b.style.display="none";e.style.display="none";a.style.display="none";break;case"DHCP":d.style.display="none";o.style.display="none";n.style.display="none";h.style.display="none";f.style.display="none";g.style.display="none";j.style.display="inline";c.style.display="none";i.style.display="none";b.style.display="none";e.style.display="none";a.style.display="none";break;case"PPPoE":d.style.display="none";o.style.display="inline";n.style.display="none";h.style.display="none";f.style.display="none";g.style.display="none";j.style.display="none";c.style.display="inline";i.style.display="none";b.style.display="none";e.style.display="none";a.style.display="none";break;case"PPTP":d.style.display="none";o.style.display="none";n.style.display="inline";h.style.display="none";f.style.display="none";g.style.display="none";j.style.display="none";c.style.display="none";i.style.display="inline";b.style.display="none";e.style.display="none";a.style.display="none";break;case"L2TP":d.style.display="none";o.style.display="none";n.style.display="none";h.style.display="inline";f.style.display="none";g.style.display="none";j.style.display="none";c.style.display="none";i.style.display="none";b.style.display="inline";e.style.display="none";a.style.display="none";break;case"DSLite":d.style.display="none";o.style.display="none";n.style.display="none";h.style.display="none";f.style.display="none";g.style.display="none";j.style.display="none";c.style.display="none";i.style.display="none";b.style.display="none";e.style.display="inline";a.style.display="none";break;case"Ru_PPPoE":d.style.display="none";o.style.display="inline";n.style.display="none";h.style.display="none";f.style.display="none";g.style.display="none";j.style.display="none";c.style.display="inline";i.style.display="none";b.style.display="none";e.style.display="none";a.style.display="inline";break;case"Ru_PPTP":d.style.display="none";o.style.display="none";n.style.display="inline";h.style.display="none";f.style.display="none";g.style.display="none";j.style.display="none";c.style.display="none";i.style.display="inline";b.style.display="none";e.style.display="none";a.style.display="none";break;case"Ru_L2TP":d.style.display="none";o.style.display="none";n.style.display="none";h.style.display="inline";f.style.display="none";g.style.display="none";j.style.display="none";c.style.display="none";i.style.display="none";b.style.display="inline";e.style.display="none";a.style.display="none";break}DisplayMACClone(k)}function InitWAN(){var ap=HNAP.GetXML("GetDeviceFeatureAlpha");var aj=HNAP.GetXML("GetIPv6Status");var aB=HNAP.GetXML("GetRouterLanSettings");var M=ap.Get("GetDeviceFeatureAlphaResponse/FeatureBridge");var aw=ap.Get("GetDeviceFeatureAlphaResponse/FeatureRepeater");var ay=ap.Get("GetDeviceFeatureAlphaResponse/FeatureIPv6");var aE=ap.Get("GetDeviceFeatureAlphaResponse/FeatureExtender");var aP=ap.Get("GetDeviceFeatureAlphaResponse/FeatureAP");var ak=ap.Get("GetDeviceFeatureAlphaResponse/FeatureRussia");if(ak=="true"){$("#connect_type").append('<option value="Ru_PPPoE">Russia PPPoE (Dual Access)</option>');$("#connect_type").append('<option value="Ru_PPTP">Russia PPTP (Dual Access)</option>');$("#connect_type").append('<option value="Ru_L2TP">Russia L2TP (Dual Access)</option>')}if(ay){document.getElementById("FUNC_IPv6").style.display="block"}else{document.getElementById("FUNC_IPv6").style.display="none"}if(aP=="true"){$("#device_mode").append('<option value="AP">AP Mode</option>')}if(M=="true"){$("#device_mode").append('<option value="BRIDGE">Bridge Mode</option>')}if(aw=="true"){$("#device_mode").append('<option value="REPEATER">Repeater Mode</option>')}if(aE=="true"){$("#device_mode").append('<option value="EXTENDER">Extender Mode</option>')}var H=document.getElementById("device_mode");var aO=xml_GetWanSettings.Get("GetWanSettingsResponse/Type");var K=document.getElementById("connect_type");var ag;var aI=false;if(aO.indexOf("Bridged")>=0||aO.indexOf("Ap")>=0||aO.indexOf("Extender")>=0){aI=true}else{aI=false}if(aI){devicemode_org="BRIDGE";if(aO.indexOf("Extender")>=0){devicemode_org="EXTENDER"}else{if(aO.indexOf("Ap")>=0){devicemode_org="AP"}}document.getElementById("FUNC_IPv6").style.display="none";document.getElementById("directions").innerHTML=I18N("j","Use this section to configure your Internet Connection type.")}else{devicemode_org="ROUTER";document.getElementById("directions").innerHTML=I18N("j","Use this section to configure your Internet Connection type. There are several connection types to choose from Static IP, DHCP, PPPoE, PPTP, L2TP, and DS-Lite. If you are unsure of your connection method, please contact your Internet Service Provider. Note:  If using the PPPoE option, you will need to remove or disable any PPPoE client software on your computers.")}COMM_SetSelectValue(H,devicemode_org);ConnectTypeList(devicemode_org);switch(aO){case"Static":case"StaticAp":case"StaticBridged":case"StaticExtender":ag="STATIC";var t=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("iPAddress_StaticIP").value=t;var ai=xml_GetWanSettings.Get("GetWanSettingsResponse/SubnetMask");document.getElementById("subnetMask_StaticIP").value=ai;var w=xml_GetWanSettings.Get("GetWanSettingsResponse/Gateway");document.getElementById("defaultGateway_StaticIP").value=w;var S=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_StaticIP").value=S;var A=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_StaticIP").value=A;var aG=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_StaticIP_Input").value=aG;var l="";var ar=document.getElementById("mtu_StaticIP");if(aG=="1500"){l="AUTO";document.getElementById("mtu_StaticIP_Input").style.display="none"}else{l="MANUAL";document.getElementById("mtu_StaticIP_Input").style.display="inline"}COMM_SetSelectValue(ar,l);if(aO=="Static"){var Z=StrToUpperCase(xml_GetWanSettings.Get("GetWanSettingsResponse/MacAddress"));var Q=xml_GetWanSettings.Get("GetWanSettingsResponse/MacCloneEnable");document.getElementById("macAddress_StaticIP").value=COMM_ToBOOL(Q)?Z:"";init_macaddr=COMM_ToBOOL(Q)?Z:""}break;case"DHCP":case"DynamicAp":case"DynamicBridged":case"DynamicExtender":ag="DHCP";document.getElementById("hostName_DynamicIP").value=hostname;var C=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_DynamicIP").value=C;var d=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_DynamicIP").value=d;var b=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_DynamicIP_Input").value=b;var f="";var aF=document.getElementById("mtu_DynamicIP");if(b=="1500"){f="AUTO";document.getElementById("mtu_DynamicIP_Input").style.display="none"}else{f="MANUAL";document.getElementById("mtu_DynamicIP_Input").style.display="inline"}COMM_SetSelectValue(aF,f);if(aO=="DHCP"){var Z=StrToUpperCase(xml_GetWanSettings.Get("GetWanSettingsResponse/MacAddress"));var Q=xml_GetWanSettings.Get("GetWanSettingsResponse/MacCloneEnable");document.getElementById("macAddress_DynamicIP").value=COMM_ToBOOL(Q)?Z:"";init_macaddr=COMM_ToBOOL(Q)?Z:""}break;case"DHCPPPPoE":case"StaticPPPoE":ag="PPPoE";var c=xml_GetWanSettings.Get("GetWanSettingsResponse/Username");document.getElementById("userName_PPPoE").value=c;var k=xml_GetWanSettings.Get("GetWanSettingsResponse/Password");document.getElementById("password_PPPoE").value=k;var j="";var aN=document.getElementById("addressMode_PPPoE");if(aO=="DHCPPPPoE"){j="DYNAMICIP";document.getElementById("ipAddress_PPPoE").value=""}else{if(aO=="StaticPPPoE"){j="STATICIP";var v=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("ipAddress_PPPoE").value=v}}ChangeAddrMode(j,ag);COMM_SetSelectValue(aN,j);var R=xml_GetWanSettings.Get("GetWanSettingsResponse/ServiceName");document.getElementById("serviceName_PPPoE").value=R;var T=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_PPPoE").value=T;var B=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_PPPoE").value=B;var aH=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_PPPoE_Input").value=aH;var af="";var m=document.getElementById("mtu_PPPoE");if(aH=="1492"){af="AUTO";document.getElementById("mtu_PPPoE_Input").style.display="none"}else{af="MANUAL";document.getElementById("mtu_PPPoE_Input").style.display="inline"}COMM_SetSelectValue(m,af);var aL=xml_GetWanSettings.Get("GetWanSettingsResponse/AutoReconnect");var N=xml_GetWanSettings.Get("GetWanSettingsResponse/MaxIdleTime");var a="";var an=document.getElementById("reconnectMode_PPPoE");switch(aL){case"true":a="ALWAYSON";document.getElementById("maxIdleTime_PPPoE_tr").style.display="none";document.getElementById("maximumIdleTime_PPPoE").value=0;document.getElementById("maximumIdleTime_PPPoE").disabled=true;break;case"false":if(N==0){a="MANUAL";document.getElementById("maxIdleTime_PPPoE_tr").style.display="none";document.getElementById("maximumIdleTime_PPPoE").value=0;document.getElementById("maximumIdleTime_PPPoE").disabled=true}else{a="ONDEMAND";document.getElementById("maximumIdleTime_PPPoE").value=N/60;document.getElementById("maximumIdleTime_PPPoE").disabled=false}break}COMM_SetSelectValue(an,a);var Z=StrToUpperCase(xml_GetWanSettings.Get("GetWanSettingsResponse/MacAddress"));var Q=xml_GetWanSettings.Get("GetWanSettingsResponse/MacCloneEnable");document.getElementById("macAddress_PPPoE").value=COMM_ToBOOL(Q)?Z:"";init_macaddr=COMM_ToBOOL(Q)?Z:"";break;case"DynamicPPTP":case"StaticPPTP":ag="PPTP";var Y=xml_GetWanSettings.Get("GetWanSettingsResponse/Username");document.getElementById("userName_PPTP").value=Y;var au=xml_GetWanSettings.Get("GetWanSettingsResponse/Password");document.getElementById("password_PPTP").value=au;var j="";var aN=document.getElementById("addressMode_PPTP");if(aO=="DynamicPPTP"){j="DYNAMICIP"}else{if(aO=="StaticPPTP"){j="STATICIP"}}var aJ=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("ipAddress_PPTP").value=aJ;var n=xml_GetWanSettings.Get("GetWanSettingsResponse/SubnetMask");document.getElementById("subnetMask_PPTP").value=n;var x=xml_GetWanSettings.Get("GetWanSettingsResponse/Gateway");document.getElementById("gatewayIP_PPTP").value=x;ChangeAddrMode(j,ag);COMM_SetSelectValue(aN,j);var ae=xml_GetWanSettings.Get("GetWanSettingsResponse/ServiceName");document.getElementById("serverIPAddress_PPTP").value=ae;var u=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_PPTP").value=u;var aQ=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_PPTP").value=aQ;var F=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_PPTP_Input").value=F;var aK="";var al=document.getElementById("mtu_PPTP");if(F=="1400"){aK="AUTO";document.getElementById("mtu_PPTP_Input").style.display="none"}else{aK="MANUAL";document.getElementById("mtu_PPTP_Input").style.display="inline"}COMM_SetSelectValue(al,aK);var r=xml_GetWanSettings.Get("GetWanSettingsResponse/AutoReconnect");var ax=xml_GetWanSettings.Get("GetWanSettingsResponse/MaxIdleTime");var X="";var ac=document.getElementById("reconnectMode_PPTP");switch(r){case"true":X="ALWAYSON";document.getElementById("maxIdleTime_PPTP_tr").style.display="none";document.getElementById("maximumIdleTime_PPTP").value=0;document.getElementById("maximumIdleTime_PPTP").disabled=true;break;case"false":if(ax==0){X="MANUAL";document.getElementById("maxIdleTime_PPTP_tr").style.display="none";document.getElementById("maximumIdleTime_PPTP").value=0;document.getElementById("maximumIdleTime_PPTP").disabled=true}else{X="ONDEMAND";document.getElementById("maximumIdleTime_PPTP").value=ax/60;document.getElementById("maximumIdleTime_PPTP").disabled=false}break}COMM_SetSelectValue(ac,X);break;case"DynamicL2TP":case"StaticL2TP":ag="L2TP";var q=xml_GetWanSettings.Get("GetWanSettingsResponse/Username");document.getElementById("userName_L2TP").value=q;var O=xml_GetWanSettings.Get("GetWanSettingsResponse/Password");document.getElementById("password_L2TP").value=O;var j="";var aN=document.getElementById("addressMode_L2TP");if(aO=="DynamicL2TP"){j="DYNAMICIP"}else{if(aO=="StaticL2TP"){j="STATICIP"}}var W=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("ipAddress_L2TP").value=W;var I=xml_GetWanSettings.Get("GetWanSettingsResponse/SubnetMask");document.getElementById("subnetMask_L2TP").value=I;var z=xml_GetWanSettings.Get("GetWanSettingsResponse/Gateway");document.getElementById("gatewayIP_L2TP").value=z;ChangeAddrMode(j,ag);COMM_SetSelectValue(aN,j);var ah=xml_GetWanSettings.Get("GetWanSettingsResponse/ServiceName");document.getElementById("serverIPAddress_L2TP").value=ah;var aA=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_L2TP").value=aA;var ab=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_L2TP").value=ab;var E=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_L2TP_Input").value=E;var i="";var aM=document.getElementById("mtu_L2TP");if(E=="1400"){i="AUTO";document.getElementById("mtu_L2TP_Input").style.display="none"}else{i="MANUAL";document.getElementById("mtu_L2TP_Input").style.display="inline"}COMM_SetSelectValue(aM,i);var D=xml_GetWanSettings.Get("GetWanSettingsResponse/AutoReconnect");var av=xml_GetWanSettings.Get("GetWanSettingsResponse/MaxIdleTime");var h="";var y=document.getElementById("reconnectMode_L2TP");switch(D){case"true":h="ALWAYSON";document.getElementById("maxIdleTime_L2TP_tr").style.display="none";document.getElementById("maximumIdleTime_L2TP").value=0;document.getElementById("maximumIdleTime_L2TP").disabled=true;break;case"false":if(av==0){h="MANUAL";document.getElementById("maxIdleTime_L2TP_tr").style.display="none";document.getElementById("maximumIdleTime_L2TP").value=0;document.getElementById("maximumIdleTime_L2TP").disabled=true}else{h="ONDEMAND";document.getElementById("maximumIdleTime_L2TP").value=av/60;document.getElementById("maximumIdleTime_L2TP").disabled=false}break}COMM_SetSelectValue(y,h);break;case"DsLite":ag="DSLite";var G=xml_GetWanSettings.Get("GetWanSettingsResponse/DsLite_Configuration");ChangeDSLiteConfig(G);var J=document.getElementById("configuration_DSLite");COMM_SetSelectValue(J,G);var ad=xml_GetWanSettings.Get("GetWanSettingsResponse/DsLite_AFTR_IPv6Address");document.getElementById("afterIPv6Address_DSLite").value=ad;var aq=xml_GetWanSettings.Get("GetWanSettingsResponse/DsLite_B4IPv4Address");var p=aq.split(".");var aD=p[p.length-1];document.getElementById("b4IPv4Address_DSLite").value=aD;var s=aj.Get("GetIPv6StatusResponse/IPv6_Address");if(s!=""){document.getElementById("wanIPv6Address_DSLite").innerHTML=s}else{document.getElementById("wanIPv6Address_DSLite").innerHTML="N/A"}var e=aj.Get("GetIPv6StatusResponse/IPv6_DefaultGateway");if(e!=""){document.getElementById("ipv6WanDefaultGateway_DSLite").innerHTML=e}else{document.getElementById("ipv6WanDefaultGateway_DSLite").innerHTML="N/A"}break;case"Ru_DHCPPPPoE":case"Ru_StaticPPPoE":ag="Ru_PPPoE";var c=xml_GetWanSettings.Get("GetWanSettingsResponse/Username");document.getElementById("userName_PPPoE").value=c;var k=xml_GetWanSettings.Get("GetWanSettingsResponse/Password");document.getElementById("password_PPPoE").value=k;var j="";var aN=document.getElementById("addressMode_PPPoE");if(aO=="Ru_DHCPPPPoE"){j="DYNAMICIP";document.getElementById("ipAddress_PPPoE").value=""}else{if(aO=="Ru_StaticPPPoE"){j="STATICIP";var v=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("ipAddress_PPPoE").value=v}}ChangeAddrMode(j,ag);COMM_SetSelectValue(aN,j);var R=xml_GetWanSettings.Get("GetWanSettingsResponse/ServiceName");document.getElementById("serviceName_PPPoE").value=R;var T=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_PPPoE").value=T;var B=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_PPPoE").value=B;var aH=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_PPPoE_Input").value=aH;var af="";var m=document.getElementById("mtu_PPPoE");if(aH=="1492"){af="AUTO";document.getElementById("mtu_PPPoE_Input").style.display="none"}else{af="MANUAL";document.getElementById("mtu_PPPoE_Input").style.display="inline"}COMM_SetSelectValue(m,af);var aL=xml_GetWanSettings.Get("GetWanSettingsResponse/AutoReconnect");var N=xml_GetWanSettings.Get("GetWanSettingsResponse/MaxIdleTime")/60;var a="";var an=document.getElementById("reconnectMode_PPPoE");switch(aL){case"true":a="ALWAYSON";document.getElementById("maxIdleTime_PPPoE_tr").style.display="none";document.getElementById("maximumIdleTime_PPPoE").value=0;document.getElementById("maximumIdleTime_PPPoE").disabled=true;break;case"false":if(N==0){a="MANUAL";document.getElementById("maxIdleTime_PPPoE_tr").style.display="none";document.getElementById("maximumIdleTime_PPPoE").value=0;document.getElementById("maximumIdleTime_PPPoE").disabled=true}else{a="ONDEMAND";document.getElementById("maximumIdleTime_PPPoE").value=N/60;document.getElementById("maximumIdleTime_PPPoE").disabled=false}break}COMM_SetSelectValue(an,a);var V="";var at=document.getElementById("addressMode_Ru_PPPoE");var L=xml_GetWanSettings.Get("GetWanSettingsResponse/RussiaPPP/Type");var o="Ru_PPPoE_WAN";if(L=="DHCPPPPoE"){j="DYNAMICIP";document.getElementById("ipAddress_Ru_PPPoE").value=""}else{if(L=="StaticPPPoE"){j="STATICIP";var P=xml_GetWanSettings.Get("GetWanSettingsResponse/RussiaPPP/IPAddress");document.getElementById("ipAddress_Ru_PPPoE").value=P;var az=xml_GetWanSettings.Get("GetWanSettingsResponse/RussiaPPP/SubnetMask");document.getElementById("subnetMask_Ru_PPPoE").value=az;var g=xml_GetWanSettings.Get("GetWanSettingsResponse/RussiaPPP/Gateway");document.getElementById("gatewayIP_Ru_PPPoE").value=g;var ao=xml_GetWanSettings.Get("GetWanSettingsResponse/RussiaPPP/DNS/Primary");document.getElementById("primaryDNSAddress_Ru_PPPoE").value=ao;var U=xml_GetWanSettings.Get("GetWanSettingsResponse/RussiaPPP/DNS/Secondary");document.getElementById("secondaryDNSAddress_Ru_PPPoE").value=U}}ChangeAddrMode(j,o);COMM_SetSelectValue(at,j);break;case"Ru_DynamicPPTP":case"Ru_StaticPPTP":ag="Ru_PPTP";var Y=xml_GetWanSettings.Get("GetWanSettingsResponse/Username");document.getElementById("userName_PPTP").value=Y;var au=xml_GetWanSettings.Get("GetWanSettingsResponse/Password");document.getElementById("password_PPTP").value=au;var j="";var aN=document.getElementById("addressMode_PPTP");if(aO=="Ru_DynamicPPTP"){j="DYNAMICIP";document.getElementById("ipAddress_PPTP").value=""}else{if(aO=="Ru_StaticPPTP"){j="STATICIP";var aJ=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("ipAddress_PPTP").value=aJ;var n=xml_GetWanSettings.Get("GetWanSettingsResponse/SubnetMask");document.getElementById("subnetMask_PPTP").value=n;var x=xml_GetWanSettings.Get("GetWanSettingsResponse/Gateway");document.getElementById("gatewayIP_PPTP").value=x}}ChangeAddrMode(j,ag);COMM_SetSelectValue(aN,j);var ae=xml_GetWanSettings.Get("GetWanSettingsResponse/ServiceName");document.getElementById("serverIPAddress_PPTP").value=ae;var u=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_PPTP").value=u;var aQ=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_PPTP").value=aQ;var F=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_PPTP_Input").value=F;var aK="";var al=document.getElementById("mtu_PPTP");if(F=="1400"){aK="AUTO";document.getElementById("mtu_PPTP_Input").style.display="none"}else{aK="MANUAL";document.getElementById("mtu_PPTP_Input").style.display="inline"}COMM_SetSelectValue(al,aK);var r=xml_GetWanSettings.Get("GetWanSettingsResponse/AutoReconnect");var ax=xml_GetWanSettings.Get("GetWanSettingsResponse/MaxIdleTime");var X="";var ac=document.getElementById("reconnectMode_PPTP");switch(r){case"true":X="ALWAYSON";document.getElementById("maxIdleTime_PPTP_tr").style.display="none";document.getElementById("maximumIdleTime_PPTP").value=0;document.getElementById("maximumIdleTime_PPTP").disabled=true;break;case"false":if(ax==0){X="MANUAL";document.getElementById("maxIdleTime_PPTP_tr").style.display="none";document.getElementById("maximumIdleTime_PPTP").value=0;document.getElementById("maximumIdleTime_PPTP").disabled=true}else{X="ONDEMAND";document.getElementById("maximumIdleTime_PPTP").value=ax/60;document.getElementById("maximumIdleTime_PPTP").disabled=false}break}COMM_SetSelectValue(ac,X);break;case"Ru_DynamicL2TP":case"Ru_StaticL2TP":ag="Ru_L2TP";var q=xml_GetWanSettings.Get("GetWanSettingsResponse/Username");document.getElementById("userName_L2TP").value=q;var O=xml_GetWanSettings.Get("GetWanSettingsResponse/Password");document.getElementById("password_L2TP").value=O;var j="";var aN=document.getElementById("addressMode_L2TP");if(aO=="Ru_DynamicL2TP"){j="DYNAMICIP";document.getElementById("ipAddress_L2TP").value=""}else{if(aO=="Ru_StaticL2TP"){j="STATICIP";var W=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("ipAddress_L2TP").value=W;var I=xml_GetWanSettings.Get("GetWanSettingsResponse/SubnetMask");document.getElementById("subnetMask_L2TP").value=I;var z=xml_GetWanSettings.Get("GetWanSettingsResponse/Gateway");document.getElementById("gatewayIP_L2TP").value=z;document.getElementById("ipAddress_L2TP").disabled=false;document.getElementById("subnetMask_L2TP").disabled=false;document.getElementById("gatewayIP_L2TP").disabled=false}}ChangeAddrMode(j,ag);COMM_SetSelectValue(aN,j);var ah=xml_GetWanSettings.Get("GetWanSettingsResponse/ServiceName");document.getElementById("serverIPAddress_L2TP").value=ah;var aA=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_L2TP").value=aA;var ab=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_L2TP").value=ab;var E=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_L2TP_Input").value=E;var i="";var aM=document.getElementById("mtu_L2TP");if(E=="1400"){i="AUTO";document.getElementById("mtu_L2TP_Input").style.display="none"}else{i="MANUAL";document.getElementById("mtu_L2TP_Input").style.display="inline"}COMM_SetSelectValue(aM,i);var D=xml_GetWanSettings.Get("GetWanSettingsResponse/AutoReconnect");var av=xml_GetWanSettings.Get("GetWanSettingsResponse/MaxIdleTime");var h="";var y=document.getElementById("reconnectMode_L2TP");switch(D){case"true":h="ALWAYSON";document.getElementById("maxIdleTime_L2TP_tr").style.display="none";document.getElementById("maximumIdleTime_L2TP").value=0;document.getElementById("maximumIdleTime_L2TP").disabled=true;break;case"false":if(av==0){h="MANUAL";document.getElementById("maxIdleTime_L2TP_tr").style.display="none";document.getElementById("maximumIdleTime_L2TP").value=0;document.getElementById("maximumIdleTime_L2TP").disabled=true}else{h="ONDEMAND";document.getElementById("maximumIdleTime_L2TP").value=av/60;document.getElementById("maximumIdleTime_L2TP").disabled=false}break}COMM_SetSelectValue(y,h);break}current_wantype=ag;ChangeConnectType(ag);COMM_SetSelectValue(K,ag);$("#device_mode").selectbox();$("#connect_type").selectbox("detach");$("#connect_type").selectbox();$("#mtu_StaticIP").selectbox();$("#clone_mac_StaticIP").selectbox();$("#mtu_DynamicIP").selectbox();$("#clone_mac_DynamicIP").selectbox();$("#addressMode_PPPoE").selectbox();$("#reconnectMode_PPPoE").selectbox();$("#mtu_PPPoE").selectbox();$("#clone_ComputerIpByPPPoE").selectbox();$("#addressMode_PPTP").selectbox();$("#reconnectMode_PPTP").selectbox();$("#mtu_PPTP").selectbox();$("#addressMode_L2TP").selectbox();$("#reconnectMode_L2TP").selectbox();$("#mtu_L2TP").selectbox();$("#configuration_DSLite").selectbox();$("#addressMode_Ru_PPPoE").selectbox();var aB=HNAP.GetXML("GetRedirectSettings");var am=aB.Get("GetRedirectSettingsResponse/Enabled");var aC=aB.Get("GetRedirectSettingsResponse/Leasetime");var aa=aB.Get("GetRedirectSettingsResponse/URL");if(am=="true"){presetCheckBox("enable_Page",true);document.getElementById("weblink").style.display="table-row";document.getElementById("leasetime").style.display="table-row";document.getElementById("lease_time").value=aC;document.getElementById("website_link").value=aa}else{presetCheckBox("enable_Page",false);document.getElementById("weblink").style.display="none";document.getElementById("leasetime").style.display="none"}}function CheckConnectionStatus(){$.ajax({cache:false,url:"./js/CheckConnection",timeout:2000,type:"GET",success:function(a){SetXML()},error:function(){document.getElementById("DetectRouterConnection").style.display="inline"}})}function SetXML(){HNAP.GetXMLAsync("SetRedirectSettings",null,"GetXML",function(a){SetResult_1st(a)})}function SetResult_1st(a){if(a!=null){if(document.getElementById("enable_Page_ck").checked=="1"){a.Set("SetRedirectSettings/Enabled","true");a.Set("SetRedirectSettings/Leasetime",document.getElementById("lease_time").value);a.Set("SetRedirectSettings/URL",document.getElementById("website_link").value);HNAP.SetXMLAsync("SetRedirectSettings",a,function(b){SetResult_2nd(b)})}else{a.Set("SetRedirectSettings/Enabled","false");a.Set("SetRedirectSettings/Leasetime","");a.Set("SetRedirectSettings/URL","")}HNAP.SetXMLAsync("SetRedirectSettings",a,function(b){SetResult_2nd(b)})}else{if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_1st")}}}function SetResult_2nd(b){var a=b.Get("SetRedirectSettingsResponse/SetRedirectSettingsResult");if(a=="OK"){HNAP.GetXMLAsync("SetWanSettings",null,"GetXML",function(c){SaveWAN(c)})}if(a=="ERROR"){if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_2nd")}}}function SaveWAN(g){var g=HNAP.GetXML("SetWanSettings");var m=document.getElementById("connect_type").value;var h=document.getElementById("device_mode").value;var d=document.getElementById("iPAddress_StaticIP").value;switch(m){case"STATIC":if(h=="BRIDGE"){g.Set("SetWanSettings/Type","StaticBridged")}else{if(h=="AP"){g.Set("SetWanSettings/Type","StaticAp")}else{if(h=="EXTENDER"){g.Set("SetWanSettings/Type","StaticExtender")}else{g.Set("SetWanSettings/Type","Static");g.Set("SetWanSettings/MacAddress",document.getElementById("macAddress_StaticIP").value)}}}g.Set("SetWanSettings/IPAddress",d);g.Set("SetWanSettings/SubnetMask",document.getElementById("subnetMask_StaticIP").value);g.Set("SetWanSettings/Gateway",document.getElementById("defaultGateway_StaticIP").value);g.Set("SetWanSettings/MTU",document.getElementById("mtu_StaticIP_Input").value);var o=document.getElementById("mtu_StaticIP").value;if(o=="AUTO"){g.Set("SetWanSettings/MTU","1500")}else{g.Set("SetWanSettings/MTU",document.getElementById("mtu_StaticIP_Input").value)}g.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_StaticIP").value);g.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_StaticIP").value);break;case"DHCP":if(h=="BRIDGE"){g.Set("SetWanSettings/Type","DynamicBridged")}else{if(h=="AP"){g.Set("SetWanSettings/Type","DynamicAp")}else{if(h=="EXTENDER"){g.Set("SetWanSettings/Type","DynamicExtender")}else{g.Set("SetWanSettings/Type","DHCP");g.Set("SetWanSettings/MacAddress",document.getElementById("macAddress_DynamicIP").value)}}}g.Set("SetWanSettings/MTU",document.getElementById("mtu_DynamicIP_Input").value);var j=g.Get("SetWanSettings/MTU");var e=document.getElementById("mtu_DynamicIP").value;if(e=="AUTO"){g.Set("SetWanSettings/MTU","1500")}else{g.Set("SetWanSettings/MTU",document.getElementById("mtu_DynamicIP_Input").value)}g.Set("SetWanSettings/HostName",document.getElementById("hostName_DynamicIP").value);g.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_DynamicIP").value);g.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_DynamicIP").value);break;case"PPPoE":g.Set("SetWanSettings/Username",document.getElementById("userName_PPPoE").value);g.Set("SetWanSettings/Password",document.getElementById("password_PPPoE").value);var a=document.getElementById("addressMode_PPPoE").value;if(a=="DYNAMICIP"){g.Set("SetWanSettings/Type","DHCPPPPoE");g.Set("SetWanSettings/IPAddress","")}else{if(a=="STATICIP"){g.Set("SetWanSettings/Type","StaticPPPoE");g.Set("SetWanSettings/IPAddress",document.getElementById("ipAddress_PPPoE").value)}}g.Set("SetWanSettings/MacAddress",document.getElementById("macAddress_PPPoE").value);g.Set("SetWanSettings/ServiceName",document.getElementById("serviceName_PPPoE").value);var k=document.getElementById("reconnectMode_PPPoE").value;switch(k){case"ALWAYSON":g.Set("SetWanSettings/AutoReconnect","true");g.Set("SetWanSettings/MaxIdleTime","0");break;case"ONDEMAND":g.Set("SetWanSettings/AutoReconnect","false");g.Set("SetWanSettings/MaxIdleTime",document.getElementById("maximumIdleTime_PPPoE").value*60);break;case"MANUAL":g.Set("SetWanSettings/AutoReconnect","false");g.Set("SetWanSettings/MaxIdleTime","0");break}var l=document.getElementById("mtu_PPPoE").value;if(l=="AUTO"){g.Set("SetWanSettings/MTU","1492")}else{g.Set("SetWanSettings/MTU",document.getElementById("mtu_PPPoE_Input").value)}g.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_PPPoE").value);g.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_PPPoE").value);break;case"PPTP":g.Set("SetWanSettings/ServiceName",document.getElementById("serverIPAddress_PPTP").value);g.Set("SetWanSettings/Username",document.getElementById("userName_PPTP").value);g.Set("SetWanSettings/Password",document.getElementById("password_PPTP").value);var a=document.getElementById("addressMode_PPTP").value;if(a=="DYNAMICIP"){g.Set("SetWanSettings/Type","DynamicPPTP");g.Set("SetWanSettings/IPAddress","");g.Set("SetWanSettings/SubnetMask","");g.Set("SetWanSettings/Gateway","")}else{if(a=="STATICIP"){g.Set("SetWanSettings/Type","StaticPPTP");g.Set("SetWanSettings/IPAddress",document.getElementById("ipAddress_PPTP").value);g.Set("SetWanSettings/SubnetMask",document.getElementById("subnetMask_PPTP").value);g.Set("SetWanSettings/Gateway",document.getElementById("gatewayIP_PPTP").value)}}var k=document.getElementById("reconnectMode_PPTP").value;switch(k){case"ALWAYSON":g.Set("SetWanSettings/AutoReconnect","true");g.Set("SetWanSettings/MaxIdleTime","0");break;case"ONDEMAND":g.Set("SetWanSettings/AutoReconnect","false");g.Set("SetWanSettings/MaxIdleTime",document.getElementById("maximumIdleTime_PPTP").value*60);break;case"MANUAL":g.Set("SetWanSettings/AutoReconnect","false");g.Set("SetWanSettings/MaxIdleTime","0");break}var l=document.getElementById("mtu_PPTP").value;if(l=="AUTO"){g.Set("SetWanSettings/MTU","1400")}else{g.Set("SetWanSettings/MTU",document.getElementById("mtu_PPTP_Input").value)}g.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_PPTP").value);g.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_PPTP").value);break;case"L2TP":g.Set("SetWanSettings/ServiceName",document.getElementById("serverIPAddress_L2TP").value);g.Set("SetWanSettings/Username",document.getElementById("userName_L2TP").value);g.Set("SetWanSettings/Password",document.getElementById("password_L2TP").value);var a=document.getElementById("addressMode_L2TP").value;if(a=="DYNAMICIP"){g.Set("SetWanSettings/Type","DynamicL2TP");g.Set("SetWanSettings/IPAddress","");g.Set("SetWanSettings/SubnetMask","");g.Set("SetWanSettings/Gateway","")}else{if(a=="STATICIP"){g.Set("SetWanSettings/Type","StaticL2TP");g.Set("SetWanSettings/IPAddress",document.getElementById("ipAddress_L2TP").value);g.Set("SetWanSettings/SubnetMask",document.getElementById("subnetMask_L2TP").value);g.Set("SetWanSettings/Gateway",document.getElementById("gatewayIP_L2TP").value)}}var k=document.getElementById("reconnectMode_L2TP").value;switch(k){case"ALWAYSON":g.Set("SetWanSettings/AutoReconnect","true");g.Set("SetWanSettings/MaxIdleTime","0");break;case"ONDEMAND":g.Set("SetWanSettings/AutoReconnect","false");g.Set("SetWanSettings/MaxIdleTime",document.getElementById("maximumIdleTime_L2TP").value*60);break;case"MANUAL":g.Set("SetWanSettings/AutoReconnect","false");g.Set("SetWanSettings/MaxIdleTime","0");break}var l=document.getElementById("mtu_L2TP").value;if(l=="AUTO"){g.Set("SetWanSettings/MTU","1400")}else{g.Set("SetWanSettings/MTU",document.getElementById("mtu_L2TP_Input").value)}g.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_L2TP").value);g.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_L2TP").value);break;case"DSLite":g.Set("SetWanSettings/Type","DsLite");var f=document.getElementById("configuration_DSLite").value;g.Set("SetWanSettings/DsLite_Configuration",f);var c=document.getElementById("b4IPv4Address_DSLite").value;if(c!=""){g.Set("SetWanSettings/DsLite_B4IPv4Address","192.0.0."+c)}g.Set("SetWanSettings/DsLite_AFTR_IPv6Address",document.getElementById("afterIPv6Address_DSLite").value);break;case"Ru_PPPoE":g.Set("SetWanSettings/Username",document.getElementById("userName_PPPoE").value);g.Set("SetWanSettings/Password",document.getElementById("password_PPPoE").value);var a=document.getElementById("addressMode_PPPoE").value;if(a=="DYNAMICIP"){g.Set("SetWanSettings/Type","Ru_DHCPPPPoE");g.Set("SetWanSettings/IPAddress","")}else{if(a=="STATICIP"){g.Set("SetWanSettings/Type","Ru_StaticPPPoE");g.Set("SetWanSettings/IPAddress",document.getElementById("ipAddress_PPPoE").value)}}g.Set("SetWanSettings/ServiceName",document.getElementById("serviceName_PPPoE").value);var k=document.getElementById("reconnectMode_PPPoE").value;switch(k){case"ALWAYSON":g.Set("SetWanSettings/AutoReconnect","true");g.Set("SetWanSettings/MaxIdleTime","0");break;case"ONDEMAND":g.Set("SetWanSettings/AutoReconnect","false");g.Set("SetWanSettings/MaxIdleTime",document.getElementById("maximumIdleTime_PPPoE").value*60);break;case"MANUAL":g.Set("SetWanSettings/AutoReconnect","false");g.Set("SetWanSettings/MaxIdleTime","0");break}var l=document.getElementById("mtu_PPPoE").value;if(l=="AUTO"){g.Set("SetWanSettings/MTU","1492")}else{g.Set("SetWanSettings/MTU",document.getElementById("mtu_PPPoE_Input").value)}g.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_PPPoE").value);g.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_PPPoE").value);var n=document.getElementById("addressMode_Ru_PPPoE").value;if(n=="DYNAMICIP"){g.Set("SetWanSettings/RussiaPPP/Type","DHCPPPPoE");g.Set("SetWanSettings/RussiaPPP/IPAddress","");g.Set("SetWanSettings/RussiaPPP/SubnetMask","");g.Set("SetWanSettings/RussiaPPP/Gateway","");g.Set("SetWanSettings/RussiaPPP/DNS/Primary","");g.Set("SetWanSettings/RussiaPPP/DNS/Secondary","")}else{if(n=="STATICIP"){g.Set("SetWanSettings/RussiaPPP/Type","StaticPPPoE");g.Set("SetWanSettings/RussiaPPP/IPAddress",document.getElementById("ipAddress_Ru_PPPoE").value);g.Set("SetWanSettings/RussiaPPP/SubnetMask",document.getElementById("subnetMask_Ru_PPPoE").value);g.Set("SetWanSettings/RussiaPPP/Gateway",document.getElementById("gatewayIP_Ru_PPPoE").value);g.Set("SetWanSettings/RussiaPPP/DNS/Primary",document.getElementById("primaryDNSAddress_Ru_PPPoE").value);g.Set("SetWanSettings/RussiaPPP/DNS/Secondary",document.getElementById("secondaryDNSAddress_Ru_PPPoE").value)}}break;case"Ru_PPTP":g.Set("SetWanSettings/ServiceName",document.getElementById("serverIPAddress_PPTP").value);g.Set("SetWanSettings/Username",document.getElementById("userName_PPTP").value);g.Set("SetWanSettings/Password",document.getElementById("password_PPTP").value);var a=document.getElementById("addressMode_PPTP").value;if(a=="DYNAMICIP"){g.Set("SetWanSettings/Type","Ru_DynamicPPTP");g.Set("SetWanSettings/IPAddress","");g.Set("SetWanSettings/SubnetMask","");g.Set("SetWanSettings/Gateway","")}else{if(a=="STATICIP"){g.Set("SetWanSettings/Type","Ru_StaticPPTP");g.Set("SetWanSettings/IPAddress",document.getElementById("ipAddress_PPTP").value);g.Set("SetWanSettings/SubnetMask",document.getElementById("subnetMask_PPTP").value);g.Set("SetWanSettings/Gateway",document.getElementById("gatewayIP_PPTP").value)}}var k=document.getElementById("reconnectMode_PPTP").value;switch(k){case"ALWAYSON":g.Set("SetWanSettings/AutoReconnect","true");g.Set("SetWanSettings/MaxIdleTime","0");break;case"ONDEMAND":g.Set("SetWanSettings/AutoReconnect","false");g.Set("SetWanSettings/MaxIdleTime",document.getElementById("maximumIdleTime_PPTP").value*60);break;case"MANUAL":g.Set("SetWanSettings/AutoReconnect","false");g.Set("SetWanSettings/MaxIdleTime","0");break}var l=document.getElementById("mtu_PPTP").value;if(l=="AUTO"){g.Set("SetWanSettings/MTU","1400")}else{g.Set("SetWanSettings/MTU",document.getElementById("mtu_PPTP_Input").value)}g.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_PPTP").value);g.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_PPTP").value);break;case"Ru_L2TP":g.Set("SetWanSettings/ServiceName",document.getElementById("serverIPAddress_L2TP").value);g.Set("SetWanSettings/Username",document.getElementById("userName_L2TP").value);g.Set("SetWanSettings/Password",document.getElementById("password_L2TP").value);var a=document.getElementById("addressMode_L2TP").value;if(a=="DYNAMICIP"){g.Set("SetWanSettings/Type","Ru_DynamicL2TP");g.Set("SetWanSettings/IPAddress","");g.Set("SetWanSettings/SubnetMask","");g.Set("SetWanSettings/Gateway","")}else{if(a=="STATICIP"){g.Set("SetWanSettings/Type","Ru_StaticL2TP");g.Set("SetWanSettings/IPAddress",document.getElementById("ipAddress_L2TP").value);g.Set("SetWanSettings/SubnetMask",document.getElementById("subnetMask_L2TP").value);g.Set("SetWanSettings/Gateway",document.getElementById("gatewayIP_L2TP").value)}}var k=document.getElementById("reconnectMode_L2TP").value;switch(k){case"ALWAYSON":g.Set("SetWanSettings/AutoReconnect","true");g.Set("SetWanSettings/MaxIdleTime","0");break;case"ONDEMAND":g.Set("SetWanSettings/AutoReconnect","false");g.Set("SetWanSettings/MaxIdleTime",document.getElementById("maximumIdleTime_L2TP").value*60);break;case"MANUAL":g.Set("SetWanSettings/AutoReconnect","false");g.Set("SetWanSettings/MaxIdleTime","0");break}var l=document.getElementById("mtu_L2TP").value;if(l=="AUTO"){g.Set("SetWanSettings/MTU","1400")}else{g.Set("SetWanSettings/MTU",document.getElementById("mtu_L2TP_Input").value)}g.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_L2TP").value);g.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_L2TP").value);break}var i=HNAP.SetXML("SetWanSettings",g);var p=i.Get("SetWanSettingsResponse/SetWanSettingsResult");if(p=="REBOOT"){document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("waitSettingFinish").style.display="none";document.getElementById("waitDeviceReboot").style.display="inline";document.getElementById("SuccessREBOOT").style.display="none";var b;if(h==devicemode_org){b=I18N("j","Rebooting")}else{if(h=="BRIDGE"||h=="AP"||h=="EXTENDER"){if(m=="STATIC"){redirect_url=d}else{if(m=="DHCP"){redirect_url=hostname+lanmac[4]+lanmac[5]+".local"}}b=I18N("j","The device is changing to bridge mode.");if(h=="AP"){b=I18N("j","The device is changing to ap mode.")}else{if(h=="EXTENDER"){b=I18N("j","The device is changing to Extender mode.")}}}else{b=I18N("j","The device is changing to router mode.")}}document.getElementById("Font_Color_Red").innerHTML=b;document.getElementById("reciprocal_Number_Reboot").innerHTML=bootuptime+" "+I18N("j","Sec");timer=setTimeout("ReciprocalBootupTime()",1000);setTimeout("clearTimeout("+timer+");SavingFinishBlock()",bootuptime*1000);Reboot()}else{document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("waitSettingFinish").style.display="inline";document.getElementById("waitDeviceReboot").style.display="none";document.getElementById("SuccessREBOOT").style.display="none";if(h=="BRIDGE"||h=="AP"||h=="EXTENDER"){if(m=="STATIC"){redirect_url=d}else{if(m=="DHCP"){redirect_url="192.168.0.50"}}setTimeout("RedirectToURL()",1000)}else{setTimeout("window.location.reload()",1000)}}}function waitSettingFinished(){window.location.reload()}function Start_reciprocal_Number_RestoreConfiguration(){if(_ReciprocalNumber>=0){document.getElementById("reciprocal_Number").innerHTML=_ReciprocalNumber+" "+I18N("j","Sec");_ReciprocalNumber--;setTimeout("Start_reciprocal_Number_RestoreConfiguration()",1000)}else{document.getElementById("waitSettingFinish").style.display="none";document.getElementById("SuccessSettings").style.display="inline"}}function Reboot(){var a=HNAP.GetXML("Reboot");HNAP.SetXML("Reboot",a)}function ReciprocalBootupTime(){bootuptime--;document.getElementById("reciprocal_Number_Reboot").innerHTML=bootuptime+" "+I18N("j","Sec");timer=setTimeout("ReciprocalBootupTime()",1000)}function SavingFinishBlock(){document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("waitSettingFinish").style.display="none";document.getElementById("waitDeviceReboot").style.display="none";document.getElementById("SuccessREBOOT").style.display="inline"}function RedirectToURL(){window.location.href="http://"+redirect_url}function ListMACAddress(b,a,c){if(a==0){document.getElementById("macAddress_"+c).value=init_macaddr}else{document.getElementById("macAddress_"+c).value=b.options[a].text}}function ListMACAddressByPPPoE_Select(b,a){if(a==0){document.getElementById("macAddress_PPPoE").value=tmp_MACAddress}else{document.getElementById("macAddress_PPPoE").value=b.options[a].text}}function ChangeMTU(a,b){switch(a){case"AUTO":document.getElementById("mtu_"+b+"_tr").style.display="none";document.getElementById("mtu_"+b+"_Input").style.display="none";break;case"MANUAL":document.getElementById("mtu_"+b+"_tr").style.display="inline";document.getElementById("mtu_"+b+"_Input").style.display="inline";break}}function ChangeAddrMode(a,b){switch(b){case"PPPoE":if(a=="DYNAMICIP"){document.getElementById("ipAddress_tr").style.display="none"}else{if(a=="STATICIP"){document.getElementById("ipAddress_tr").style.display="table-row"}}break;case"PPTP":case"L2TP":if(a=="DYNAMICIP"){document.getElementById("ipAddress_"+b+"_tr").style.display="none";document.getElementById("subnetMask_"+b+"_tr").style.display="none";document.getElementById("gatewayIP_"+b+"_tr").style.display="none"}else{if(a=="STATICIP"){document.getElementById("ipAddress_"+b+"_tr").style.display="table-row";document.getElementById("subnetMask_"+b+"_tr").style.display="table-row";document.getElementById("gatewayIP_"+b+"_tr").style.display="table-row"}}break;case"Ru_PPPoE":if(a=="DYNAMICIP"){document.getElementById("ipAddress_tr").style.display="none"}else{if(a=="STATICIP"){document.getElementById("ipAddress_tr").style.display="table-row"}}break;case"Ru_PPPoE_WAN":if(a=="DYNAMICIP"){document.getElementById("ipAddress_"+b+"_tr").style.display="none";document.getElementById("subnetMask_"+b+"_tr").style.display="none";document.getElementById("gatewayIP_"+b+"_tr").style.display="none";document.getElementById("primaryDNSAddress_"+b+"_tr").style.display="none";document.getElementById("secondaryDNSAddress_"+b+"_tr").style.display="none"}else{if(a=="STATICIP"){document.getElementById("ipAddress_"+b+"_tr").style.display="table-row";document.getElementById("subnetMask_"+b+"_tr").style.display="table-row";document.getElementById("gatewayIP_"+b+"_tr").style.display="table-row";document.getElementById("primaryDNSAddress_"+b+"_tr").style.display="table-row";document.getElementById("secondaryDNSAddress_"+b+"_tr").style.display="table-row"}}break;case"Ru_PPTP":if(a=="DYNAMICIP"){document.getElementById("ipAddress_PPTP_tr").style.display="none";document.getElementById("subnetMask_PPTP_tr").style.display="none";document.getElementById("gatewayIP_PPTP_tr").style.display="none"}else{if(a=="STATICIP"){document.getElementById("ipAddress_PPTP_tr").style.display="table-row";document.getElementById("subnetMask_PPTP_tr").style.display="table-row";document.getElementById("gatewayIP_PPTP_tr").style.display="table-row"}}break;case"Ru_L2TP":if(a=="DYNAMICIP"){document.getElementById("ipAddress_L2TP_tr").style.display="none";document.getElementById("subnetMask_L2TP_tr").style.display="none";document.getElementById("gatewayIP_L2TP_tr").style.display="none"}else{if(a=="STATICIP"){document.getElementById("ipAddress_L2TP_tr").style.display="table-row";document.getElementById("subnetMask_L2TP_tr").style.display="table-row";document.getElementById("gatewayIP_L2TP_tr").style.display="table-row"}}break}}function ChangeReconnectMode(a,b){switch(a){case"ALWAYSON":case"MANUAL":document.getElementById("maxIdleTime_"+b+"_tr").style.display="none";document.getElementById("maximumIdleTime_"+b).value="0";break;case"ONDEMAND":document.getElementById("maximumIdleTime_"+b).disabled=false;document.getElementById("maximumIdleTime_"+b).value="5";document.getElementById("maxIdleTime_"+b+"_tr").style.display="table-row";break}}function ChangeDSLiteConfig(a){switch(a){case"Dhcpv6Option":document.getElementById("afterIPv6Address_DSLite_tr").style.display="none";break;case"Manual":document.getElementById("afterIPv6Address_DSLite_tr").style.display="table-row";break}}function DisplayMACClone(a){var b=document.getElementById("device_mode").value;switch(a){case"STATIC":if(b=="BRIDGE"||b=="AP"||b=="EXTENDER"){document.getElementById("mac_clone_StaticIP_tr").style.display="none"}else{if(b=="ROUTER"){document.getElementById("mac_clone_StaticIP_tr").style.display="table-row"}}break;case"DHCP":if(b=="BRIDGE"||b=="AP"||b=="EXTENDER"){document.getElementById("mac_clone_DynamicIP_tr").style.display="none"}else{if(b=="ROUTER"){document.getElementById("mac_clone_DynamicIP_tr").style.display="table-row"}}break}}function ConnectTypeList(b){$("#connect_type").children().remove();var c=HNAP.GetXML("GetDeviceFeatureAlpha");var a=c.Get("GetDeviceFeatureAlphaResponse/FeatureRussia");switch(b){case"BRIDGE":case"AP":case"EXTENDER":$("#connect_type").append('<option value="STATIC">Static IP</option>');$("#connect_type").append('<option value="DHCP">Dynamic IP (DHCP)</option>');break;case"ROUTER":if(a=="true"){$("#connect_type").append('<option value="STATIC">Static IP</option>');$("#connect_type").append('<option value="DHCP">Dynamic IP (DHCP)</option>');$("#connect_type").append('<option value="PPPoE">PPPoE</option>');$("#connect_type").append('<option value="PPTP">PPTP</option>');$("#connect_type").append('<option value="L2TP">L2TP</option>');$("#connect_type").append('<option value="DSLite">DS-Lite</option>');$("#connect_type").append('<option value="Ru_PPPoE">Russia PPPoE (Dual Access)</option>');$("#connect_type").append('<option value="Ru_PPTP">Russia PPTP (Dual Access)</option>');$("#connect_type").append('<option value="Ru_L2TP">Russia L2TP (Dual Access)</option>')}else{$("#connect_type").append('<option value="STATIC">Static IP</option>');$("#connect_type").append('<option value="DHCP">Dynamic IP (DHCP)</option>');$("#connect_type").append('<option value="PPPoE">PPPoE</option>');$("#connect_type").append('<option value="PPTP">PPTP</option>');$("#connect_type").append('<option value="L2TP">L2TP</option>');$("#connect_type").append('<option value="DSLite">DS-Lite</option>')}break}}function ChangeDeviceMode(b){$("#connect_type").selectbox("detach");ConnectTypeList(b);var a=document.getElementById("connect_type");if(current_wantype=="STATIC"||current_wantype=="DHCP"){current_wantype=current_wantype}else{current_wantype="DHCP"}DisplayMACClone(current_wantype);ChangeConnectType(current_wantype);COMM_SetSelectValue(a,current_wantype);$("#connect_type").selectbox("attach")}function ReplaceEmpty(a,b){a.value=a.value.replace(/\s/g,"")};</script> <script type="text/javascript">$(function(){$("select").change(function(){save_button_changed()});$("input").keydown(function(){save_button_changed()})});</script> </head> <body> <form name="internet_form" id="internet_form" method="POST" action=""> <div id="wrapper"> <div id="header"></div> <div id="menu"></div> <div id="content"> <div id="info"> <div id="FunctionName"><script>I18N("h","Internet");</script></div> <div id="wallimage"><img src="image/internet_page.png" alt="" width="195" height="119"/></div> <div id="directions"> </div> </div> <div id="funcBar"> <div id="pagePath">&nbsp;<script>I18N("h","Settings");</script> >> <script>I18N("h","Internet");</script></div> <ul id="rightFunc"> <li style="display:block"><div id="Save_btn" onclick="document.getElementById('sumbit_CheckData').click()" style="cursor:pointer; display:none"><script>I18N("h","Save");</script></div></li> <li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save");</script></div></li> <input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none"/> <li id="FUNC_IPv6" style="display:block"><a href="javascript:CheckHTMLStatus('Internet_IPv6');" style="text-decoration:none;" onclick="return confirmExit()"><div id="page_btn" class="linkstyle_1"><script>I18N("h","IPv6");</script></div></a></li> </ul> </div> <br/> <div id="main"> <div id="devicemode_block" style="display:none;"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Device Mode");</script>:</th> <td> <div class="styled-select"> <select id="device_mode" name="device_mode" onChange="ChangeDeviceMode(this.value)"> <option value="ROUTER">Router Mode</option> </select> </div> </td> </tr> </tbody> </table> <hr/> </div> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","My Internet Connection is");</script>:</th> <td> <div class="styled-select"> <select id="connect_type" name="connect_type" onChange="ChangeConnectType(this.value);"> <option value="STATIC">Static IP</option> <option value="DHCP">Dynamic IP (DHCP)</option> <option value="PPPoE">PPPoE</option> <option value="PPTP">PPTP</option> <option value="L2TP">L2TP</option> <option value="DSLite">DS-Lite</option> </select> </div> <input class="styled-text" type="text" name="value_Session" size="1" id="value_Session" value="1" style="visibility: hidden; position: absolute; width: 0px; height: 0px;"> </td> </tr> </tbody> </table> <div id="generalBlock_staticIP" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","IP Address");</script>:</th> <td><input class="styled-text" type="text" name="iPAddress_StaticIP" size="27" maxlength="15" id="iPAddress_StaticIP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Subnet Mask");</script>:</th> <td><input class="styled-text" type="text" name="subnetMask_StaticIP" size="27" maxlength="15" id="subnetMask_StaticIP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Default Gateway");</script>:</th> <td><input class="styled-text" type="text" name="defaultGateway_StaticIP" size="27" maxlength="15" id="defaultGateway_StaticIP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td><input class="styled-text" type="text" name="primaryDNSAddress_StaticIP" size="27" maxlength="15" id="primaryDNSAddress_StaticIP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> </tbody> </table> </div> </div> <div id="generalBlock_PPPoE" style="display:none"> <table class="block"> <tbody> <tr> <th><script>I18N("h","Username");</script>:</th> <td><input class="styled-text" type="text" name="userName_PPPoE" size="27" maxlength="255" id="userName_PPPoE"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_PPPoE" size="27" maxlength="255" id="password_PPPoE"></td> </tr> <tr> <th><script>I18N("h","Reconnect Mode");</script>:</th> <td> <div class="styled-select"> <select name="reconnectMode_PPPoE" id="reconnectMode_PPPoE" onChange="ChangeReconnectMode(this.value, 'PPPoE')"> <option value="ALWAYSON">Always on</option> <option value="ONDEMAND" selected>On demand</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td></td> </tr> <tr id="maxIdleTime_PPPoE_tr"> <th><script>I18N("h","Maximum Idle Time");</script>:</th> <td><input class="styled-text" style="width: 120px;" type="text" name="maximumIdleTime_PPPoE" id="maximumIdleTime_PPPoE" value="5" maxlength="5">&nbsp;&nbsp;<script>I18N("h","minutes");</script></td> <td></td> </tr> </tbody> </table> </div> <div id="generalBlock_PPTP" style="display:none"> <table class="block"> <tbody> <tr> <th><script>I18N("h","PPTP Server IP Address");</script>:</th> <td><input class="styled-text" type="text" name="serverIPAddress_PPTP" size="27" maxlength="15" id="serverIPAddress_PPTP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Username");</script>:</th> <td><input class="styled-text" type="text" name="userName_PPTP" size="27" maxlength="64" id="userName_PPTP"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_PPTP" size="27" maxlength="64" id="password_PPTP"></td> </tr> <tr> <th><script>I18N("h","Reconnect Mode");</script>:</th> <td> <div class="styled-select"> <select name="reconnectMode_PPTP" id="reconnectMode_PPTP" onChange="ChangeReconnectMode(this.value, 'PPTP')"> <option value="ALWAYSON">Always on</option> <option value="ONDEMAND" selected>On demand</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td></td> </tr> <tr id="maxIdleTime_PPTP_tr"> <th><script>I18N("h","Maximum Idle Time");</script>:</th> <td><input class="styled-text" style="width: 120px;" type="text" name="maximumIdleTime_PPTP" id="maximumIdleTime_PPTP" value="5" maxlength="5">&nbsp;&nbsp;<script>I18N("h","minutes");</script></td> <td></td> </tr> </tbody> </table> </div> <div id="generalBlock_L2TP" style="display:none"> <table class="block"> <tbody> <tr> <th><script>I18N("h","L2TP Server IP Address");</script>:</th> <td><input class="styled-text" type="text" name="serverIPAddress_L2TP" size="27" maxlength="15" id="serverIPAddress_L2TP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Username");</script>:</th> <td><input class="styled-text" type="text" name="userName_L2TP" size="27" maxlength="64" id="userName_L2TP"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_L2TP" size="27" maxlength="64" id="password_L2TP"></td> </tr> <tr> <th><script>I18N("h","Reconnect Mode");</script>:</th> <td> <div class="styled-select"> <select name="reconnectMode_L2TP" id="reconnectMode_L2TP" onChange="ChangeReconnectMode(this.value, 'L2TP')"> <option value="ALWAYSON">Always on</option> <option value="ONDEMAND" selected>On demand</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td></td> </tr> <tr id="maxIdleTime_L2TP_tr"> <th><script>I18N("h","Maximum Idle Time");</script>:</th> <td><input class="styled-text" style="width: 120px;" type="text" name="maximumIdleTime_L2TP" size="15" id="maximumIdleTime_L2TP" value="5" maxlength="5">&nbsp;&nbsp;<script>I18N("h","minutes");</script></td> <td></td> </tr> </tbody> </table> </div> <div class="advButton" onclick="showAdv('advancedBlock');"><script>I18N("h","Advanced Settings");</script>...</div> <hr/> <div id="advancedBlock" style="display:none"> <div id="advancedBlock_staticIP" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td width="200px"><input class="styled-text" type="text" name="secondaryDNSAddress_StaticIP" size="27" maxlength="15" id="secondaryDNSAddress_StaticIP" onchange="ReplaceEmpty(this, this.value)"></td> <td></td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td> <div class="styled-select"> <select name="mtu_StaticIP" id="mtu_StaticIP" onChange="ChangeMTU(this.value, 'StaticIP')"> <option value="AUTO" selected>Auto</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td id="mtu_StaticIP_tr"><input class="styled-text" type="text" name="mtu_StaticIP_Input" size="3" maxlength="5" id="mtu_StaticIP_Input" value="1500" style="display: none;" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="mac_clone_StaticIP_tr"> <th><script>I18N("h","Mac Address Clone");</script>:</th> <td><input class="styled-text" type="text" name="macAddress_StaticIP" size="27" maxlength="17" id="macAddress_StaticIP" onchange="ReplaceEmpty(this, this.value)"></td> <td> <div class="styled-select"> <select name="clone_mac_StaticIP" id="clone_mac_StaticIP" onChange="ListMACAddress(this, this.value, 'StaticIP')"> <option value="0">&lt;&lt; MAC Address</option> </select> </div> </td> </tr> </tbody> </table> </div> <div id="advancedBlock_DynamicIP" style="display:inline"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Host Name");</script>:</th> <td width="200px"><input class="styled-text" type="text" name="hostName_DynamicIP" size="27" maxlength="25" id="hostName_DynamicIP"></td> <td></td> </tr> <tr> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="primaryDNSAddress_DynamicIP" size="27" maxlength="15" id="primaryDNSAddress_DynamicIP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="secondaryDNSAddress_DynamicIP" size="27" maxlength="15" id="secondaryDNSAddress_DynamicIP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td> <div class="styled-select"> <select name="mtu_DynamicIP" id="mtu_DynamicIP" onChange="ChangeMTU(this.value, 'DynamicIP')"> <option value="AUTO">Auto</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td id="mtu_DynamicIP_tr"><input class="styled-text" type="text" name="mtu_DynamicIP_Input" size="3" maxlength="5" id="mtu_DynamicIP_Input" value="1500" style="display: none;" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="mac_clone_DynamicIP_tr"> <th><script>I18N("h","Mac Address Clone");</script>:</th> <td><input class="styled-text" type="text" name="macAddress_DynamicIP" size="27" maxlength="17" id="macAddress_DynamicIP" onchange="ReplaceEmpty(this, this.value)"></td> <td> <div class="styled-select"> <select name="clone_mac_DynamicIP" id="clone_mac_DynamicIP" onChange="ListMACAddress(this, this.value, 'DynamicIP')"> <option value="0">&lt;&lt; MAC Address</option> </select> </div> </td> </tr> </tbody> </table> </div> <div id="advancedBlock_PPPoE" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Address Mode");</script>:</th> <td width="200px"> <div class="styled-select"> <select name="addressMode_PPPoE" id="addressMode_PPPoE" onChange="ChangeAddrMode(this.value, 'PPPoE')"> <option value="DYNAMICIP">Dynamic IP</option> <option value="STATICIP">Static IP</option> </select> </div> </td> <td></td> </tr> <tr id="ipAddress_tr" style="display:none;"> <th><script>I18N("h","IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="ipAddress_PPPoE" id="ipAddress_PPPoE" size="27" maxlength="15" id="ipAddress" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Service Name");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="serviceName_PPPoE" size="27" maxlength="25" id="serviceName_PPPoE"></td> </tr> <tr> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="primaryDNSAddress_PPPoE" size="27" maxlength="15" id="primaryDNSAddress_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="secondaryDNSAddress_PPPoE" size="27" maxlength="15" id="secondaryDNSAddress_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td> <div class="styled-select"> <select name="mtu_PPPoE" id="mtu_PPPoE" onChange="ChangeMTU(this.value, 'PPPoE')"> <option value="AUTO" selected>Auto</option> <option value="MANUAL">Manual</option> </select> </div> <td id="mtu_PPPoE_tr"><input class="styled-text" type="text" name="mtu_PPPoE_Input" size="3" maxlength="5" id="mtu_PPPoE_Input" value="1492" style="display: none;"></td> </tr> <tr> <th><script>I18N("h","Mac Address Clone");</script>:</th> <td><input class="styled-text" type="text" name="macAddress_PPPoE" size="27" maxlength="17" id="macAddress_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> <td> <div class="styled-select"> <select name="clone_ComputerIpByPPPoE" id="clone_ComputerIpByPPPoE" onChange="ListMACAddressByPPPoE_Select(this, this.value)"> <option value="0">&lt;&lt; MAC Address</option> </select> </div> </td> </tr> </tbody> </table> </div> <div id="advancedBlock_Ru_PPPoE" style="display:none"> <table class="block" border="0"> <tbody> <tr> <td><div class="title"><script>I18N("h","WAN Physical Settings");</script></div></td> </tr> <tr> <th><script>I18N("h","Address Mode");</script>:</th> <td width="200px"> <div class="styled-select"> <select name="addressMode_Ru_PPPoE" id="addressMode_Ru_PPPoE" onChange="ChangeAddrMode(this.value, 'Ru_PPPoE_WAN')"> <option value="DYNAMICIP">Dynamic IP</option> <option value="STATICIP">Static IP</option> </select> </div> </td> <td></td> </tr> <tr id="ipAddress_Ru_PPPoE_WAN_tr" style="display: none;"> <th><script>I18N("h","IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="ipAddress_Ru_PPPoE" size="27" maxlength="15" id="ipAddress_Ru_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="subnetMask_Ru_PPPoE_WAN_tr" style="display: none;"> <th><script>I18N("h","Subnet Mask");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="subnetMask_Ru_PPPoE" size="27" maxlength="15" id="subnetMask_Ru_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="gatewayIP_Ru_PPPoE_WAN_tr" style="display: none;"> <th><script>I18N("h","Gateway IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="gatewayIP_Ru_PPPoE" size="27" maxlength="15" id="gatewayIP_Ru_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="primaryDNSAddress_Ru_PPPoE_WAN_tr" style="display: none;"> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="primaryDNSAddress_Ru_PPPoE" size="27" maxlength="15" id="primaryDNSAddress_Ru_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="secondaryDNSAddress_Ru_PPPoE_WAN_tr" style="display: none;"> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="secondaryDNSAddress_Ru_PPPoE" size="27" maxlength="15" id="secondaryDNSAddress_Ru_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> </tbody> </table> </div> <div id="advancedBlock_PPTP" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Address Mode");</script>:</th> <td width="200px"> <div class="styled-select"> <select name="addressMode_PPTP" id="addressMode_PPTP" onChange="ChangeAddrMode(this.value, 'PPTP')"> <option value="DYNAMICIP">Dynamic IP</option> <option value="STATICIP">Static IP</option> </select> </div> </td> <td></td> </tr> <tr id="ipAddress_PPTP_tr" style="display: none;"> <th><script>I18N("h","PPTP IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="ipAddress_PPTP" size="27" maxlength="15" id="ipAddress_PPTP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="subnetMask_PPTP_tr" style="display: none;"> <th><script>I18N("h","PPTP Subnet Mask");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="subnetMask_PPTP" size="27" maxlength="15" id="subnetMask_PPTP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="gatewayIP_PPTP_tr" style="display: none;"> <th><script>I18N("h","PPTP Gateway IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="gatewayIP_PPTP" size="27" maxlength="15" id="gatewayIP_PPTP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="primaryDNSAddress_PPTP" size="27" maxlength="15" id="primaryDNSAddress_PPTP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="secondaryDNSAddress_PPTP" size="27" maxlength="15" id="secondaryDNSAddress_PPTP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td> <div class="styled-select"> <select name="mtu_PPTP" id="mtu_PPTP" onChange="ChangeMTU(this.value, 'PPTP')"> <option value="AUTO" selected>Auto</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td id="mtu_PPTP_tr"><input class="styled-text" type="text" name="mtu_PPTP_Input" size="3" maxlength="5" id="mtu_PPTP_Input" value="1400" style="display: none;"></td> </tr> </tbody> </table> </div> <div id="advancedBlock_L2TP" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Address Mode");</script>:</th> <td width="200px"> <div class="styled-select"> <select name="addressMode_L2TP" id="addressMode_L2TP" onChange="ChangeAddrMode(this.value, 'L2TP')"> <option value="DYNAMICIP">Dynamic IP</option> <option value="STATICIP">Static IP</option> </select> </div> </td> <td></td> </tr> <tr id="ipAddress_L2TP_tr" style="display: none;"> <th><script>I18N("h","L2TP IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="ipAddress_L2TP" size="27" maxlength="15" id="ipAddress_L2TP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="subnetMask_L2TP_tr" style="display: none;"> <th><script>I18N("h","L2TP Subnet Mask");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="subnetMask_L2TP" size="27" maxlength="15" id="subnetMask_L2TP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="gatewayIP_L2TP_tr" style="display: none;"> <th><script>I18N("h","L2TP Gateway IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="gatewayIP_L2TP" size="27" maxlength="15" id="gatewayIP_L2TP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="primaryDNSAddress_L2TP" size="27" maxlength="15" id="primaryDNSAddress_L2TP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="secondaryDNSAddress_L2TP" size="27" maxlength="15" id="secondaryDNSAddress_L2TP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td> <div class="styled-select"> <select name="mtu_L2TP" id="mtu_L2TP" onChange="ChangeMTU(this.value, 'L2TP')"> <option value="AUTO" selected>Auto</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td id="mtu_L2TP_tr"><input class="styled-text" type="text" name="mtu_L2TP_Input" size="3" maxlength="5" id="mtu_L2TP_Input" value="1400" style="display: none;"></td> </tr> </tbody> </table> </div> <div id="advancedBlock_DSLite" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","DS-Lite Configuration");</script>:</th> <td> <div class="styled-select"> <select name="configuration_DSLite" id="configuration_DSLite" onChange="ChangeDSLiteConfig(this.value)"> <option value="Dhcpv6Option">DS-Lite DHCPv6 Option</option> <option value="Manual">Manual Configuration</option> </select> </div> </td> </tr> <tr id="afterIPv6Address_DSLite_tr" style="display: none;"> <th><script>I18N("h","AFTR IPv6 Address");</script>:</th> <td><input class="styled-text" type="text" name="afterIPv6Address_DSLite" size="27" maxlength="39" id="afterIPv6Address_DSLite" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","B4 IPv4 Address");</script>:</th> <td>192.0.0.&nbsp;<input class="styled-text" style="width: 50px;" type="text" name="b4IPv4Address_DSLite" size="3" maxlength="3" id="b4IPv4Address_DSLite" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","WAN IPv6 Address");</script>:</th> <td><label name="wanIPv6Address_DSLite" id="wanIPv6Address_DSLite">N/A</label></td> </tr> <tr> <th><script>I18N("h","IPv6 WAN Default Gateway");</script>:</th> <td><label name="ipv6WanDefaultGateway_DSLite" id="ipv6WanDefaultGateway_DSLite">N/A</label></td> </tr> </tbody> </table> </div> </div> <div id="CreatePopAlertMessage" style="display:none"> <div id="AlertPopRect"> <div id="AlertPopBody"> <table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td><center><div id="Loading_pop_image2"></div></center></td> </tr> <tr> <td><label id="reciprocal_Number"></label></td> </tr> <tr> <td id="dialog_msg_black2"> <script>I18N("h","Your changes are being saved.");</script> </td> </tr> </tbody> </table> <table class="myAlertPop_table" id="waitDeviceReboot" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td> <center><div id="Loading_pop_image"></div></center> </td> </tr> <tr> <td><label id="reciprocal_Number_Reboot"/></td> </tr> <tr> <td id="Font_Color_Red"></td> </tr> </tbody> </table> <table class="myAlertPop_table_b" id="SuccessREBOOT" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td> <center><div id="Information_pop_image"></div></center> </td> </tr> <tr> <td> <div id="dialog_msg_black"> <script>I18N("h","The new settings have been saved.");</script> </div> </td> </tr> <tr> <td> <center> <div id="Confirm_btn" onclick="RedirectToURL()" style="cursor:pointer"> <script>I18N("h","OK");</script> </div> </center> </td> </tr> </tbody> </table> </div> </div> </div> <br/> <div id="Page"> <table class="block" border="0" style="display:inline"> <tbody> <tr> <td colspan="2"><div class="title"><script>I18N("h","Portal Page Redirect");</script></div></td> </tr> <tr> <th><script>I18N("h","Status");</script>:</th> <td width="210px"><div id="enable_Page" class="checkbox_on"><input type="checkbox" name="enable_Page" id="enable_Page_ck"></div> </td> </tr> <tr id="leasetime" style="display:none"> <th><script>I18N("h","Lease time");</script>:</th> <td valign="top"> <input class="styled-text" type="text" name="lease_time" size="27" maxlength="5" id="lease_time"> </td> <td style="left:auto"><script>I18N("h","(Seconds)");</script></td> </tr> <tr id="weblink" style="display:none"> <th><script>I18N("h","Website Link for Redirect");</script>:</th> <td valign="top"> <input class="styled-text" type="text" name="website_link" size="27" id="website_link"> </td> </tr> </tbody> </table> </div> <div id="DetectRouterConnection" style="display:none"></div> <div id="footer"> <div id="copyright"><script>I18N("h","COPYRIGHT");</script></div> </div> </div> </div> </form> <script type="text/javascript" charset="utf-8">$(document).ready(function(){$("#serverIPAddress_PPTP").attr("placeholder",I18N("j","IP or Domain name"));$("#serverIPAddress_L2TP").attr("placeholder",I18N("j","IP or Domain name"));function a(d){if(d!="PPPoE"&&wan_IPv6type=="IPv6_PPPoE"&&PppoeNewSession=="SharedWithIPv4"){return false}else{return true}}function b(d){if(d=="DSLite"&&(wan_IPv6type=="IPv6_IPv6InIPv4Tunnel"||wan_IPv6type=="IPv6_6To4"||wan_IPv6type=="IPv6_6RD"||wan_IPv6type=="IPv6_LinkLocalOnly")){return false}else{return true}}$.validator.addMethod("checkSetValues",function(v,g){var n=g.id;var o="";var j=document.getElementById("connect_type").value;if(!a(j)){if(n=="value_Session"){return I18N("j","IPv6 PPPoE is share with IPv4 PPPoE. Please change IPv6 WAN protocol to PPPoE at first.")}}else{if(!b(j)){if(n=="value_Session"){return I18N("j","Please choose one IPv6 connection type besides Link-Local Only, 6to4, 6rd, and IPv6 in IPv4 Tunnel !")}}else{switch(j){case"STATIC":var h=document.getElementById("iPAddress_StaticIP").value;var q=document.getElementById("primaryDNSAddress_StaticIP").value;var f=document.getElementById("subnetMask_StaticIP").value;var x=COMM_IPv4MASK2INT(f);if(n=="iPAddress_StaticIP"){if(v==""||v==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}var k=document.getElementById("device_mode").value;if(k=="ROUTER"&&f!=""&&(COMM_IPv4NETWORK(v,x)==COMM_IPv4NETWORK(lan_IPAddr,x))){return I18N("j","The network id is the same with LAN.")}if(k=="ROUTER"&&f!=""&&(COMM_IPv4NETWORK(v,x)==COMM_IPv4NETWORK(lan_IPAddr_g,x))){return I18N("j","The network id is the same with GuestZone.")}}}if(n=="subnetMask_StaticIP"){if(v==""||v==null){return I18N("j","Please enter a subnet mask.")}else{var x=COMM_IPv4MASK2INT(v);if(x<=0||x>32){return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)")}if(x<8){return I18N("j","The router would not support the subnet mask which length is less than Class A.")}}}if(n=="defaultGateway_StaticIP"){if(v==""||v==null){return I18N("j","Please enter a gateway address.")}else{if(f!=""){if(!COMM_ValidV4HOST(v,x)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(h!=""){if(v==h){return I18N("j","Please enter a valid gateway address. (e.g. 192.168.0.1)")}if(COMM_IPv4NETWORK(v,x)!=COMM_IPv4NETWORK(h,x)){return I18N("j","The default gateway should be in the same network.")}}}}}if(n=="primaryDNSAddress_StaticIP"){if(v==""||v==null){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}else{if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(h!=""&&v==h){return I18N("j","The dns server cannot be equal to the IP address.")}}}if(n=="secondaryDNSAddress_StaticIP"&&v!=""){if(q==""||q==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}if(n=="mtu_StaticIP_Input"&&$("#mtu_StaticIP")[0].value=="MANUAL"){if(!COMM_IsInteger(v)||v<1280||1500<v){return I18N("j","The MTU value should be 1280 ~ 1500.")}}if(n=="macAddress_StaticIP"&&v!=""&&(v=="00:00:00:00:00:00"||!COMM_IsMAC(v))){return I18N("j","Text field contains illegal characters.")}break;case"DHCP":var l=document.getElementById("primaryDNSAddress_DynamicIP").value;if(n=="primaryDNSAddress_DynamicIP"&&v!=""){if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}if(n=="secondaryDNSAddress_DynamicIP"&&v!=""){if(l==""||l==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(v==l){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(n=="mtu_DynamicIP_Input"&&$("#mtu_DynamicIP")[0].value=="MANUAL"){if(!COMM_IsInteger(v)||v<1280||1500<v){return I18N("j","The MTU value should be 1280 ~ 1500.")}}if(n=="macAddress_DynamicIP"&&v!=""&&(v=="00:00:00:00:00:00"||!COMM_IsMAC(v))){return I18N("j","Text field contains illegal characters.")}break;case"PPPoE":var m=document.getElementById("addressMode_PPPoE").value;var y=document.getElementById("primaryDNSAddress_PPPoE").value;if(n=="userName_PPPoE"&&(v==""||v==null)){return I18N("j","Please enter a username.")}if(n=="password_PPPoE"&&(v==""||v==null)){return I18N("j","Please enter a password.")}if(n=="primaryDNSAddress_PPPoE"&&v!=""){if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}if(n=="secondaryDNSAddress_PPPoE"&&v!=""){if(y==""||y==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(v==y){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(m=="STATICIP"&&n=="ipAddress_PPPoE"){if(v==""||v==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="macAddress_PPPoE"&&v!=""&&(v=="00:00:00:00:00:00"||!COMM_IsMAC(v))){return I18N("j","Text field contains illegal characters.")}if(n=="mtu_PPPoE_Input"&&$("#mtu_PPPoE")[0].value=="MANUAL"){if(!COMM_IsInteger(v)||v<1280||1492<v){return I18N("j","The MTU value should be 1280 ~ 1492.")}}if(n=="maximumIdleTime_PPPoE"&&!COMM_IsDigit(v)){return I18N("j","Please enter a value")}break;case"PPTP":var r=document.getElementById("addressMode_PPTP").value;var s=document.getElementById("primaryDNSAddress_PPTP").value;if(n=="serverIPAddress_PPTP"){if(v==""||v==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="userName_PPTP"&&(v==""||v==null)){return I18N("j","Please enter a username.")}if(r=="STATICIP"){if(n=="ipAddress_PPTP"){if(v==""||v==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="subnetMask_PPTP"){if(v==""||v==null){return I18N("j","Please enter a subnet mask.")}else{var x=COMM_IPv4MASK2INT(v);if(x<=0||x>32){return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)")}if(x<8){return I18N("j","The router would not support the subnet mask which length is less than Class A.")}}}if(n=="gatewayIP_PPTP"){if(v==""||v==null){return I18N("j","Please enter a gateway address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="primaryDNSAddress_PPTP"){if(v==""||v==null){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}else{if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}}else{if(n=="primaryDNSAddress_PPTP"&&v!=""){if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="secondaryDNSAddress_PPTP"&&v!=""){if(s==""||s==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(v==s){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(n=="mtu_PPTP_Input"&&$("#mtu_PPTP")[0].value=="MANUAL"){if(!COMM_IsInteger(v)||v<1280||1460<v){return I18N("j","The MTU value should be 1280 ~ 1460.")}}if(n=="maximumIdleTime_PPTP"&&!COMM_IsDigit(v)){return I18N("j","Please enter a value")}break;case"L2TP":var p=document.getElementById("addressMode_L2TP").value;var e=document.getElementById("primaryDNSAddress_L2TP").value;if(n=="serverIPAddress_L2TP"){if(v==""||v==null){return I18N("j","Please enter an IP address.")}}if(n=="userName_L2TP"&&(v==""||v==null)){return I18N("j","Please enter a username.")}if(p=="STATICIP"){if(n=="ipAddress_L2TP"){if(v==""||v==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="subnetMask_L2TP"){if(v==""||v==null){return I18N("j","Please enter a subnet mask.")}else{var x=COMM_IPv4MASK2INT(v);if(x<=0||x>32){return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)")}if(x<8){return I18N("j","The router would not support the subnet mask which length is less than Class A.")}}}if(n=="gatewayIP_L2TP"){if(v==""||v==null){return I18N("j","Please enter a gateway address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="primaryDNSAddress_L2TP"){if(v==""||v==null){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}else{if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}}else{if(n=="primaryDNSAddress_L2TP"&&v!=""){if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="secondaryDNSAddress_L2TP"&&v!=""){if(e==""||e==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(v==e){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(n=="mtu_L2TP_Input"&&$("#mtu_L2TP")[0].value=="MANUAL"){if(!COMM_IsInteger(v)||v<1280||1460<v){return I18N("j","The MTU value should be 1280 ~ 1460.")}}if(n=="maximumIdleTime_L2TP"&&!COMM_IsDigit(v)){return I18N("j","Please enter a value")}break;case"DSLite":var d=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;var t=document.getElementById("configuration_DSLite").value;if(t=="Manual"&&n=="afterIPv6Address_DSLite"){if(v==""||v==null){return I18N("j","Please enter an IPv6 address.")}else{if(!d.test(v)){return I18N("j","Please enter a valid IPv6 address. (e.g. 2001::1)")}}}if(n=="b4IPv4Address_DSLite"){var u=parseInt(document.getElementById("b4IPv4Address_DSLite").value);if(isNaN(u)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(u>=8||u<=1){return I18N("j","Please enter a valid IP address. (e.g. 192.0.0.2)")}}break;case"Ru_PPPoE":var m=document.getElementById("addressMode_PPPoE").value;var y=document.getElementById("primaryDNSAddress_PPPoE").value;var i=document.getElementById("addressMode_Ru_PPPoE").value;var w=document.getElementById("primaryDNSAddress_Ru_PPPoE").value;if(n=="userName_PPPoE"&&(v==""||v==null)){return I18N("j","Please enter a username.")}if(n=="password_PPPoE"&&(v==""||v==null)){return I18N("j","Please enter a password.")}if(n=="primaryDNSAddress_PPPoE"&&v!=""){if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}if(n=="secondaryDNSAddress_PPPoE"&&v!=""){if(y==""||y==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(v==y){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(m=="STATICIP"&&n=="ipAddress_PPPoE"){if(v==""||v==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="mtu_PPPoE_Input"&&$("#mtu_PPPoE")[0].value=="MANUAL"){if(!COMM_IsInteger(v)||v<1280||1492<v){return I18N("j","The MTU value should be 1280 ~ 1492.")}}if(n=="maximumIdleTime_PPPoE"&&!COMM_IsDigit(v)){return I18N("j","Please enter a value")}if(i=="STATICIP"){if(n=="ipAddress_Ru_PPPoE"){if(v==""||v==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="subnetMask_Ru_PPPoE"){if(v==""||v==null){return I18N("j","Please enter a subnet mask.")}else{var x=COMM_IPv4MASK2INT(v);if(x<=0||x>32){return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)")}if(x<8){return I18N("j","The router would not support the subnet mask which length is less than Class A.")}}}if(n=="gatewayIP_Ru_PPPoE"){if(v==""||v==null){return I18N("j","Please enter a gateway address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="primaryDNSAddress_Ru_PPPoE"){if(v==""||v==null){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}else{if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="secondaryDNSAddress_Ru_PPPoE"&&v!=""){if(w==""||w==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(v==w){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}}break;case"Ru_PPTP":var r=document.getElementById("addressMode_PPTP").value;var s=document.getElementById("primaryDNSAddress_PPTP").value;if(n=="serverIPAddress_PPTP"){if(v==""||v==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="userName_PPTP"&&(v==""||v==null)){return I18N("j","Please enter a username.")}if(n=="password_PPTP"&&(v==""||v==null)){return I18N("j","Please enter a password.")}if(r=="STATICIP"){if(n=="ipAddress_PPTP"){if(v==""||v==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="subnetMask_PPTP"){if(v==""||v==null){return I18N("j","Please enter a subnet mask.")}else{var x=COMM_IPv4MASK2INT(v);if(x<=0||x>32){return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)")}if(x<8){return I18N("j","The router would not support the subnet mask which length is less than Class A.")}}}if(n=="gatewayIP_PPTP"){if(v==""||v==null){return I18N("j","Please enter a gateway address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="primaryDNSAddress_PPTP"){if(v==""||v==null){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}else{if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}}else{if(n=="primaryDNSAddress_PPTP"&&v!=""){if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="secondaryDNSAddress_PPTP"&&v!=""){if(s==""||s==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(v==s){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(n=="mtu_PPTP_Input"&&$("#mtu_PPTP")[0].value=="MANUAL"){if(!COMM_IsInteger(v)||v<1280||1460<v){return I18N("j","The MTU value should be 1280 ~ 1460.")}}if(n=="maximumIdleTime_PPTP"&&!COMM_IsDigit(v)){return I18N("j","Please enter a value")}break;case"Ru_L2TP":var p=document.getElementById("addressMode_L2TP").value;var e=document.getElementById("primaryDNSAddress_L2TP").value;if(n=="serverIPAddress_L2TP"){if(v==""||v==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="userName_L2TP"&&(v==""||v==null)){return I18N("j","Please enter a username.")}if(n=="password_L2TP"&&(v==""||v==null)){return I18N("j","Please enter a password.")}if(p=="STATICIP"){if(n=="ipAddress_L2TP"){if(v==""||v==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="subnetMask_L2TP"){if(v==""||v==null){return I18N("j","Please enter a subnet mask.")}else{var x=COMM_IPv4MASK2INT(v);if(x<=0||x>32){return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)")}if(x<8){return I18N("j","The router would not support the subnet mask which length is less than Class A.")}}}if(n=="gatewayIP_L2TP"){if(v==""||v==null){return I18N("j","Please enter a gateway address.")}else{if(!COMM_ValidV4Format(v)||!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="primaryDNSAddress_L2TP"){if(v==""||v==null){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}else{if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}}else{if(n=="primaryDNSAddress_L2TP"&&v!=""){if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(n=="secondaryDNSAddress_L2TP"&&v!=""){if(e==""||e==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(v)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(v==e){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(n=="mtu_L2TP_Input"&&$("#mtu_L2TP")[0].value=="MANUAL"){if(!COMM_IsInteger(v)||v<1280||1460<v){return I18N("j","The MTU value should be 1280 ~ 1460.")}}if(n=="maximumIdleTime_L2TP"&&!COMM_IsDigit(v)){return I18N("j","Please enter a value")}break}}}return""},"");$("#internet_form").validate({submitHandler:function(d){CheckConnectionStatus()}});var c=$("#iPAddress_StaticIP, #subnetMask_StaticIP, #defaultGateway_StaticIP, #primaryDNSAddress_StaticIP, #secondaryDNSAddress_StaticIP, #primaryDNSAddress_DynamicIP, #secondaryDNSAddress_DynamicIP, #userName_PPPoE, #password_PPPoE, #ipAddress_PPPoE, #primaryDNSAddress_PPPoE, #secondaryDNSAddress_PPPoE, #serverIPAddress_PPTP, #userName_PPTP, #password_PPTP, #ipAddress_PPTP, #subnetMask_PPTP, #gatewayIP_PPTP, #primaryDNSAddress_PPTP, #secondaryDNSAddress_PPTP, #serverIPAddress_L2TP, #userName_L2TP, #password_L2TP, #ipAddress_L2TP, #subnetMask_L2TP, #gatewayIP_L2TP, #primaryDNSAddress_L2TP, #secondaryDNSAddress_L2TP, #afterIPv6Address_DSLite, #value_Session, #mtu_StaticIP_Input, #mtu_DynamicIP_Input, #mtu_PPPoE_Input, #mtu_PPTP_Input, #mtu_L2TP_Input, #b4IPv4Address_DSLite, #maximumIdleTime_PPPoE, #macAddress_PPPoE, #maximumIdleTime_PPTP, #maximumIdleTime_L2TP, #macAddress_DynamicIP, #macAddress_StaticIP, #ipAddress_Ru_PPPoE, #subnetMask_Ru_PPPoE, #gatewayIP_Ru_PPPoE, #primaryDNSAddress_Ru_PPPoE, #secondaryDNSAddress_Ru_PPPoE");$.each(c,function(e,d){$(this).rules("add",{checkSetValues:true})})});</script> </body> <script type="text/javascript">Load_HTML();Initial();setMenu("menu_Settings");InitMACList();InitWAN();startTimeout();</script> </html>