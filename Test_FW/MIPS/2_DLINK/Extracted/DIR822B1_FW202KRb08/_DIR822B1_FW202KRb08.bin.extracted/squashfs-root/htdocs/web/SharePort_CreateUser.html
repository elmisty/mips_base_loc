<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3c.org/1999/xhtml"> <head> <title>D-LINK</title> <meta http-equiv="X-UA-Compatible" content="IE=9"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="Content-Type" content="text/css"> <link rel=stylesheet type="text/css" href="/css/jquery.selectbox.css?v=20200423094010"/> <script type="text/javascript" charset="utf-8" src="/js/initialJQ.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialJS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialCSS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialValidate.js"></script> <script type="text/javascript" charset="utf-8" src="/js/SharePort_CreateUser.js?v=20200423094010"></script> <script type="text/javascript">var HNAP=new HNAP_XML();var set_Iteration;var counter=1;var counter2=1;var Total_User=0;var Limit_TotalUser=9;var IsOpenFolder=0;var IsOpenFolder2=0;var Name_CheckList=[];var DefaultDirectory_Path="";var DefaultDirectory_Name="";var DefaultDirectory_RootN="";var DefaultDirectory_RootP="";function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu();initialDetectRouterConnection()}function setIteration(a){set_Iteration=a}function createUserButton(){changeTimeoutAction();document.getElementById("shareport_Folder").value=I18N("j","root");document.getElementById("createPop").style.display="inline";document.getElementById("createButton").disabled=true;$("#shareport_Permission").selectbox("detach");$("#shareport_Permission").val("1");$("#shareport_Permission").selectbox("attach")}function closeCreateUserPOP(){changeTimeoutAction();var a=AddRowToIndex();if(a=="Success"){document.getElementById("createPop").style.display="none";document.getElementById("createButton").disabled=false;$("#shareport_Permission").selectbox("detach");$("#shareport_Permission").val("1");$("#shareport_Permission").selectbox("attach");check_TotalUser(Limit_TotalUser,Total_User)}}function clearCreateRulePOP(){changeTimeoutAction();document.getElementById("createPop").style.display="none";document.getElementById("createButton").disabled=false;document.getElementById("shareport_UserName").value="";document.getElementById("shareport_Password").value="";$("#shareport_Permission").selectbox("detach");$("#shareport_Permission").val("1");$("#shareport_Permission").selectbox("attach");document.getElementById("shareport_Folder").value=I18N("j","root");$("#shareport_c1_form").validate().resetForm()}function editData(a){changeTimeoutAction();document.getElementById("editPop").style.display="inline";document.getElementById("createButton").disabled=true;editDataGet(a)}function closeEditUserPOP(b){changeTimeoutAction();var a=b;var c=assignRowToIndex(a);if(c=="Success"){document.getElementById("editPop").style.display="none";document.getElementById("createButton").disabled=false}else{if(c=="Error"){alert("Name cannot be the same.")}else{if(c=="NameNull"){alert("Name cannot be null.")}else{document.getElementById("editPop").style.display="none"}}}}function clearEditRulePOP(){changeTimeoutAction();document.getElementById("editPop").style.display="none";document.getElementById("createButton").disabled=false;$("#shareport_c2_form").validate().resetForm()}function closeTreeViewPOP(){document.getElementById("createPop").style.display="inline";document.getElementById("treeViewPop").style.display="none";document.getElementById("partitionView").innerHTML="";document.getElementById("FolderTreeView").innerHTML=""}function closeTreeView2POP(){document.getElementById("editPop").style.display="inline";document.getElementById("treeViewPop2").style.display="none";document.getElementById("partitionView2").innerHTML="";document.getElementById("FolderTreeView2").innerHTML=""}function GetEditDirectoryList(){var g=HNAP.GetXML("GetListDirectory");var a=g.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo#");var f=document.getElementById("partitionView2");var e=document.getElementById("FolderTreeView2");var d="";f.innerHTML="";e.innerHTML="";document.getElementById("editPop").style.display="none";document.getElementById("treeViewPop2").style.display="inline";if(a>1){for(var c=1;c<=a;c++){d='<li><a href="javascript:GetDirectory_EditPartition('+c+')" id="editpartition_'+c+'" style="font-size:16px;line-height:35px;color:#4598aa;"></a></li>';f.innerHTML+=d;var b=g.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+c+"/DirectoryName");b=b.replace(":","");document.getElementById("editpartition_"+c).innerHTML=b}var h=g.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:1/DirectoryPath");GetDirectory_EditPartition(1)}else{d='<li><a href="javascript:GetDirectory_EditPartition(1)" id="editpartition_1" style="font-size:16px;line-height:35px;color:#4598aa;"></a></li>';f.innerHTML+=d;var b=g.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:1/DirectoryName");var h=g.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:1/DirectoryPath");b=b.replace(":","");document.getElementById("editpartition_1").innerHTML=b;GetDirectory_EditPartition(1)}}function GetEditSubFolderList(c){if(IsOpenFolder==0){var e=HNAP.GetXML("GetListDirectory",new Array("ListDirectoryPath",c));var g=e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo#");var h=document.getElementById("FolderTreeView2");var d=1;var b=0;h.innerHTML+="<br />";for(var f=0;f<g;f++){var l=e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/DirectoryName");var j=e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/DirectoryPath");var a=e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/SubDirectory");var k={trueFolderName:l};if(a=="true"){h.innerHTML+="<div id=subfolder_"+counter+'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:Get_SubFolderList2('+counter+');"><img src="image/folder_open.png" border="0"></img><a href="javascript:Return_Back2('+counter+');">'+k.trueFolderName+"</a><label></label><label></label><label></label></div>"}else{h.innerHTML+="<div id=subfolder_"+counter+'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:Get_SubFolderList2('+counter+');"><a href="javascript:Return_Back2('+counter+');">'+k.trueFolderName+"</a><label></label><label></label><label></label></div>"}document.getElementById("subfolder_"+counter).childNodes[3].innerHTML=j;document.getElementById("subfolder_"+counter).childNodes[3].style.display="none";document.getElementById("subfolder_"+counter).childNodes[4].innerHTML=a;document.getElementById("subfolder_"+counter).childNodes[4].style.display="none";document.getElementById("subfolder_"+counter).childNodes[5].innerHTML=b;document.getElementById("subfolder_"+counter).childNodes[5].style.display="none";counter++;d++}IsOpenFolder=1}}function Get_SubFolderList2(l){var q=document.getElementById("subfolder_"+l).childNodes[5].innerHTML;if(q==0){var s=document.getElementById("subfolder_"+l).childNodes[4].innerHTML;if(s=="true"){document.getElementById("subfolder_"+l).childNodes[5].innerHTML=1;var b=document.getElementById("subfolder_"+l).childNodes[3].innerHTML;var t=HNAP.GetXML("GetListDirectory",new Array("ListDirectoryPath",b));var g=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo#");var h=1;var k=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+h+"/SubDirectory");document.getElementById("subfolder_"+l).childNodes[1].childNodes[0].src="./image/folder_close.png";var a=document.getElementById("subfolder_"+l);for(var o=0;o<g;o++){var m=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+h+"/DirectoryName");var d=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+h+"/DirectoryPath");var k=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+h+"/SubDirectory");var p=0;var c={trueFolderName:m};var e=d.match(/\//g);var r="";r+="<div id=subfolder_"+counter+">";for(var n=1;n<e.length;n++){r+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"}if(k=="true"){r+='<a href="javascript:Get_SubFolderList2('+counter+');"><img src="image/folder_open.png" border="0"></img><a href="javascript:Return_Back2('+counter+');"></a><label></label><label></label><label></label></div>'}else{r+='&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:Get_SubFolderList2('+counter+');"><a href="javascript:Return_Back2('+counter+');"></a><label></label><label></label><label></label></div>'}a.innerHTML+=r;document.getElementById("subfolder_"+counter).childNodes[2].innerHTML=c.trueFolderName;document.getElementById("subfolder_"+counter).childNodes[3].innerHTML=d;document.getElementById("subfolder_"+counter).childNodes[3].style.display="none";document.getElementById("subfolder_"+counter).childNodes[4].innerHTML=k;document.getElementById("subfolder_"+counter).childNodes[4].style.display="none";document.getElementById("subfolder_"+counter).childNodes[5].innerHTML=p;document.getElementById("subfolder_"+counter).childNodes[5].style.display="none";counter++;h++}}else{document.getElementById("subfolder_"+l).childNodes[1].childNodes[0].src="/image/folder_close.png"}}else{var k=document.getElementById("subfolder_"+l).childNodes[4].innerHTML;var d=document.getElementById("subfolder_"+l).childNodes[3].innerHTML;var b=document.getElementById("subfolder_"+l).childNodes[2].innerHTML;var f=document.getElementById("subfolder_"+l);var c={trueFolderName:b};var e=d.match(/\//g);var r="";for(var n=1;n<e.length;n++){r+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"}f.innerHTML=r+'<a href="javascript:Get_SubFolderList2('+l+');" id=subfolder_'+l+'><img src="image/folder_open.png" border="0"></img></a><a href="javascript:Return_Back2('+l+');"></a><label></label><label></label><label></label></div>';var p=0;document.getElementById("subfolder_"+l).childNodes[2].innerHTML=c.trueFolderName;document.getElementById("subfolder_"+l).childNodes[3].innerHTML=d;document.getElementById("subfolder_"+l).childNodes[3].style.display="none";document.getElementById("subfolder_"+l).childNodes[4].innerHTML=k;document.getElementById("subfolder_"+l).childNodes[4].style.display="none";document.getElementById("subfolder_"+l).childNodes[5].innerHTML=p;document.getElementById("subfolder_"+l).childNodes[5].style.display="none"}}function GetDirectoryList(){var g=HNAP.GetXML("GetListDirectory");var a=g.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo#");var f=document.getElementById("partitionView");var e=document.getElementById("FolderTreeView");var d="";f.innerHTML="";e.innerHTML="";document.getElementById("createPop").style.display="none";document.getElementById("treeViewPop").style.display="inline";if(a>1){for(var c=1;c<=a;c++){d='<li><a href="javascript:GetDirectory_Partition('+c+')" id="partition_'+c+'" style="font-size:16px;line-height:35px;color:#4598aa;"></a></li>';f.innerHTML+=d;var b=g.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+c+"/DirectoryName");b=b.replace(":","");document.getElementById("partition_"+c).innerHTML=b}var h=g.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:1/DirectoryPath");GetDirectory_Partition(1)}else{d='<li><a href="javascript:GetDirectory_Partition(1)" id="partition_1" style="font-size:16px;line-height:35px;color:#4598aa;"></a></li>';f.innerHTML+=d;var b=g.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:1/DirectoryName");var h=g.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:1/DirectoryPath");b=b.replace(":","");document.getElementById("partition_1").innerHTML=b;GetDirectory_Partition(1)}}function GetDirectory_Partition(b){var a=document.getElementById("FolderTreeView");a.innerHTML="";setTimeout("GetDirectory_Partition_Append("+b+")",100)}function GetDirectory_Partition_Append(d){var b=HNAP.GetXML("GetListDirectory");var c=b.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/DirectoryPath");var a=document.getElementById("FolderTreeView");a.innerHTML+='<a href="javascript:ReturnBack();" id="rootName" style="margin: 0 0 0 10px;"></a>';document.getElementById("rootName").innerHTML=c;IsOpenFolder=0;GetSubFolderList(c)}function GetDirectory_EditPartition(b){var a=document.getElementById("FolderTreeView2");a.innerHTML="";setTimeout("GetDirectory_EditPartition_Append("+b+")",100)}function GetDirectory_EditPartition_Append(d){var b=HNAP.GetXML("GetListDirectory");var c=b.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/DirectoryPath");var a=document.getElementById("FolderTreeView2");a.innerHTML+='<a href="javascript:ReturnBack2();" id="rootName2" style="margin: 0 0 0 10px;"></a>';document.getElementById("rootName2").innerHTML=c;IsOpenFolder=0;GetEditSubFolderList(c)}function Get_SubFolderList(l){var q=document.getElementById("subfolder_"+l).childNodes[5].innerHTML;if(q==0){var s=document.getElementById("subfolder_"+l).childNodes[4].innerHTML;if(s=="true"){document.getElementById("subfolder_"+l).childNodes[5].innerHTML=1;var b=document.getElementById("subfolder_"+l).childNodes[3].innerHTML;var t=HNAP.GetXML("GetListDirectory",new Array("ListDirectoryPath",b));var g=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo#");var h=1;var k=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+h+"/SubDirectory");document.getElementById("subfolder_"+l).childNodes[1].childNodes[0].src="./image/folder_close.png";var a=document.getElementById("subfolder_"+l);for(var o=0;o<g;o++){var m=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+h+"/DirectoryName");var d=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+h+"/DirectoryPath");var k=t.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+h+"/SubDirectory");var p=0;var c={trueFolderName:m};var e=d.match(/\//g);var r="";r+="<div id=subfolder_"+counter+">";for(var n=1;n<e.length-1;n++){r+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"}r+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";if(k=="true"){r+='<a href="javascript:Get_SubFolderList('+counter+');"><img src="image/folder_open.png" border="0"></img><a href="javascript:Return_Back('+counter+');"></a><label></label><label></label><label></label></div>'}else{r+='&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:Get_SubFolderList('+counter+');"><a href="javascript:Return_Back('+counter+');"></a><label></label><label></label><label></label></div>'}a.innerHTML+=r;document.getElementById("subfolder_"+counter).childNodes[2].innerHTML=c.trueFolderName;document.getElementById("subfolder_"+counter).childNodes[3].innerHTML=d;document.getElementById("subfolder_"+counter).childNodes[3].style.display="none";document.getElementById("subfolder_"+counter).childNodes[4].innerHTML=k;document.getElementById("subfolder_"+counter).childNodes[4].style.display="none";document.getElementById("subfolder_"+counter).childNodes[5].innerHTML=p;document.getElementById("subfolder_"+counter).childNodes[5].style.display="none";counter++;h++}}else{document.getElementById("subfolder_"+l).childNodes[1].childNodes[0].src="/image/folder_close.png"}}else{var k=document.getElementById("subfolder_"+l).childNodes[4].innerHTML;var d=document.getElementById("subfolder_"+l).childNodes[3].innerHTML;var b=document.getElementById("subfolder_"+l).childNodes[2].innerHTML;var f=document.getElementById("subfolder_"+l);var c={trueFolderName:b};var e=d.match(/\//g);var r="";for(var n=1;n<e.length;n++){r+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"}f.innerHTML=r+'<a href="javascript:Get_SubFolderList('+l+');" id=subfolder_'+l+'><img src="image/folder_open.png" border="0"></img></a><a href="javascript:Return_Back('+l+');"></a><label></label><label></label><label></label></div>';var p=0;document.getElementById("subfolder_"+l).childNodes[2].innerHTML=c.trueFolderName;document.getElementById("subfolder_"+l).childNodes[3].innerHTML=d;document.getElementById("subfolder_"+l).childNodes[3].style.display="none";document.getElementById("subfolder_"+l).childNodes[4].innerHTML=k;document.getElementById("subfolder_"+l).childNodes[4].style.display="none";document.getElementById("subfolder_"+l).childNodes[5].innerHTML=p;document.getElementById("subfolder_"+l).childNodes[5].style.display="none"}}function GetSubFolderList(c){if(IsOpenFolder==0){var e=HNAP.GetXML("GetListDirectory",new Array("ListDirectoryPath",c));var g=e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo#");var h=document.getElementById("FolderTreeView");var d=1;var b=0;h.innerHTML+="<br />";for(var f=0;f<g;f++){var l=e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/DirectoryName");var j=e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/DirectoryPath");var a=e.Get("GetListDirectoryResponse/DirectoryList/ListDirectoryInfo:"+d+"/SubDirectory");var k={trueFolderName:l};if(a=="true"){h.innerHTML+="<div id=subfolder_"+counter+'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:Get_SubFolderList('+counter+');"><img src="image/folder_open.png" border="0"></img><a href="javascript:Return_Back('+counter+');">'+k.trueFolderName+"</a><label></label><label></label><label></label></div>"}else{h.innerHTML+="<div id=subfolder_"+counter+'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:Get_SubFolderList('+counter+');"><a href="javascript:Return_Back('+counter+');">'+k.trueFolderName+"</a><label></label><label></label><label></label></div>"}document.getElementById("subfolder_"+counter).childNodes[3].innerHTML=j;document.getElementById("subfolder_"+counter).childNodes[3].style.display="none";document.getElementById("subfolder_"+counter).childNodes[4].innerHTML=a;document.getElementById("subfolder_"+counter).childNodes[4].style.display="none";document.getElementById("subfolder_"+counter).childNodes[5].innerHTML=b;document.getElementById("subfolder_"+counter).childNodes[5].style.display="none";counter++;d++}IsOpenFolder=1}}function ReturnBack(){document.getElementById("shareport_Folder").value=document.getElementById("rootName").innerHTML;document.getElementById("createPop").style.display="inline";document.getElementById("treeViewPop").style.display="none"}function Return_Back(a){document.getElementById("shareport_Folder").value=document.getElementById("subfolder_"+a).childNodes[3].innerHTML;document.getElementById("createPop").style.display="inline";document.getElementById("treeViewPop").style.display="none"}function ReturnBack2(){document.getElementById("edit_Folder").value=document.getElementById("rootName2").innerHTML;document.getElementById("editPop").style.display="inline";document.getElementById("treeViewPop2").style.display="none"}function Return_Back2(a){document.getElementById("edit_Folder").value=document.getElementById("subfolder_"+a).childNodes[3].innerHTML;document.getElementById("editPop").style.display="inline";document.getElementById("treeViewPop2").style.display="none"}function GetXML(){HNAP.GetXMLAsync("GetMultipleHNAPs",null,"GetXML",function(a){GetResult_1st(a)})}function GetResult_1st(a){if(a!=null){a.Set("GetMultipleHNAPs/GetUSBStorageSettings");a.Set("GetMultipleHNAPs/GetListDirectory");a.Set("GetMultipleHNAPs/GetUSBStorageDevice");HNAP.SetXMLAsync("GetMultipleHNAPs",a,function(b){GetResult_2nd(b)})}else{if(DebugMode==1){alert("[!!GetXML Error!!] Function: GetResult_1st")}}}function GetResult_2nd(f){var p=f.Get("GetMultipleHNAPsResponse/GetMultipleHNAPsResult");if(p=="OK"){for(var u=1;u<=Limit_TotalUser;u++){if(f.Get("GetMultipleHNAPsResponse/GetUSBStorageSettingsResponse/StorageUserInfoLists/StorageUser:"+u+"/UserName")==""){break}else{Total_User+=1}}for(var r=1;r<=Total_User;r++){var j=f.Get("GetMultipleHNAPsResponse/GetUSBStorageSettingsResponse/StorageUserInfoLists/StorageUser:"+r+"/UserName");var a=f.Get("GetMultipleHNAPsResponse/GetUSBStorageSettingsResponse/StorageUserInfoLists/StorageUser:"+r+"/Password");var v=f.Get("GetMultipleHNAPsResponse/GetUSBStorageSettingsResponse/StorageUserInfoLists/StorageUser:"+r+"/AccessPath");var z=f.Get("GetMultipleHNAPsResponse/GetUSBStorageSettingsResponse/StorageUserInfoLists/StorageUser:"+r+"/Promission");v=v.replace(":","");GetHNAPInformatiom(Total_User,j,a,v,z);addRowToTable(null)}document.getElementById("createButton").disabled=false;var g=Limit_TotalUser-Total_User;document.getElementById("RemainingRules").innerHTML=g;if(g==0){document.getElementById("createButton").disabled=true}$("#shareport_Permission").selectbox({width:170});$("#edit_Permission").selectbox({width:170});var t=f.Get("GetMultipleHNAPsResponse/GetUSBStorageDeviceResponse/StorageDeviceInfoLists/StorageDevice#");switch(t){case 0:document.getElementById("index_USBDeviceName").innerHTML=I18N("j","Not Available");document.getElementById("usbDeviceSpace_Status").style.display="none";document.getElementById("usbDeviceSpace_Information").style.display="none";document.getElementById("usbDeviceSpace_PercentValue").style.display="none";document.getElementById("usbDeviceSpace_Information").style.display="none";document.getElementById("usbDeviceSpace_Status").style.display="none";document.getElementById("usbDeviceSpace_PercentValue").style.display="none";document.getElementById("usbport_2").style.display="none";document.getElementById("searchFolder").disabled=true;document.getElementById("search_Edit_Folder").disabled=true;break;case 1:document.getElementById("searchFolder").disabled=false;document.getElementById("search_Edit_Folder").disabled=false;var n=f.Get("GetMultipleHNAPsResponse/GetUSBStorageDeviceResponse/StorageDeviceInfoLists/StorageDevice:1/Device");var c=f.Get("GetMultipleHNAPsResponse/GetUSBStorageDeviceResponse/StorageDeviceInfoLists/StorageDevice:1/TotalSpace");var s=f.Get("GetMultipleHNAPsResponse/GetUSBStorageDeviceResponse/StorageDeviceInfoLists/StorageDevice:1/FreeSpace");var y="MB";var m="MB";var x=c;var o=s;document.getElementById("index_USBDeviceName").innerHTML=n;if(c>=1024){x=parseFloat(x/1024).toFixed(2);y="GB";if(c>=1048576){x=parseFloat(x/1024).toFixed(2);y="TB"}}if(s>=1024){o=parseFloat(o/1024).toFixed(2);m="GB";if(s>=1048576){o=parseFloat(o/1024).toFixed(2);m="TB"}}document.getElementById("index_USBDeviceTotalSpace").innerHTML=x+y;document.getElementById("index_USBDeviceFreeSpace").innerHTML=o+m;UsbDevice_getSpace=parseInt(((c-s)/c)*300);if((c-s)>=(c*0.9)){document.getElementById("usb_progressBar").style.border="1px solid red";document.getElementById("usb_DeviceSpace").style.background="red"}else{document.getElementById("usb_progressBar").style.border="1px solid #4598aa";document.getElementById("usb_DeviceSpace").style.background="#4598aa"}document.getElementById("usb_DeviceSpace").style.width=UsbDevice_getSpace+"px";document.getElementById("percent_Value").innerHTML=parseInt(UsbDevice_getSpace/3)+"%";if(UsbDevice_getSpace/3>=90){document.getElementById("percent_Value").style.color="#FFF"}else{document.getElementById("percent_Value").style.color="#000"}document.getElementById("usbDeviceSpace_Information").style.display="table-row";document.getElementById("usbDeviceSpace_Status").style.display="table-row";document.getElementById("usbDeviceSpace_PercentValue").style.display="table-row";document.getElementById("usbport_2").style.display="none";break;default:document.getElementById("searchFolder").disabled=false;document.getElementById("search_Edit_Folder").disabled=false;var n=f.Get("GetMultipleHNAPsResponse/GetUSBStorageDeviceResponse/StorageDeviceInfoLists/StorageDevice:1/Device");var c=f.Get("GetMultipleHNAPsResponse/GetUSBStorageDeviceResponse/StorageDeviceInfoLists/StorageDevice:1/TotalSpace");var s=f.Get("GetMultipleHNAPsResponse/GetUSBStorageDeviceResponse/StorageDeviceInfoLists/StorageDevice:1/FreeSpace");var b=f.Get("GetMultipleHNAPsResponse/GetUSBStorageDeviceResponse/StorageDeviceInfoLists/StorageDevice:2/Device");var h=f.Get("GetMultipleHNAPsResponse/GetUSBStorageDeviceResponse/StorageDeviceInfoLists/StorageDevice:2/TotalSpace");var l=f.Get("GetMultipleHNAPsResponse/GetUSBStorageDeviceResponse/StorageDeviceInfoLists/StorageDevice:2/FreeSpace");var y="MB";var m="MB";var d="MB";var q="MB";var x=c;var o=s;var w=h;var e=l;document.getElementById("index_USBDeviceName").innerHTML=n;document.getElementById("index_USBDeviceName2").innerHTML=b;if(c>=1024){x=parseFloat(x/1024).toFixed(2);y="GB";if(c>=1048576){x=parseFloat(x/1024).toFixed(2);y="TB"}}if(s>=1024){o=parseFloat(o/1024).toFixed(2);m="GB";if(s>=1048576){o=parseFloat(o/1024).toFixed(2);m="TB"}}if(h>=1024){w=parseFloat(w/1024).toFixed(2);d="GB";if(h>=1048576){w=parseFloat(w/1024).toFixed(2);d="TB"}}if(l>=1024){e=parseFloat(e/1024).toFixed(2);q="GB";if(l>=1048576){e=parseFloat(e/1024).toFixed(2);q="TB"}}document.getElementById("index_USBDeviceTotalSpace").innerHTML=x+y;document.getElementById("index_USBDeviceFreeSpace").innerHTML=o+m;document.getElementById("index_USBDeviceTotalSpace2").innerHTML=w+d;document.getElementById("index_USBDeviceFreeSpace2").innerHTML=e+q;UsbDevice_getSpace=parseInt(((c-s)/c)*300);UsbDevice_getSpace2=parseInt(((h-l)/h)*300);if((c-s)>=(c*0.9)){document.getElementById("usb_progressBar").style.border="1px solid red";document.getElementById("usb_DeviceSpace").style.background="red"}else{document.getElementById("usb_progressBar").style.border="1px solid #4598aa";document.getElementById("usb_DeviceSpace").style.background="#4598aa"}if((h-l)>=(h*0.9)){document.getElementById("usb_progressBar2").style.border="1px solid red";document.getElementById("usb_DeviceSpace2").style.background="red"}else{document.getElementById("usb_progressBar2").style.border="1px solid #4598aa";document.getElementById("usb_DeviceSpace2").style.background="#4598aa"}document.getElementById("usb_DeviceSpace").style.width=UsbDevice_getSpace+"px";document.getElementById("percent_Value").innerHTML=parseInt(UsbDevice_getSpace/3)+"%";document.getElementById("usb_DeviceSpace2").style.width=UsbDevice_getSpace2+"px";document.getElementById("percent_Value2").innerHTML=parseInt(UsbDevice_getSpace2/3)+"%";if(UsbDevice_getSpace/3>=90){document.getElementById("percent_Value").style.color="#FFF"}else{document.getElementById("percent_Value").style.color="#000"}if(UsbDevice_getSpace2/3>=90){document.getElementById("percent_Value2").style.color="#FFF"}else{document.getElementById("percent_Value2").style.color="#000"}document.getElementById("usbDeviceSpace_Information").style.display="table-row";document.getElementById("usbDeviceSpace_Status").style.display="table-row";document.getElementById("usbDeviceSpace_PercentValue").style.display="table-row";document.getElementById("usbport_2").style.display="table-row";break}DefaultDirectory_Name=f.Get("GetMultipleHNAPsResponse/GetListDirectoryResponse/DirectoryList/ListDirectoryInfo/DirectoryName");DefaultDirectory_Path=f.Get("GetMultipleHNAPsResponse/GetListDirectoryResponse/DirectoryList/ListDirectoryInfo/DirectoryPath");DefaultDirectory_RootN=DefaultDirectory_Name;var k=DefaultDirectory_Path.replace("/","");DefaultDirectory_RootP=k+":";document.getElementById("shareport_Folder").value=I18N("j","root");document.getElementById("main").style.display="inline"}else{if(DebugMode==1){alert("[!!GetXML Error!!] Function: GetResult_2nd")}}}function CheckConnectionStatus(){$.ajax({cache:false,url:"./js/CheckConnection",timeout:5000,type:"GET",success:function(a){SetXML()},error:function(){document.getElementById("DetectRouterConnection").style.display="inline"}})}function SetXML(){document.getElementById("CreatePopAlertMessage").style.display="inline";HNAP.GetXMLAsync("SetStorageUsers",null,"GetXML",function(a){SetResult_1st(a)})}function SetResult_1st(d){if(d!=null){var h=document.getElementById(TABLE_NAME);var f=0;var g=0;array2Dv=new Array2DVar(Total_User,4);for(var e=2;e<=Total_User+1;e++){array2Dv[f][0]=h.rows[e].childNodes[0].childNodes[0].innerHTML;var a=h.rows[e].childNodes[1].childNodes[0].innerHTML;var c=DefaultDirectory_Path.replace("/","");a=a.replace(DefaultDirectory_Path,DefaultDirectory_RootP);if(a=="root"||a==I18N("j","root")||a==DefaultDirectory_RootP){array2Dv[f][1]="root"}else{if(a.search(":")==-1){a=a.replace(c,DefaultDirectory_RootP)}array2Dv[f][1]=a}if(h.rows[e].childNodes[2].childNodes[0].innerHTML==I18N("j","Read/Write")){array2Dv[f][2]="true"}else{array2Dv[f][2]="false"}array2Dv[f][3]=h.rows[e].childNodes[5].childNodes[0].innerHTML;f++}for(var b=1;b<=Total_User;b++){d.Set("SetStorageUsers/StorageUserInfoLists/StorageUser:"+b+"/UserName",array2Dv[g][0]);d.Set("SetStorageUsers/StorageUserInfoLists/StorageUser:"+b+"/AccessPath",array2Dv[g][1]);d.Set("SetStorageUsers/StorageUserInfoLists/StorageUser:"+b+"/Permission",array2Dv[g][2]);d.Set("SetStorageUsers/StorageUserInfoLists/StorageUser:"+b+"/Password",array2Dv[g][3]);g++}HNAP.SetXMLAsync("SetStorageUsers",d,function(i){SetResult_2nd(i)})}else{if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_1st")}}}function SetResult_2nd(b){var a=b.Get("SetStorageUsersResponse/SetStorageUsersResult");if(a=="OK"){setTimeout("waitSettingFinished()",1000)}if(a=="ERROR"){if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_2nd")}setTimeout("waitSettingFinished()",1000)}}function waitSettingFinished(){window.location.reload()}function Array2DVar(a,c){this.length=a;this.x=a;this.y=c;for(var b=0;b<this.length;b++){this[b]=new Array(c)}};</script> <script language="JavaScript">function focusToFirstIndex(a){if(a.id=="save_buttonFocus"){if(window.event.keyCode==9){document.getElementById("shareport_UserName").focus()}}if(a.id=="save_buttonFocus2"){if(window.event.keyCode==9){document.getElementById("edit_UserName").focus()}}};</script> <script language="JavaScript">$(function(){$("select").change(function(){save_button_changed()});$("input").keydown(function(){save_button_changed()})});function save_button_changed(){document.getElementById("Save_Disable_btn").style.display="none";document.getElementById("Save_btn").style.display="block";changeFlag=true;checkFlag=true;changeTimeoutAction()};</script> <style>#createPop{display:none}#editPop{display:none}.progressBar{background-color:#fff;height:30px;width:300px;border:1px solid #4598aa;color:#222}.progressBar .bar{background-color:#4598aa;height:30px;width:0}</style> </head> <body> <div id="wrapper"> <div id="header"></div> <div id="menu"></div> <div id="menu_edge"></div> <div id="content"> <div id="info"> <div id="FunctionName"><script>I18N("h","SharePort");</script></div> <div id="wallimage"><img src="image/page_shareport.png" alt="" width="195" height="119"/></div> <div id="directions"> <script>I18N("h",'"Create User" manage access to your storage devices or use the Guest account (guest/guest) to access the Guest Folder. After plugging in an SD card or USB storage drive, the new device will appear in the list with a link to it. You can then use this link to connect the drive and login with a user account.');</script> </div> </div> <div id="funcBar"> <div id="pagePath">&nbsp;<script>I18N("h","Settings");</script>&nbsp;>>&nbsp;<script>I18N("h","SharePort");</script>&nbsp;>>&nbsp;<script>I18N("h","Create User");</script></div> <ul id="rightFunc"> <li style="display:block"><div id="Save_btn" onclick="CheckConnectionStatus();changeTimeoutAction();" style="cursor:pointer; display:none"><script>I18N("h","Save");</script></div></li> <li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save");</script></div></li> <li style="display:block"><a href="javascript:CheckHTMLStatus('SharePort');" style="text-decoration:none;" onclick="return confirmExit()"><div id="page_btn" class="linkstyle_1"><script>I18N("h","SharePort");</script></div></a></li> </ul> </div> <div id="main" style="display:none"> <table class="myTable2" border="0" cellspacing="0" id="tblUserList"> <thead> <tr> <th><script>I18N("h","User Name");</script></th> <th><script>I18N("h","Access Path");</script></th> <th><script>I18N("h","Permission");</script></th> <th><script>I18N("h","Edit");</script></th> <th><script>I18N("h","Delete");</script></th> <th style="display:none"><script>I18N("h","Password");</script></th> </tr> </thead> <tbody> <tr> <td>Admin</td> <td><script>I18N("h","root");</script></td> <td><script>I18N("h","Read/Write");</script></td> <td>--</td> <td>--</td> <td></td> </tr> </tbody> </table> <br/><br/> <button type="button" name="createButton" id="createButton" class="styled_button_s" onclick="createUserButton()"><script>I18N("h","Create User");</script></button> &nbsp;&nbsp;<script>I18N("h","Remaining");</script>:&nbsp;<label id="RemainingRules">9</label> <br/> <hr/> <div id="usb_1" style="position:relative;"> <div id="usbport_1"> <table class="inforTableTitle" border="0"> <tbody> <tr> <td><img src="image/usb_Icon.png" alt="" width="28" height="28"/></td> <th><script>I18N("h","USB Port");</script>:</th> <td><div><label id="index_USBDeviceName"><script>I18N("h","Not Available");</script></div></td> </tr> </tbody> </table> <table class="myTable_index" border="0" id="usbDeviceSpace_Information" style="display:none"> <tbody> <tr> <th><div><script>I18N("h","Available Space");</script>:</div></th> <td><div><label id="index_USBDeviceFreeSpace"><script>I18N("h","Not Available");</script></label></div></td> </tr> <tr> <th><div><script>I18N("h","Total Space");</script>:</div></th> <td><div><label id="index_USBDeviceTotalSpace"><script>I18N("h","Not Available");</script></label></div></td> </tr> </tbody> </table> <table class="myTable_index" border="0" id="usbDeviceSpace_Status" style="display:none"> <tbody> <tr> <td> <div class="progressBar" id="usb_progressBar"> <div class="bar" id="usb_DeviceSpace"></div> </div> </td> </tr> </tbody> </table> <table class="myTable_index" border="0" id="usbDeviceSpace_PercentValue" style="display:none"> <tbody> <tr> <td><div><label id="percent_Value"></label></div></td> </tr> </tbody> </table> </div> <div id="usbport_2" style="display:none"> <table class="inforTableTitle" border="0"> <tbody> <tr> <td><img src="image/usb_Icon.png" alt="" width="28" height="28"/></td> <th><script>I18N("h","USB Port");</script>:</th> <td><div><label id="index_USBDeviceName2"><script>I18N("h","Not Available");</script></div></td> </tr> </tbody> </table> <table class="myTable_index" border="0" id="usbDeviceSpace_Information"> <tbody> <tr> <th><div><script>I18N("h","Available Space");</script>:</div></th> <td><div><label id="index_USBDeviceFreeSpace2"><script>I18N("h","Not Available");</script></label></div></td> </tr> <tr> <th><div><script>I18N("h","Total Space");</script>:</div></th> <td><div><label id="index_USBDeviceTotalSpace2"><script>I18N("h","Not Available");</script></label></div></td> </tr> </tbody> </table> <table class="myTable_index" border="0" id="usbDeviceSpace_Status"> <tbody> <tr> <td> <div class="progressBar" id="usb_progressBar2"> <div class="bar" id="usb_DeviceSpace2"></div> </div> </td> </tr> </tbody> </table> <table class="myTable_index" border="0" id="usbDeviceSpace_PercentValue2"> <tbody> <tr> <td><div><label id="percent_Value2"></label></div></td> </tr> </tbody> </table> </div> </div> </div> <div id="treeViewPop" style="display:none"> <div class="dialogBox" style="width:550px;height:400px;"> <div id="closeCreatePopBtn" onclick="closeTreeViewPOP()" style="cursor:pointer"></div> <table class="myCreatePop_table_left" style="width:200px" border="0" cellspacing="0" id="tblTreeView1"> <tbody> <tr> <td><div class="popTitle_s"><script>I18N("h","Disk Name");</script></div></td> </tr> <td> <div id="partitionView" style="overflow:auto; height:350px; width:175px; text-align:left; margin: 0 0 0 10px; white-space:nowrap;"></div> </td> </tbody> </table> <table class="myCreatePop_table_right" style="width:350px" border="0" cellspacing="0" id="tblTreeView2"> <tbody> <tr> <td><div class="popTitle_s"><script>I18N("h","Select Folder");</script></div></td> </tr> <td> <div id="FolderTreeView" style="overflow:auto; height:350px; width:340px; text-align:left;line-height:25px;border-style:groove; white-space:nowrap;"> <a href="javascript:ReturnBack();" id="rootName" style="margin: 0 0 0 10px;"></a> </div> </td> </tbody> </table> </div> </div> <div id="treeViewPop2" style="display:none"> <div class="dialogBox" style="width:550px;height:400px;"> <div id="closeCreatePopBtn" onclick="closeTreeView2POP()" style="cursor:pointer"></div> <table class="myCreatePop_table_left" style="width:200px" border="0" cellspacing="0" id="tblTreeView3"> <tbody> <tr> <td><div class="popTitle_s"><script>I18N("h","Disk Name");</script></div></td> </tr> <td> <div id="partitionView2" style="overflow:auto;height:350px;text-align:left;margin: 0 0 0 10px;"></div> </td> </tbody> </table> <table class="myCreatePop_table_right" style="width:350px" border="0" cellspacing="0" id="tblTreeView4"> <tbody> <tr> <td><div class="popTitle_s"><script>I18N("h","Select Folder");</script></div></td> </tr> <td> <div id="FolderTreeView2" style="overflow:auto; height:350px; width:340px; text-align:left;line-height:25px;border-style:groove;white-space:nowrap;"> <a href="javascript:ReturnBack2();" id="rootName2" style="margin: 0 0 0 10px;"></a> </div> </td> </tbody> </table> </div> </div> <form name="shareport_c1_form" id="shareport_c1_form" action=""> <input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none"/> <div id="createPop" style="display:none"> <div class="dialogBox" style="width:550px"> <div id="closeCreatePopBtn" onclick="clearCreateRulePOP()" style="cursor:pointer"></div> <table class="myCreatePop_table" border="0" cellspacing="0" id="tblUserList2"> <tbody> <tr> <td colspan="3"><div class="popTitle"><script>I18N("h","Create New User");</script></div></td> </tr> <tr> <th><script>I18N("h","User Name");</script>:</th> <td colspan="2"><input class="styled-text required" type="text" name="shareport_UserName" size="27" maxlength="20" id="shareport_UserName" tabindex="1"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="shareport_Password" size="27" maxlength="32" id="shareport_Password" tabindex="2"></td> </tr> <tr> <th><script>I18N("h","Permission");</script>:</th> <td colspan="2"> <div class="styled-select"> <select style="width: 80px" name="shareport_PermissionSelect" id="shareport_Permission"> <option value="1">Read Only</option> <option value="2">Read/Write</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Folder");</script>:</th> <td style="width:150px;"> <input class="styled-text" type="text" name="shareport_Folder" size="27" id="shareport_Folder" readonly="true"> </td> <td> <button type="button" name="searchFolder" id="searchFolder" class="styled_button_ss" tabindex="3" onclick="GetDirectoryList()"><script>I18N("h","Browse");</script></button> </td> </tr> <tr> <td id="save_td" colspan="3"> <center><button type="button" class="styled_button_s" id="save_buttonFocus" tabindex="4" onkeyup="focusToFirstIndex(this)" onclick="document.getElementById('sumbit_CheckData').click()"><script>I18N("h","OK");</script></button></center> </td> </tr> </tbody> </table> </div> </div> </form> <form name="shareport_c2_form" id="shareport_c2_form" action=""> <input id="sumbit_CheckData2" class="submit" type="submit" value="Submit" style="display:none"/> <div id="editPop" style="display:none"> <div class="dialogBox" style="width:616px"> <div id="closeCreatePopBtn" onclick="clearEditRulePOP()" style="cursor:pointer"></div> <table class="myCreatePop_table" border="0" cellspacing="0" id="tblUserList3"> <tbody> <tr> <td colspan="3"><div class="popTitle"><script>I18N("h","Edit User Profile");</script></div></td> </tr> <tr> <th><script>I18N("h","User Name");</script>:</th> <td colspan="2"><input class="styled-text required" type="text" name="edit_UserName" size="27" maxlength="20" id="edit_UserName" tabindex="5" onchange="OnChangeUserName(this.value)" disabled></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="edit_Password" size="27" maxlength="32" id="edit_Password" tabindex="2"></td> </tr> <tr> <th><script>I18N("h","Permission");</script>:</th> <td colspan="2"> <div class="styled-select"> <select style="width: 80px" name="edit_PermissionSelect" id="edit_Permission" onchange="OnChangePermission(this.value)"> <option value="1">Read Only</option> <option value="2">Read/Write</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Folder");</script>:</th> <td style="width:150px;"> <input class="styled-text" type="text" name="edit_Folder" size="27" id="edit_Folder" readonly="true" onchange="OnChangeFolder(this.value)"> </td> <td> <button type="button" name="search_Edit_Folder" id="search_Edit_Folder" class="styled_button_ss" tabindex="6" onclick="GetEditDirectoryList()"><script>I18N("h","Browse");</script></button> </td> </tr> <tr> <td id="save_td" colspan="3"> <center><button type="button" class="styled_button_s" id="save_buttonFocus2" tabindex="7" onkeyup="focusToFirstIndex(this)" onclick="document.getElementById('sumbit_CheckData2').click()"><script>I18N("h","OK");</script></button></center> </td> </tr> </tbody> </table> </div> </div> </form> </div> <div id="CreatePopAlertMessage" style="display:none"> <div id="AlertPopRect"> <div id="AlertPopBody"> <table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0"> <tbody> <tr> <td> <center><div id="Loading_pop_image2"></div></center> </td> </tr> <tr> <td label id="reciprocal_Number"></label></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Your changes are being saved.");</script></td> </tr> </tbody> </table> </div> </div> </div> <div id="DetectRouterConnection" style="display:none"></div> <div id="footer"> <div id="copyright"><script>I18N("h","COPYRIGHT");</script></div> </div> </div> <script type="text/javascript" charset="utf-8">$(document).ready(function(){$.validator.addMethod("checkHEXChar",function(c,a){var d=/^[a-zA-Z0-9_-]+$/;var b=true;if(d.test(c)){b=true}else{b=false}return b},jQuery.validator.messages.check_IllegalChar);$("#shareport_c1_form, #shareport_c2_form").each(function(a,b){$(b).validate({rules:{shareport_UserName:{required:true,checkHEXChar:true},edit_UserName:{required:true,checkHEXChar:true}},messages:{shareport_UserName:{required:jQuery.validator.messages.check_UserName},edit_UserName:{required:jQuery.validator.messages.check_UserName}},submitHandler:function(c){if(c.id=="shareport_c1_form"){closeCreateUserPOP()}if(c.id=="shareport_c2_form"){closeEditUserPOP(set_Iteration);save_button_changed()}},debug:true})})});</script> </body> <script type="text/javascript">Load_HTML();Initial();setMenu("menu_Settings");GetXML();startTimeout();</script> </html>