function Datalist(){this.list=new Array();this.maxrowid=0}Datalist.prototype.getData=function(b){var a;var c;for(a=0;a<this.list.length;a++){c=this.list[a];if(c.rowid==b){break}}return c};Datalist.prototype.getRowNum=function(a){var b=0;for(b=0;b<this.list.length;b++){if(a==this.list[b].rowid){break}}return b};Datalist.prototype.editData=function(c,a){var b=this.getRowNum(c);if(this.checkData(a,b)==false){return false}a.setRowid(c);this.list.splice(b,1,a);a.setDataToRow($("#tr"+a.rowid));return true};Datalist.prototype.deleteData=function(b){var a=this.getRowNum(b);this.list.splice(a,1);$("#tr"+b).remove()};Datalist.prototype.push=function(a){if(this.checkData(a,null)==false){return false}a.setRowid(this.maxrowid);this.list.push(a);this.maxrowid++;a.addRowToHTML("tblPortForwarding");return true};Datalist.prototype.checkData=function(g,z){var u;for(u=0;u<this.list.length;u++){if(u==z){continue}if(this.list[u].name==g.name){alert(I18N("j","Name cannot be the same."));return false}var e=this.list[u].tcpPort.split(",");var c=g.tcpPort.split(",");var f;var p;var y;var d;var o;var x;for(var t=0;t<e.length;t++){for(var s=0;s<c.length;s++){if(e[t].match("-")=="-"&&c[s].match("-")=="-"){f=e[t].split("-");p=parseInt(f[0],10);y=parseInt(f[1],10);d=c[s].split("-");o=parseInt(d[0],10);x=parseInt(d[1],10);if((o<=y)&&(p<=x)){alert(I18N("j","The TCP ports are overlapping."));return false}}else{if(e[t].match("-")=="-"){f=e[t].split("-");p=parseInt(f[0],10);y=parseInt(f[1],10);if((p<=parseInt(c[s],10))&&(parseInt(c[s],10)<=y)){alert(I18N("j","The TCP ports are overlapping."));return false}}else{if(c[s].match("-")=="-"){d=c[s].split("-");o=parseInt(d[0],10);x=parseInt(d[1],10);if((o<=parseInt(e[t],10))&&(parseInt(e[t],10)<=x)){alert(I18N("j","The TCP ports are overlapping."));return false}}else{if(parseInt(e[t],10)==parseInt(c[s],10)){alert(I18N("j","The TCP ports are overlapping."));return false}}}}}}var a=this.list[u].udpPort.split(",");var B=g.udpPort.split(",");var b;var l;var w;var A;var h;var v;for(var r=0;r<a.length;r++){for(var q=0;q<B.length;q++){if(a[r].match("-")=="-"&&B[q].match("-")=="-"){b=a[r].split("-");l=parseInt(b[0],10);w=parseInt(b[1],10);A=B[q].split("-");h=parseInt(A[0],10);v=parseInt(A[1],10);if((h<=w)&&(l<=v)){alert(I18N("j","The UDP ports are overlapping."));return false}}else{if(a[r].match("-")=="-"){b=a[r].split("-");l=parseInt(b[0],10);w=parseInt(b[1],10);if((l<=parseInt(B[q],10))&&(parseInt(B[q],10)<=w)){alert(I18N("j","The UDP ports are overlapping."));return false}}else{if(B[q].match("-")=="-"){A=B[q].split("-");h=parseInt(A[0],10);v=parseInt(A[1],10);if((h<=parseInt(a[r],10))&&(parseInt(a[r],10)<=v)){alert(I18N("j","The UDP ports are overlapping."));return false}}else{if(parseInt(a[r],10)==parseInt(B[q],10)){alert(I18N("j","The UDP ports are overlapping."));return false}}}}}}}return true};Datalist.prototype.length=function(){return this.list.length};function Data(c,d,a,b,e){this.name=c;this.ipAddress=d;this.tcpPort=this.reassemblePort(a);this.udpPort=this.reassemblePort(b);if((e=="")||(e.toLowerCase()=="always")){this.schedule="Always"}else{this.schedule=e}this.setEnable("true")}Data.prototype={rowid:null,enable:null,name:null,ipAddress:null,tcpPort:null,udpPort:null,schedule:null,setRowid:function(a){this.rowid=a},setEnable:function(a){this.enable=a},setEnableValue:function(){var a=document.getElementById("pf"+this.rowid).checked;this.enable=a},reassemblePort:function(a){var d=a.split(",");var e="";if(a==""){return e}for(var c=0;c<d.length;c++){if(c>0){e+=","}var b=d[c].split("-");e+=parseInt(b[0],10);if(isNaN(b[1])==false){e+="-"+parseInt(b[1],10)}}return e},showEnable:function(){var b;var a="";if(this.enable=="true"){a="checked"}b="<input id=pf"+this.rowid+' type="checkbox" onChange="datalist.list['+this.rowid+'].setEnableValue()" '+a+"/>";return b},showName:function(){return HTMLEncode(this.name)},showTCPPort:function(){if(this.tcpPort==""){return"N/A"}else{return this.tcpPort}},showUDPPort:function(){if(this.udpPort==""){return"N/A"}else{return this.udpPort}},showSchedule:function(){if((this.schedule=="Always")||(this.schedule=="")){return I18N("j","Always")}else{return HTMLEncode(this.schedule)}},addRowToHTML:function(c){var b;b="<tr id='tr"+this.rowid+"'></tr>";var a="#"+c+"> tbody";$(a).append(b);this.setDataToRow($("#tr"+this.rowid));return},setDataToRow:function(a){var b;b="<td>"+this.showEnable()+"</td>";b+="<td>"+this.showName()+"</td>";b+="<td>"+this.ipAddress+"</td>";b+="<td>"+this.showTCPPort()+"</td>";b+="<td>"+this.showUDPPort()+"</td>";b+="<td>"+this.showSchedule()+"</td>";b+="<td><img src='image/edit_btn.png' width=28 height=28 style='cursor:pointer' onclick='editData("+this.rowid+")'/></td>";b+="<td><img src='image/trash.png' width=41 height=41 style='cursor:pointer' onclick='deleteData("+this.rowid+")'/></td>";a.html(b);return}};