<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3c.org/1999/xhtml"> <head> <title>D-LINK</title> <meta http-equiv="X-UA-Compatible" content="IE=9"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="Content-Type" content="text/css"> <link rel=stylesheet type="text/css" href="/css/jquery.selectbox.css?v=20160418141035"/> <script type="text/javascript" charset="utf-8" src="/js/initialJQ.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialJS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialCSS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialValidate.js"></script> <script type="text/javascript" charset="utf-8" src="/js/Firewall.js?v=20160418141035"></script> <script type="text/javascript">var HNAP=new HNAP_XML();var Total_ScheduleRules=0;var Limit_FirewallRules=24;var Total_Client=0;var Limit_Client=256;var _ReciprocalRebootNumber=80;function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu();initialDetectRouterConnection();datalist=new Datalist()}function GetScheduleList(){HNAP.GetXMLAsync("GetScheduleSettings",null,"GetValue",function(a){GetResult_1st(a)})}function GetResult_1st(b){if(b!=null){var d=b.Get("GetScheduleSettingsResponse/ScheduleInfoLists#");Total_ScheduleRules=d;var e=document.getElementById("select_FWv6_Schedule");for(var c=1;c<=Total_ScheduleRules;c++){var a=decode_char_text(b.Get("GetScheduleSettingsResponse/ScheduleInfoLists:"+c+"/ScheduleName"));e.options.add(new Option(a,a))}HNAP.GetXMLAsync("GetIPv6FirewallSettings",null,"GetValue",function(f){GetResult_2nd(f)})}else{if(DebugMode==1){alert("[!!GetXML Error!!] Function: GetResult_1st")}}}function GetResult_2nd(f){if(f!=null){var j=f.Get("GetIPv6FirewallSettingsResponse/IPv6FirewallRuleLists/IPv6FirewallRule#");for(var n=1;n<=j;n++){var b=f.Get("GetIPv6FirewallSettingsResponse/IPv6FirewallRuleLists/IPv6FirewallRule:"+n+"/Name");var d=f.Get("GetIPv6FirewallSettingsResponse/IPv6FirewallRuleLists/IPv6FirewallRule:"+n+"/Schedule");var a=f.Get("GetIPv6FirewallSettingsResponse/IPv6FirewallRuleLists/IPv6FirewallRule:"+n+"/SrcInterface");var h=f.Get("GetIPv6FirewallSettingsResponse/IPv6FirewallRuleLists/IPv6FirewallRule:"+n+"/SrcIPv6AddressRangeStart");var e=f.Get("GetIPv6FirewallSettingsResponse/IPv6FirewallRuleLists/IPv6FirewallRule:"+n+"/SrcIPv6AddressRangeEnd");var l=f.Get("GetIPv6FirewallSettingsResponse/IPv6FirewallRuleLists/IPv6FirewallRule:"+n+"/DestInterface");var m=f.Get("GetIPv6FirewallSettingsResponse/IPv6FirewallRuleLists/IPv6FirewallRule:"+n+"/DestIPv6AddressRangeStart");var o=f.Get("GetIPv6FirewallSettingsResponse/IPv6FirewallRuleLists/IPv6FirewallRule:"+n+"/DestIPv6AddressRangeEnd");var r=f.Get("GetIPv6FirewallSettingsResponse/IPv6FirewallRuleLists/IPv6FirewallRule:"+n+"/Protocol");var q=f.Get("GetIPv6FirewallSettingsResponse/IPv6FirewallRuleLists/IPv6FirewallRule:"+n+"/PortRangeStart");var g=f.Get("GetIPv6FirewallSettingsResponse/IPv6FirewallRuleLists/IPv6FirewallRule:"+n+"/PortRangeEnd");var p=h+"-"+e;var c=m+"-"+o;var k=q+"-"+g;var t=new Data(decode_char_text(b),a,p,l,c,r,k,decode_char_text(d));datalist.push(t)}var s=f.Get("GetIPv6FirewallSettingsResponse/IPv6_FirewallStatus");switch(s){case"Disable":document.getElementById("filter_FW_IPv6").options[0].selected=true;break;case"Enable_WhiteList":document.getElementById("filter_FW_IPv6").options[1].selected=true;break;case"Enable_BlackList":document.getElementById("filter_FW_IPv6").options[2].selected=true;break}check_TotalRule(Limit_FirewallRules,datalist.length());$("#filter_FW_IPv6").selectbox({width:520});$("#select_FWv6_SourceInterface").selectbox({width:170});$("#select_FWv6_DestinationInterface").selectbox({width:170});$("#select_FWv6_Protocol").selectbox({width:170});$("#select_FWv6_Schedule").selectbox({width:170});document.getElementById("main").style.display="inline";$("select").change(function(){save_button_changed()});$("input").keydown(function(){save_button_changed()});$("input").change(function(){save_button_changed()})}else{if(DebugMode==1){alert("[!!GetXML Error!!] Function: GetResult_2nd")}}}function CheckConnectionStatus(){$.ajax({cache:false,url:"./js/CheckConnection",timeout:5000,type:"GET",success:function(a){SetXML()},error:function(){document.getElementById("DetectRouterConnection").style.display="inline"}})}function SetXML(){document.getElementById("CreatePopAlertMessage").style.display="inline";HNAP.GetXMLAsync("SetIPv6FirewallSettings",null,"GetXML",function(a){SetResult_1st(a)})}function SetResult_1st(a){if(a!=null){var c=document.getElementById("filter_FW_IPv6").value;if(datalist.length()!=0){switch(c){case"0":a.Set("SetIPv6FirewallSettings/IPv6_FirewallStatus","Disable");break;case"1":a.Set("SetIPv6FirewallSettings/IPv6_FirewallStatus","Enable_WhiteList");break;case"2":a.Set("SetIPv6FirewallSettings/IPv6_FirewallStatus","Enable_BlackList");break}for(var b=0;b<datalist.length();b++){a.Set("SetIPv6FirewallSettings/IPv6FirewallRuleLists/IPv6FirewallRule:"+(b+1)+"/Name",encode_char_text(datalist.list[b].name));a.Set("SetIPv6FirewallSettings/IPv6FirewallRuleLists/IPv6FirewallRule:"+(b+1)+"/Status","Enable");a.Set("SetIPv6FirewallSettings/IPv6FirewallRuleLists/IPv6FirewallRule:"+(b+1)+"/Schedule",encode_char_text(datalist.list[b].schedule));a.Set("SetIPv6FirewallSettings/IPv6FirewallRuleLists/IPv6FirewallRule:"+(b+1)+"/SrcInterface",datalist.list[b].srcInterface);a.Set("SetIPv6FirewallSettings/IPv6FirewallRuleLists/IPv6FirewallRule:"+(b+1)+"/SrcIPv6AddressRangeStart",datalist.list[b].srcIPstart);a.Set("SetIPv6FirewallSettings/IPv6FirewallRuleLists/IPv6FirewallRule:"+(b+1)+"/SrcIPv6AddressRangeEnd",datalist.list[b].srcIPend);a.Set("SetIPv6FirewallSettings/IPv6FirewallRuleLists/IPv6FirewallRule:"+(b+1)+"/DestInterface",datalist.list[b].dstInterface);a.Set("SetIPv6FirewallSettings/IPv6FirewallRuleLists/IPv6FirewallRule:"+(b+1)+"/DestIPv6AddressRangeStart",datalist.list[b].dstIPstart);a.Set("SetIPv6FirewallSettings/IPv6FirewallRuleLists/IPv6FirewallRule:"+(b+1)+"/DestIPv6AddressRangeEnd",datalist.list[b].dstIPend);a.Set("SetIPv6FirewallSettings/IPv6FirewallRuleLists/IPv6FirewallRule:"+(b+1)+"/Protocol",datalist.list[b].protocol);a.Set("SetIPv6FirewallSettings/IPv6FirewallRuleLists/IPv6FirewallRule:"+(b+1)+"/PortRangeStart",datalist.list[b].portStart);a.Set("SetIPv6FirewallSettings/IPv6FirewallRuleLists/IPv6FirewallRule:"+(b+1)+"/PortRangeEnd",datalist.list[b].portEnd)}}else{a.Set("SetIPv6FirewallSettings/IPv6_FirewallStatus","Disable")}HNAP.SetXMLAsync("SetIPv6FirewallSettings",a,function(d){SetResult_2nd(d)})}else{if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_1st")}}}function SetResult_2nd(b){var a=b.Get("SetIPv6FirewallSettingsResponse/SetIPv6FirewallSettingsResult");if(a=="OK"){setTimeout("waitSettingFinished()",1000)}else{if(a=="REBOOT"){HNAP.GetXMLAsync("Reboot",null,"GetXML",function(c){SetResult_3rd(c)})}else{if(a=="ERROR"){if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_2nd")}window.location.reload()}}}}function SetResult_3rd(a){if(a!=null){HNAP.SetXMLAsync("Reboot",a,function(b){SetResult_4th(b)})}else{alert("An error occurred!")}}function SetResult_4th(b){var a=b.Get("RebootResponse/RebootResult");if(a=="REBOOT"){document.getElementById("waitSettingFinish").style.display="none";document.getElementById("REBOOT").style.display="inline";Start_reciprocal_Number_Reboot()}else{if(a=="ERROR"){if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_4th")}setTimeout("waitSettingFinished()",1000)}}}function Start_reciprocal_Number_Reboot(){if(_ReciprocalRebootNumber>=0){document.getElementById("reciprocal_Number_Reboot").innerHTML=_ReciprocalRebootNumber+" "+I18N("j","Sec");_ReciprocalRebootNumber--;setTimeout("Start_reciprocal_Number_Reboot()",1000)}else{window.location.reload()}}function waitSettingFinished(){window.location.reload()}function createUserButton(){changeTimeoutAction();$("#popTitle").html(I18N("j","Create New Rule"));document.getElementById("createPop").style.display="inline";document.getElementById("createButton").disabled=true;$("#firewall_form").val(-1)}function closeCreateRulePOP(c){changeTimeoutAction();var k=false;var a=$("#FWv6_Name").val();var b=$("#select_FWv6_SourceInterface").val();var i=$("#FWv6_SourceIPRange").val();var g=$("#select_FWv6_DestinationInterface").val();var h=$("#FWv6_DestinationIPRange").val();var j=$("#select_FWv6_Protocol").val();var d=$("#FWv6_PortRange").val();var f=$("#select_FWv6_Schedule").val();var e=new Data(a,b,i,g,h,j,d,f);if(c<0){k=datalist.push(e)}else{k=datalist.editData(c,e)}if(k){resetRulePOP();check_TotalRule(Limit_FirewallRules,datalist.length())}}function clearCreateRulePOP(){changeTimeoutAction();resetRulePOP();$("#firewall_form").validate().resetForm();$(":text").attr("class","styled-text");check_TotalRule(Limit_FirewallRules,datalist.length())}function resetRulePOP(){$("select").selectbox("detach");$("input").val("");document.getElementById("createPop").style.display="none";$("#select_FWv6_SourceInterface").val("WAN");$("#select_FWv6_SourceInterface").selectbox({width:170});$("#select_FWv6_DestinationInterface").val("WAN");$("#select_FWv6_DestinationInterface").selectbox({width:170});$("#select_FWv6_Protocol").val("TCP");$("#select_FWv6_Protocol").selectbox({width:170});$("#select_FWv6_Schedule").val("Always");$("#select_FWv6_Schedule").selectbox({width:170});$("#filter_FW_IPv6").selectbox({width:520});$("select").selectbox("attach")}function editData(b){changeTimeoutAction();$("#popTitle").html(I18N("j","Edit Rule"));document.getElementById("createPop").style.display="inline";document.getElementById("createButton").disabled=true;$("#firewall_form").val(b);var a=datalist.getData(b);$("#FWv6_Name").val(a.name);$("#FWv6_SourceIPRange").val(a.createRange(a.srcIPstart,a.srcIPend));$("#FWv6_DestinationIPRange").val(a.createRange(a.dstIPstart,a.dstIPend));$("#FWv6_PortRange").val(a.createRange(a.portStart,a.portEnd));$("select").selectbox("detach");$("#select_FWv6_SourceInterface").val(a.srcInterface);$("#select_FWv6_DestinationInterface").val(a.dstInterface);$("#select_FWv6_Schedule").val(a.schedule);$("#select_FWv6_Protocol").val(a.protocol);$("select").selectbox("attach");change_select_FWv6_Protocol()}function deleteData(a){changeTimeoutAction();datalist.deleteData(a);check_TotalRule(Limit_FirewallRules,datalist.length());save_button_changed()}function focusToFirstIndex(a){if(a.id=="save_buttonFocus"){if(window.event.keyCode==9){document.getElementById("FWv6_Name").focus()}}}function save_button_changed(){document.getElementById("Save_Disable_btn").style.display="none";document.getElementById("Save_btn").style.display="block";changeFlag=true;checkFlag=true;changeTimeoutAction()}function check_TotalRule(a,c){var b=a-c;document.getElementById("RemainingRules").innerHTML=b;if(b==0){$("#createButton").attr("class","styled_button_dis").prop("disabled",true)}else{$("#createButton").attr("class","styled_button_s").prop("disabled",false)}}function change_select_FWv6_Protocol(){var a=document.getElementById("select_FWv6_Protocol").value;switch(a){case"Any":document.getElementById("FWv6_PortRange").style.display="none";break;case"TCP":case"UDP":document.getElementById("FWv6_PortRange").style.display="block";break}}$(document).ready(function(){Load_HTML();Initial();setMenu("menu_Advanced");GetScheduleList();startTimeout()});</script> </head> <body> <div id="wrapper"> <div id="header"></div> <div id="menu"></div> <div id="menu_edge"></div> <div id="content"> <div id="info"> <div id="FunctionName"><script>I18N("h","Firewall Settings");</script></div> <div id="wall"><img src="image/wall.png" alt="" width="195" height="119"/></div> <div id="directions"> <script>I18N("h","Your router's built-in firewall also supports IPv6. Some applications or clients may require special adjustment for better performance or extra protection.");</script> </div> </div> <div id="funcBar"> <div id="pagePath"><script>I18N("h","Features");</script> >> <script>I18N("h","Firewall Settings");</script> >> <script>I18N("h","IPv6 Rules");</script></div> <ul id="rightFunc"> <li style="display:block"><div id="Save_btn" onclick="CheckConnectionStatus();changeTimeoutAction();" style="cursor:pointer; display:none"><script>I18N("h","Save");</script></div></li> <li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save");</script></div></li> <li style="display:block"><a href="javascript:CheckHTMLStatus('Firewall_IPv4');" style="text-decoration:none;" onclick="return confirmExit()"><div id="page_btn" class="linkstyle_1"><script>I18N("h","IPv4 Rules");</script></div></a></li> <li style="display:block"><a href="javascript:CheckHTMLStatus('Firewall');" style="text-decoration:none;" onclick="return confirmExit()"><div id="page_btn" class="linkstyle_1"><script>I18N("h","Advanced");</script></div></a></li> </ul> </div> <div id="main" style="display:none"> <table class="myTable" border="0" cellspacing="0"> <tr> <td> <div class="styled-select"> <select name="filter_FW_IPv6" id="filter_FW_IPv6"> <option value="0">Turn IPv6 Filtering OFF</option> <option value="1">Turn IPv6 Filtering ON and ALLOW rules listed</option> <option value="2">Turn IPv6 Filtering ON and DENY rules listed</option> </select> </div> </td> </tr> </table> <table class="mainTable" border="0" cellspacing="0" id="tblFirewall"> <thead> <tr> <th><script>I18N("h","Name");</script></th> <th><script>I18N("h","Schedule");</script></th> <th><script>I18N("h","Edit");</script></th> <th><script>I18N("h","Delete");</script></th> </tr> </thead> <tbody></tbody> </table> <br/> <br/> <button type="button" name="createButton" id="createButton" class="styled_button_s" onclick="createUserButton()"><script>I18N("h","Add Rule");</script></button> &nbsp;&nbsp;<script>I18N("h","Remaining");</script>:&nbsp;<label id="RemainingRules">10</label> <br/> <form name="firewall_form" id="firewall_form" action=""> <input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none"/> <div id="createPop" style="display:none"> <div class="dialogBox" style="width:650px"> <div id="closeCreatePopBtn" onclick="clearCreateRulePOP()" style="cursor:pointer"></div> <table class="myCreatePop_table" border="0" cellspacing="0" ondragstart="return false" onselectstart="return false" id="tblIPv6Firewall2"> <tbody> <tr> <td colspan="3"><div class="popTitle" id="popTitle"></div></td> </tr> <tr> <th style="width:238px"><script>I18N("h","Name");</script>:</th> <td colspan="2"><input class="styled-text" type="text" size="22" name="FWv6_Name" id="FWv6_Name" Maxlength="20" tabindex="1" style="width:160px;"></td> </tr> <tr> <th><script>I18N("h","Source IP Address Range");</script>:</th> <td valign="top"> <select style="width: 80px" name="select_FWv6_SourceInterface" id="select_FWv6_SourceInterface"> <option value="WAN">WAN</option> <option value="LAN">LAN</option> </select> </td> <td valign="top"> <input class="styled-text" type="text" size="32" name="FWv6_SourceIPRange" id="FWv6_SourceIPRange" tabindex="2"> </td> </tr> <tr> <th><script>I18N("h","Destination IP Address Range");</script>:</th> <td valign="top"> <select style="width: 80px" name="select_FWv6_DestinationInterface" id="select_FWv6_DestinationInterface"> <option value="WAN">WAN</option> <option value="LAN">LAN</option> </select> </td> <td valign="top"> <input class="styled-text" type="text" size="32" name="FWv6_DestinationIPRange" id="FWv6_DestinationIPRange" tabindex="3"> </td> </tr> <tr> <th><script>I18N("h","Port Range");</script>:</th> <td valign="top"> <select style="width: 80px" name="select_FWv6_Protocol" id="select_FWv6_Protocol" onchange="change_select_FWv6_Protocol();"> <option value="TCP">TCP</option> <option value="UDP">UDP</option> <option value="Any">Any</option> </select> </td> <td valign="top"> <input class="styled-text" type="text" size="10" name="FWv6_PortRange" id="FWv6_PortRange" tabindex="4"> </td> </tr> <tr> </tr> <tr> <th class="linkstyle_1"><a href="Schedule.html"><script>I18N("h","Schedule");</script></a>:</th> <td> <select style="width: 80px" name="select_FWv6_Schedule" id="select_FWv6_Schedule" tabindex="5"> <option value="Always" selected>Always</option> </select> </td> <td></td> </tr> <tr> <td id="save_td" colspan="3"> <center><button type="button" class="styled_button_s" id="save_buttonFocus" tabindex="6" onkeyup="focusToFirstIndex(this)" onclick="document.getElementById('sumbit_CheckData').click()"><script>I18N("h","Apply");</script></button></center> </td> </tr> </tbody> </table> </div> </div> </form> </div> </div> <div id="CreatePopAlertMessage" style="display:none"> <div id="AlertPopRect"> <div id="AlertPopBody"> <table class="myAlertPop_table" id="REBOOT" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td> <center><div id="Loading_pop_image"></div></center> </td> </tr> <tr> <td><label id="reciprocal_Number_Reboot"></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Rebooting");</script></td> </tr> </tbody> </table> <table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0"> <tbody> <tr> <td> <center><div id="Loading_pop_image2"></div></center> </td> </tr> <tr> <td label id="reciprocal_Number"></label></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Your changes are being saved.");</script></td> </tr> </tbody> </table> </div> </div> </div> <div id="DetectRouterConnection" style="display:none"></div> <div id="footer"> <div id="copyright"><script>I18N("h","COPYRIGHT");</script></div> </div> </div> <script type="text/javascript" charset="utf-8">$(document).ready(function(){$.validator.addMethod("checkPortRange",function(f,c){var b=f.split("-");var g;var a=null;if(f==""){return true}if(b.length>2){return false}g=b[0];var e=parseInt(g,10);if(isNaN(g)||(g=="")){return false}if((e<=0)||(e>65535)){return false}if(b.length>1){a=b[1];var d=parseInt(a,10);if(isNaN(a)||(a=="")){return false}if((d<=0)||(d>65535)){return false}if(e>d){return false}}return true},jQuery.validator.messages.port_CheckRange);$.validator.addMethod("checkIPFormat",function(d,a){var c=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})))))\-((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})))))(%.+)?\s*$/;var e=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})))))+$/;var b=true;if(e.test(d)){b=true}else{if(c.test(d)){b=true}else{b=false}}return b},jQuery.validator.messages.ipv6address_CheckRange);$("#firewall_form").each(function(a,b){$(b).validate({rules:{FWv6_Name:{required:true},FWv6_SourceIPRange:{required:true,checkIPFormat:true},FWv6_DestinationIPRange:{required:true,checkIPFormat:true},FWv6_PortRange:{checkPortRange:true}},messages:{FWv6_Name:{required:jQuery.validator.messages.rule_Name},FWv6_SourceIPRange:{required:jQuery.validator.messages.sourceIP},FWv6_DestinationIPRange:{required:jQuery.validator.messages.destinationIP}},submitHandler:function(c){var d=c.value;closeCreateRulePOP(d)},debug:true})})});</script> </body> </html>