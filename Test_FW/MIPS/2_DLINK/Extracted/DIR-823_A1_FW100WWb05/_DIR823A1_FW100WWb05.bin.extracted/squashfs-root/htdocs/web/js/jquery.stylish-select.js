(function(a){a("html").addClass("stylish-select");if(!Array.prototype.indexOf){Array.prototype.indexOf=function(d){if(this===void 0||this===null){throw new TypeError()}var e=Object(this);var b=e.length>>>0;if(b===0){return -1}var f=0;if(arguments.length>0){f=Number(arguments[1]);if(f!==f){f=0}else{if(f!==0&&f!==(1/0)&&f!==-(1/0)){f=(f>0||-1)*Math.floor(Math.abs(f))}}}if(f>=b){return -1}var c=f>=0?f:Math.max(b-Math.abs(f),0);for(;c<b;c++){if(c in e&&e[c]===d){return c}}return -1}}a.fn.extend({getSetSSValue:function(b){if(b){a(this).val(b).change();return this}else{return a(this).find(":selected").val()}},resetSS:function(){var b=a(this).data("ssOpts");$this=a(this);$this.next().remove();$this.unbind(".sSelect").sSelect(b)}});a.fn.sSelect=function(b){return this.each(function(){var l={defaultText:"Please select",animationSpeed:0,ddMaxHeight:"",containerClass:""};var o=a.extend(l,b),f=a(this),m=a('<div class="selectedTxt"></div>'),v=a('<div class="newListSelected '+o.containerClass+(f.is(":disabled")?" newListDisabled":"")+'"></div>'),k=a('<div class="SSContainerDivWrapper" style="visibility:hidden;"></div>'),D=a('<ul class="newList"></ul>'),e=-1,j=-1,p=[],A=false,y=false,B;a(this).data("ssOpts",b);v.insertAfter(f);v.attr("tabindex",f.attr("tabindex")||"0");m.prependTo(v);D.appendTo(v);D.wrap(k);k=D.parent();f.hide();if(f.is(":disabled")){return}m.data("ssReRender",!m.is(":visible"));function u(I,F){var H=a(I).text(),G=a(I).val(),E=a(I).is(":disabled");if(!E&&!a(I).parents().is(":disabled")){p.push(H.charAt(0).toLowerCase())}F.append(a("<li><a"+(E?' class="newListItemDisabled"':"")+' href="JavaScript:void(0);">'+H+"</a></li>").data({key:G,selected:a(I).is(":selected")}))}f.children().each(function(){if(a(this).is("option")){u(this,D)}else{var E=a(this).attr("label"),G=a('<li class="newListOptionTitle '+(a(this).is(":disabled")?"newListOptionDisabled":"")+'">'+E+"</li>"),F=a("<ul></ul>");G.appendTo(D);F.appendTo(G);a(this).children().each(function(){u(this,F)})}});B=D.find("li a:not(.newListItemDisabled)").not(function(){return a(this).parents().hasClass("newListOptionDisabled")});B.each(function(E){if(a(this).parent().data("selected")){o.defaultText=a(this).html();e=j=E}});var r=D.height(),q=v.height(),C=B.length;if(e!=-1){i(e)}else{m.text(o.defaultText)}function s(){var F=v.offset().top,E=a(window).height(),G=a(window).scrollTop();if(r>parseInt(o.ddMaxHeight)){r=parseInt(o.ddMaxHeight)}F=F-G;if(F+r>=E){D.css({height:r});k.css({top:"-"+r+"px",height:r});f.onTop=true}else{D.css({height:r});k.css({top:q+"px",height:r});f.onTop=false}}s();a(window).bind("resize.sSelect scroll.sSelect",s);function w(){v.css("position","relative")}function d(){v.css({position:"static"})}m.bind("click.sSelect",function(F){F.stopPropagation();if(a(this).data("ssReRender")){r=D.height("").height();k.height("");q=v.height();a(this).data("ssReRender",false);s()}a(".SSContainerDivWrapper").not(a(this).next()).hide().parent().css("position","static").removeClass("newListSelFocus");k.toggle();w();if(e==-1){e=0}try{B.eq(e).focus()}catch(E){}});function c(F,E){if(F==true){j=e;f.change()}if(E==true){e=j;i(e)}k.hide();d()}B.bind("click.sSelect",function(F){var E=a(F.target);e=B.index(E);y=true;i(e,true);c()});B.bind("mouseenter.sSelect",function(F){var E=a(F.target);E.addClass("newListHover")}).bind("mouseleave.sSelect",function(F){var E=a(F.target);E.removeClass("newListHover")});function i(E,I){if(E==-1){m.text(o.defaultText);B.removeClass("hiLite")}else{B.removeClass("hiLite").eq(E).addClass("hiLite");var H=B.eq(E).text(),G=B.eq(E).parent().data("key");try{f.val(G)}catch(F){f[0].selectedIndex=E}m.text(H);if(I==true){j=E;f.change()}if(k.is(":visible")){try{B.eq(E).focus()}catch(F){}}}}f.bind("change.sSelect",function(F){var E=a(F.target);if(y==true){y=false;return false}var G=E.find(":selected");e=E.find("option").index(G);i(e)});function t(E){a(E).unbind("keydown.sSelect").bind("keydown.sSelect",function(H){var G=H.which;y=true;switch(G){case 40:case 39:x();return false;break;case 38:case 37:n();return false;break;case 33:case 36:h();return false;break;case 34:case 35:g();return false;break;case 13:case 27:c(true);return false;break;case 9:c(true);z();return false;break}keyPressed=String.fromCharCode(G).toLowerCase();var F=p.indexOf(keyPressed);if(typeof F!="undefined"){++e;e=p.indexOf(keyPressed,e);if(e==-1||e==null||A!=keyPressed){e=p.indexOf(keyPressed)}i(e);A=keyPressed;return false}})}function x(){if(e<(C-1)){++e;i(e)}}function n(){if(e>0){--e;i(e)}}function h(){e=0;i(e)}function g(){e=C-1;i(e)}v.bind("click.sSelect",function(E){E.stopPropagation();t(this)});v.bind("focus.sSelect",function(){a(this).addClass("newListSelFocus");t(this)});v.bind("blur.sSelect",function(){a(this).removeClass("newListSelFocus")});a(document).bind("click.sSelect",function(){v.removeClass("newListSelFocus");if(k.is(":visible")){c(false,true)}else{c(false)}});function z(){var E=a("body").find("button,input,textarea,select"),F=E.index(f);if(F>-1&&(F+1)<E.length){E.eq(F+1).focus()}return false}f.focus(function(){f.next().focus()});m.bind("mouseenter.sSelect",function(F){var E=a(F.target);E.parent().addClass("newListSelHover")}).bind("mouseleave.sSelect",function(F){var E=a(F.target);E.parent().removeClass("newListSelHover")});k.css({left:"0",display:"none",visibility:"visible"})})}})(jQuery);