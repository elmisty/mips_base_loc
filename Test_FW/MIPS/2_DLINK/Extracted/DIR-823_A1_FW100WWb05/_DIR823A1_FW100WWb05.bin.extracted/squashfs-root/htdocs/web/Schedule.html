<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3c.org/1999/xhtml"> <head> <title>D-LINK</title> <meta http-equiv="X-UA-Compatible" content="IE=9"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="Content-Type" content="text/css"> <meta name="viewport" content="width=device-width, initial-scale=1.0 maximum-scale=1, user-scalable=no"/> <link rel=stylesheet type="text/css" href="/css/jquery.selectbox.css?v=20160418141035"/> <script type="text/javascript" charset="utf-8" src="/js/initialJQ.js"></script> <script type="text/javascript" charset="utf-8" src="/js/jquery-ui.custom.min.js?v=20160418141035"></script> <script type="text/javascript" charset="utf-8" src="/js/jquery.ui.selectable.js?v=20160418141035"></script> <script type="text/javascript" charset="utf-8" src="/js/jquery.ui.touch-punch.min.js?v=20160418141035"></script> <script type="text/javascript" charset="utf-8" src="/js/initialJS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialCSS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialValidate.js"></script> <script type="text/javascript" charset="utf-8" src="/js/Schedule.js?v=20160418141035"></script> </head> <style>.list{background-color:white}.week .ui-selecting{background:#feca40;color:#feca40}.week .ui-unselecting{background:#feffaf;color:#505050}.week .ui-selected{background:#fffa72;color:#fffa72}.week{list-style-type:none;margin:0;padding:0;width:820px;cursor:default}.week li{margin:4px 1px 3px 0;padding:1px;float:left;width:30px;height:25px;font-size:1em;text-align:center;color:white}</style> <script>var HNAP=new HNAP_XML();var _ReciprocalRebootNumber=100;var Limit_Rules=10;var datalist=new Datalist();var currentRule=null;function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu();initialDetectRouterConnection()}function waitSettingFinished(){window.location.reload()}$(function(){$("input").keydown(function(){save_button_changed()})});function CheckConnectionStatus(){$.ajax({cache:false,url:"./js/CheckConnection",timeout:5000,type:"GET",success:function(a){SetXML()},error:function(){document.getElementById("DetectRouterConnection").style.display="inline"}})}function GetXML(){var a=new HNAP_XML();a.GetXMLAsync("GetScheduleSettings",null,"GetValue",function(b){GetResult_1st(b)})}function GetResult_1st(a){var e=document.getElementById("calendar");var f=a.Get("GetScheduleSettingsResponse/GetScheduleSettingsResult");if(f=="OK"){var h=a.Get("GetScheduleSettingsResponse/ScheduleInfoLists#");if(h!=0){for(var g=1;g<=h;g++){var k=new RuleObj();k.name=decode_char_text(a.Get("GetScheduleSettingsResponse/ScheduleInfoLists:"+g+"/ScheduleName"));var c=a.Get("GetScheduleSettingsResponse/ScheduleInfoLists:"+g+"/ScheduleInfo#");for(var d=0;d<c;d++){var b=new TimeSet();b.date=parseInt(a.Get("GetScheduleSettingsResponse/ScheduleInfoLists:"+g+"/ScheduleInfo:"+(d+1)+"/ScheduleDate"),10);b.start=parseInt(a.Get("GetScheduleSettingsResponse/ScheduleInfoLists:"+g+"/ScheduleInfo:"+(d+1)+"/ScheduleStartTimeInfo/TimeHourValue"),10);b.end=parseInt(a.Get("GetScheduleSettingsResponse/ScheduleInfoLists:"+g+"/ScheduleInfo:"+(d+1)+"/ScheduleEndTimeInfo/TimeHourValue"),10);k.push(b)}datalist.push(k);check_TotalRule(Limit_Rules,datalist.length())}}}}function SetXML(){document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("waitSettingFinish").style.display="inline";HNAP.GetXMLAsync("SetScheduleSettings",null,"GetXML",function(a){SetResult_1st(a)})}function SetResult_1st(b){var f=null;if(b!=null){for(var c=0;c<datalist.length();c++){f=datalist.list[c];b.Set("SetScheduleSettings/ScheduleInfoLists:"+(c+1)+"/ScheduleName",encode_char_text(f.name));for(var a=0;a<f.length();a++){var e="false";if((f.list[a].start==0)&&(f.list[a].end==24)){e="true"}b.Set("SetScheduleSettings/ScheduleInfoLists:"+(c+1)+"/ScheduleInfo:"+(a+1)+"/ScheduleDate",f.list[a].date);b.Set("SetScheduleSettings/ScheduleInfoLists:"+(c+1)+"/ScheduleInfo:"+(a+1)+"/ScheduleAllDay",e);b.Set("SetScheduleSettings/ScheduleInfoLists:"+(c+1)+"/ScheduleInfo:"+(a+1)+"/ScheduleTimeFormat","true");b.Set("SetScheduleSettings/ScheduleInfoLists:"+(c+1)+"/ScheduleInfo:"+(a+1)+"/ScheduleStartTimeInfo/TimeHourValue",f.list[a].start);b.Set("SetScheduleSettings/ScheduleInfoLists:"+(c+1)+"/ScheduleInfo:"+(a+1)+"/ScheduleEndTimeInfo/TimeHourValue",f.list[a].end);b.Set("SetScheduleSettings/ScheduleInfoLists:"+(c+1)+"/ScheduleInfo:"+(a+1)+"/ScheduleStartTimeInfo/TimeMinuteValue","00");b.Set("SetScheduleSettings/ScheduleInfoLists:"+(c+1)+"/ScheduleInfo:"+(a+1)+"/ScheduleEndTimeInfo/TimeMinuteValue","00");b.Set("SetScheduleSettings/ScheduleInfoLists:"+(c+1)+"/ScheduleInfo:"+(a+1)+"/ScheduleStartTimeInfo/TimeMidDateValue","false");b.Set("SetScheduleSettings/ScheduleInfoLists:"+(c+1)+"/ScheduleInfo:"+(a+1)+"/ScheduleEndTimeInfo/TimeMidDateValue","false")}}var d=new HNAP_XML();d.SetXMLAsync("SetScheduleSettings",b,function(g){SetResult_2nd(g)})}else{if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_1st")}document.getElementById("CreatePopAlertMessage").style.display="none"}}function SetResult_2nd(b){var a=b.Get("SetScheduleSettingsResponse/SetScheduleSettingsResult");switch(a){case"OK":window.location.reload();break;case"REBOOT":HNAP.GetXMLAsync("Reboot",null,"GetXML",function(c){SetResult_3th(c)});break;case"ERROR":case"ERROR_BAD_ScheduleInfo":if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_2nd")}window.location.reload();break}}function SetResult_3th(a){if(a!=null){HNAP.SetXMLAsync("Reboot",a,function(b){SetResult_4th(b)})}else{alert("An error occurred!")}}function SetResult_4th(b){var a=b.Get("RebootResponse/RebootResult");if(a=="OK"||a=="REBOOT"){document.getElementById("waitSettingFinish").style.display="none";document.getElementById("REBOOT").style.display="block";Start_reciprocal_Number_Reboot()}if(a=="ERROR"){if(DebugMode==1){alert("[!!SetXML Error!!] Function: SetResult_4th")}setTimeout("waitSettingFinished()",1000)}}function Start_reciprocal_Number_Reboot(){if(_ReciprocalRebootNumber>=0){document.getElementById("reciprocal_Number_Reboot").innerHTML=_ReciprocalRebootNumber+" "+I18N("j","Sec");_ReciprocalRebootNumber--;setTimeout("Start_reciprocal_Number_Reboot()",1000)}else{redirectPage(null)}}function addRuleButton(){changeTimeoutAction();createScheduleTable(null);currentRule=new RuleObj();document.getElementById("createPop").style.display="inline";$("#createButton").attr("class","styled_button_dis").prop("disabled",true)}function editData(d){changeTimeoutAction();document.getElementById("createPop").style.display="inline";$("#createButton").attr("class","styled_button_dis").prop("disabled",true);currentRule=new RuleObj();var c=datalist.getData(d);$.extend(currentRule,c);$("#schedule_name").val(currentRule.name);for(var b=0;b<currentRule.length();b++){for(var a=currentRule.list[b].start;a<currentRule.list[b].end;a++){currentRule.timeArray[currentRule.list[b].date-1][a]=1}}createScheduleTable(currentRule)}function deleteData(a){datalist.deleteData(a);check_TotalRule(Limit_Rules,datalist.length());save_button_changed()}function DisplayTime(){var a=document.createElement("div");a.className="display";a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.width="90px";a.style.height="27px";a.style.lineHeight="27px";a.style.background="#FFFA72";a.style.color="#505050";a.style.zIndex="1000";return a}function SpriteBtn(){var a=document.createElement("div");a.className="sprite";a.style.position="absolute";a.style.top="4px";a.style.left="6px";a.style.width="20px";a.style.height="20px";a.style.backgroundImage="url('image/closeBtn.png')";a.style.backgroundRepeat="no-repeat";a.style.backgroundPosition="center";a.style.cursor="pointer";a.style.backgroundSize="contain";return a}function createScheduleTable(f){var b=0;for(var c=0;c<7;c++){var d="";for(var a=0;a<24;a++){var e="list";if(f!=null){if(f.timeArray[c][a]==1){e="list ui-selected click-selected-locked"}}d+="<li class='"+e+"' style='position:relative' value="+b+"></li>";b++}document.getElementById("calendar").children[c].children[0].innerHTML=d;if(f!=null){f.showTimeRange(c)}}}var unselectArray=null;var selectStack=null;function createSelectorTrigger(){$(function(){$(".week").bind("mousedown",function(a){a.metaKey=true;changeTimeoutAction()}).selectable({start:function(a,b){unselectArray=new Array();selectStack=new Array()},selecting:function(b,c){if(c.selecting.tagName=="DIV"){return}selectStack.push(c.selecting);if(currentRule.tmpDate==null){var e=Math.floor(c.selecting.value/24);var a=c.selecting.value%24;var d=$(c.selecting);currentRule.tmpDate=e;if(currentRule.timeArray[e][a]==1){while(a>0){a--;if((currentRule.timeArray[e][a]!=1)||(a==0)){if(a==0){d=d.prev()}d.children(".display").remove();break}d=d.prev()}}}},selected:function(b,c){if(c.selected.tagName=="DIV"){return}$(c.selected).addClass("click-selected-locked");var d=Math.floor(c.selected.value/24);var a=c.selected.value%24;currentRule.timeArray[d][a]=1},unselecting:function(a,b){if(selectStack.length>0){selectStack.pop()}},unselected:function(a,b){unselectArray.push(b.unselected);$(b.unselected).addClass("ui-selected")},stop:function(d,e){if(unselectArray.length==1){var f=$(unselectArray[0]);var g=Math.floor(f.val()/24);var c=f.val()%24;if((c==23)||(currentRule.timeArray[g][c+1]!=1)){var a=0;for(var b=c;b>=0;b--){if(currentRule.timeArray[g][b]!=1){break}currentRule.timeArray[g][b]=0;a++}f.children(".sprite").remove();for(var b=0;b<a;b++){f.removeClass("ui-selected click-selected-locked ui-unselecting");if(b==(a-1)){f.children(".display").remove()}else{f=f.prev()}}}else{currentRule.showTimeRange(currentRule.tmpDate)}}else{if((selectStack.length>0)&&($(selectStack[0]).children(".sprite").length>0)&&(selectStack[0].value>selectStack[1].value)){$(selectStack[0]).children(".sprite").remove();for(var b=0;b<selectStack.length;b++){f=$(selectStack[b]);var g=Math.floor(f.val()/24);var c=f.val()%24;currentRule.timeArray[g][c]=0;f.removeClass("ui-selected click-selected-locked ui-unselecting")}currentRule.showTimeRange(currentRule.tmpDate)}else{currentRule.showTimeRange(currentRule.tmpDate)}}currentRule.tmpDate=null}})})}function clearCreateRulePOP(){changeTimeoutAction();document.getElementById("createPop").style.display="none";document.getElementById("schedule_name").value="";$("li").removeClass("ui-selected click-selected-locked ui-unselecting");$("li .sprite").remove();$("li .display").remove();check_TotalRule(Limit_Rules,datalist.length());currentRule=null}function closeCreateRulePOP(){var a=false;currentRule.setName($("#schedule_name").val());currentRule.makeTimeSet();if(currentRule.rowid!=null){a=datalist.editData(currentRule.rowid,currentRule)}else{a=datalist.push(currentRule)}check_TotalRule(Limit_Rules,datalist.length());if(a==true){clearCreateRulePOP()}return}function save_button_changed(){document.getElementById("Save_Disable_btn").style.display="none";document.getElementById("Save_btn").style.display="block";changeFlag=true;checkFlag=true;changeTimeoutAction()}function check_TotalRule(a,c){var b=a-c;document.getElementById("RemainingRules").innerHTML=b;if(b==0){$("#createButton").attr("class","styled_button_dis").prop("disabled",true)}else{$("#createButton").attr("class","styled_button_s").prop("disabled",false)}}$(document).ready(function(){Load_HTML();Initial();setMenu("menu_Management");createSelectorTrigger();GetXML();startTimeout()});</script> <body> <div id="wrapper"> <div id="header"></div> <div id="menu"></div> <div id="menu_edge"></div> <div id="content"> <div id="info"> <div id="FunctionName"><script>I18N("h","Schedule");</script></div> <div id="wallimage"><img src="image/page_Schedule.png" alt="" width="195" height="119"/></div> <div id="directions"> <script>I18N("h","Some features, such as the firewall and website filters, can be turned on or off based on a schedule. One common use of schedules is to control access to the Internet by a specified device during specified time periods.");</script> </div> </div> <div id="funcBar"> <div id="pagePath"><script>I18N("h","Management");</script> >> <script>I18N("h","Schedule");</script></div> <ul id="rightFunc"> <li style="display:block"><div id="Save_btn" onclick="CheckConnectionStatus();changeTimeoutAction();" style="cursor:pointer; display:none"><script>I18N("h","Save");</script></div></li> <li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save");</script></div></li> <li style="display:block"><a href="javascript:CheckHTMLStatus('Time');" style="text-decoration:none" onclick="return confirmExit()"><div id="page_btn"><script>I18N("h","Time");</script></div></a></li> </ul> </div> <div id="main"> <table class="mainTable" border="1" cellspacing="0" rules="rows" id="tblSchedule"> <thead> <tr> <th><script>I18N("h","Name");</script></th> <th><script>I18N("h","Schedule");</script></th> <th><script>I18N("h","Edit");</script></th> <th><script>I18N("h","Delete");</script></th> </tr> </thead> <tbody></tbody> </table> <table class="mainTable" border="0" cellspacing="0" rules="rows" id="tblSchedule2" style="display:none"> <thead><tr></tr></thead><tbody></tbody> </table> <br/><br/> <button type="button" name="createButton" id="createButton" class="styled_button_s" onclick="addRuleButton()"><script>I18N("h","Add Rule");</script></button> &nbsp;&nbsp;<script>I18N("h","Remaining");</script>:&nbsp;<label id="RemainingRules">10</label> </div> <form name="schedulerule_form" id="schedulerule_form" action=""> <input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none"/> <div id="createPop" style="display:none" onselectstart="return false;"> <div id="popRect3" class="dialogBox" style="width:850px"> <table class="myCreatePop3_table" border="0" cellspacing="0" id="tblSchedule3"> <tbody> <td width="300px"><script>I18N("h","Name");</script>:<input class="styled-text" type="text" name="schedule_name" size="15" id="schedule_name" Maxlength="15"></td> <td>&nbsp;&nbsp;&nbsp;&nbsp;</td> <td width="30px"><div id="closeCreatePopBtn" onclick="clearCreateRulePOP()"></div></td> </tbody> </table> <div id="border" style="position:relative; top:20px; left:0px; height:280px; width:860px; background:url(image/scheduleTable.png) left top no-repeat;"> <div id="calendar" style="position:relative; top:33px; left:56px;"> <div id="Monday"><ul class="week"></ul></div> <div id="Tuesday"><ul class="week"></ul></div> <div id="Wednesday"><ul class="week"></ul></div> <div id="Thursday"><ul class="week"></ul></div> <div id="Friday"><ul class="week"></ul></div> <div id="Saturday"><ul class="week"></ul></div> <div id="Sunday"><ul class="week"></ul></div> </div> </div> <br/> <table class="myCreatePop3_table" border="0" cellspacing="0" style="height:30px;"> <tbody> <td id="save_td" colspan="4" style="width:850px;"> <center><button id="apply_buttonFocus" type="button" class="styled_button_s" onclick="document.getElementById('sumbit_CheckData').click()"><script>I18N("h","Apply");</script></button></center> </td> </tbody> </table> </div> </div> </form> <div id="CreatePopAlertMessage" style="display:none"> <div id="AlertPopRect"> <div id="AlertPopBody"> <table class="myAlertPop_table" id="REBOOT" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td> <center><div id="Loading_pop_image"></div></center> </td> </tr> <tr> <td><label id="reciprocal_Number_Reboot"></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Your changes are being saved.");</script></td> </tr> </tbody> </table> <table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0"> <tbody> <tr> <td> <center><div id="Loading_pop_image"></div></center> </td> </tr> <tr> <td><label id="reciprocal_Number"></label></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Your changes are being saved.");</script></td> </tr> </tbody> </table> </div> </div> </div> <div id="DetectRouterConnection" style="display:none"></div> <div id="footer"> <div id="copyright"><script>I18N("h","COPYRIGHT");</script></div> </div> </div> </div> <script type="text/javascript" charset="utf-8">$(document).ready(function(){$.validator.addMethod("checkIllegalChar",function(d,a){var c=/(^[a-zA-Z0-9_-]+$)/;var b=true;if(c.test(d)){b=true}else{b=false}return b},jQuery.validator.messages.check_IllegalChar);$("#schedulerule_form").each(function(a,b){$(b).validate({rules:{schedule_name:{checkIllegalChar:true}},submitHandler:function(c){closeCreateRulePOP();save_button_changed()}})})});</script> </body> </html>