function Datalist(){this.list=new Array();this.maxrowid=0}Datalist.prototype.getData=function(b){var a;var c;for(a=0;a<this.list.length;a++){c=this.list[a];if(c.rowid==b){break}}return c};Datalist.prototype.getRowNum=function(a){var b=0;for(b=0;b<this.list.length;b++){if(a==this.list[b].rowid){break}}return b};Datalist.prototype.editData=function(c,a){var b=this.getRowNum(c);if(this.checkData(a,b)==false){return false}a.setRowid(c);this.list.splice(b,1,a);a.setDataToRow($("#tr"+a.rowid));return true};Datalist.prototype.deleteData=function(b){var a=this.getRowNum(b);this.list.splice(a,1);$("#tr"+b).remove()};Datalist.prototype.push=function(a){if(this.checkData(a,null)==false){return false}a.setRowid(this.maxrowid);this.list.push(a);this.maxrowid++;a.addRowToHTML("tblSchedule");return true};Datalist.prototype.checkData=function(h,k){var c;var e;var g=/#[0-9]$/;var b;var a=0;if(h.name.replace(/\s/g,"")==""){h.name="NewRule";b=h.name;a=1}for(c=0;c<this.list.length;c++){if(c==k){continue}e=this.list[c].name;if(g.test(e)){var j=e.split("#");b=j[0];var d=parseInt(j[1],10);if(h.name==b){if(a<=d){a=d+1}}else{if(g.test(h.name)){var f=h.name.split("#");if(f[0]==b){a=parseInt(f[1],10);if(d==a){a++}}}}}else{if(h.name==e){b=h.name;a=1}}}if((h.name=="NewRule")||(h.name=="Always")){h.name=b+"#"+a;if(a==0){a++}}if(a>0){h.name=b+"#"+a}return true};Datalist.prototype.length=function(){return this.list.length};function RuleObj(){this.list=new Array();this.timeArray=new Array(7);for(var a=0;a<7;a++){this.timeArray[a]=new Array(24)}}RuleObj.prototype={list:null,rowid:null,name:null,tmpDate:null,setRowid:function(a){this.rowid=a},setName:function(a){this.name=a},length:function(){return this.list.length},push:function(a){this.list.push(a);return true},remove:function(a){this.list.splice(a,1)},showName:function(){return HTMLEncode(this.name)},addRowToHTML:function(c){var b;b="<tr id='tr"+this.rowid+"'></tr>";var a="#"+c+"> tbody";$(a).append(b);this.setDataToRow($("#tr"+this.rowid));return},setDataToRow:function(a){var b;b="<td>"+this.showName()+"</td>";b+="<td>"+this.showSchedule()+"</td>";b+="<td><img src='image/edit_btn.png' width=28 height=28 style='cursor:pointer' onclick='editData("+this.rowid+")'/></td>";b+="<td><img src='image/trash.png' width=41 height=41 style='cursor:pointer' onclick='deleteData("+this.rowid+")'/></td>";a.html(b);return},showTimeRange:function(c){var b=new DisplayTime();var e="";var g=-1;var a=-1;switch(c+1){case 1:e="#Monday ";break;case 2:e="#Tuesday ";break;case 3:e="#Wednesday ";break;case 4:e="#Thursday ";break;case 5:e="#Friday ";break;case 6:e="#Saturday ";break;case 7:e="#Sunday ";break}$(e+".display").remove();$(e+".sprite").remove();for(var d=0;d<24;d++){if((g<0)&&(this.timeArray[c][d]==1)){g=d}if(g>=0){if(this.timeArray[c][d]!=1){a=d}else{if(d==23){a=24}}}if((g>=0)&&(a>=0)){if((a-g)>3){$(e+".week li").eq(g).append(b);b.innerHTML=g+":00 - "+a+":00";b=new DisplayTime()}var f=new SpriteBtn();$(e+".week li").eq(a-1).append(f);g=-1;a=-1}}}};function TimeSet(b,c,a){this.date=b;this.start=c;this.end=a}TimeSet.prototype={date:null,start:null,end:null};RuleObj.prototype.showSchedule=function(){var c="";var d="";var e="";var a=0;for(var b=0;b<this.list.length;b++){if(e==this.list[b].date){c+=", "}else{if(b>0){c+="<br>"}switch(this.list[b].date){case 1:d="Monday";break;case 2:d="Tuesday";break;case 3:d="Wednesday";break;case 4:d="Thursday";break;case 5:d="Friday";break;case 6:d="Saturday";break;case 7:d="Sunday";break}c+=I18N("j",d)+" : ";e=this.list[b].date}if((this.list[b].start==0)&&(this.list[b].end==24)){c+=I18N("j","All Day");a++}else{c+=this.list[b].start+":00 - "+this.list[b].end+":00"}}if(a==7){c=I18N("j","All Week")}return c};RuleObj.prototype.makeTimeSet=function(){var e=-1;var a=-1;var d=null;this.list=new Array();for(var b=0;b<7;b++){for(var c=0;c<24;c++){if((e<0)&&(this.timeArray[b][c]==1)){e=c}if(e>=0){if(this.timeArray[b][c]!=1){a=c}else{if(c==23){a=24}}}if((e>=0)&&(a>=0)){d=new TimeSet(b+1,e,a);this.list.push(d);d=null;e=-1;a=-1}}}return};